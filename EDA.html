
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Análisis Exploratorio de Datos (EDA) &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'EDA';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Modelos de Clasificación" href="Modelo_clasificacion.html" />
    <link rel="prev" title="Procesamiento de los datos" href="Limpieza.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpeg" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.jpeg" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Proyecto de Detección de Fraude
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Limpieza.html"><strong>Procesamiento de los datos</strong></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Análisis Exploratorio de Datos (EDA)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Modelo_clasificacion.html"><strong>Modelos de Clasificación</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Pipeline_modelos.html"><strong>Modelos con Pipelines</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Modelo_original.html"><strong>Modelo Original</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FEDA.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/EDA.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Análisis Exploratorio de Datos (EDA)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias"><strong>Librerias</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contextualizacion-del-conjunto-de-datos"><strong>Contextualización del Conjunto de Datos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformacion-final"><strong>Transformación final</strong></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analisis-exploratorio-de-datos-eda">
<h1><strong>Análisis Exploratorio de Datos (EDA)</strong><a class="headerlink" href="#analisis-exploratorio-de-datos-eda" title="Link to this heading">#</a></h1>
<section id="librerias">
<h2><strong>Librerias</strong><a class="headerlink" href="#librerias" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">anderson</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="contextualizacion-del-conjunto-de-datos">
<h2><strong>Contextualización del Conjunto de Datos</strong><a class="headerlink" href="#contextualizacion-del-conjunto-de-datos" title="Link to this heading">#</a></h2>
<p>Los datos provienen de transacciones reales de comercio electrónico registradas por la empresa Vesta. El conjunto incluye una amplia variedad de características que abarcan desde información del dispositivo utilizado hasta detalles específicos del producto adquirido. El propósito central del estudio es optimizar la detección de transacciones fraudulentas a gran escala, con el fin de reducir las pérdidas económicas para miles de empresas y, al mismo tiempo, minimizar los falsos positivos que afectan a millones de usuarios.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Variable</strong></p></th>
<th class="head"><p><strong>Descripción</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TransactionDT</span></code></p></td>
<td><p>Intervalo de tiempo a partir de una fecha y hora de referencia</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TransactionAMT</span></code></p></td>
<td><p>Importe del pago de la transacción en USD</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ProductCD</span></code></p></td>
<td><p>Código de producto, el producto de cada transacción</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">card1</span></code> - <code class="docutils literal notranslate"><span class="pre">card6</span></code></p></td>
<td><p>Información de la tarjeta de pago: tipo, categoría, banco emisor, país, etc.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">addr</span></code></p></td>
<td><p>Dirección</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dist</span></code></p></td>
<td><p>Distancia</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">P_emaildomain</span></code></p></td>
<td><p>Dominio de correo electrónico del comprador</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">R_emaildomain</span></code></p></td>
<td><p>Dominio de correo electrónico del destinatario</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">C1</span></code> - <code class="docutils literal notranslate"><span class="pre">C14</span></code></p></td>
<td><p>Recuento de direcciones asociadas a la tarjeta de pago (codificado)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">D1</span></code> - <code class="docutils literal notranslate"><span class="pre">D15</span></code></p></td>
<td><p>Intervalos de tiempo entre eventos o transacciones</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">M1</span></code> - <code class="docutils literal notranslate"><span class="pre">M9</span></code></p></td>
<td><p>Coincidencias como nombre y dirección entre usuario y tarjeta</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Vxxx</span></code></p></td>
<td><p>Variables derivadas por Vesta: recuento, clasificación, relaciones entre entidades</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DeviceType</span></code></p></td>
<td><p>Información codificada del tipo de dispositivo</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DeviceInfo</span></code></p></td>
<td><p>Información codificada del software/dispositivo utilizado</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">id_12</span></code> - <code class="docutils literal notranslate"><span class="pre">id_38</span></code></p></td>
<td><p>Identidad codificada del usuario, IP, ISP, Proxy, firma digital, etc.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">isfraud</span></code></p></td>
<td><p>Variable objetivo del análisis. Toma el valor 1 si la transacción fue identificada como fraudulenta y 0 en caso contrario.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar el dataset</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;dataset_final.csv&quot;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ver dimensiones</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensiones del dataset:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Filas: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columnas: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dimensiones del dataset:
Filas: 144,233
Columnas: 73
</pre></div>
</div>
</div>
</div>
<p>El conjunto de datos utilizado para el análisis corresponde a una fusión de las tablas originales <code class="docutils literal notranslate"><span class="pre">train_transaction.csv</span></code> y <code class="docutils literal notranslate"><span class="pre">train_identity.csv</span></code>, realizada mediante una unión tipo <code class="docutils literal notranslate"><span class="pre">LEFT</span> <span class="pre">JOIN</span></code> a través del identificador común <code class="docutils literal notranslate"><span class="pre">TransactionID</span></code>. Este procedimiento permitió consolidar en un solo archivo la información transaccional y de identidad digital de los usuarios, con el objetivo de disponer de un conjunto completo para las tareas de limpieza, exploración y modelado.</p>
<p>Inicialmente, el dataframe resultante de esta fusión contenía 144.233 registros y un total de 434 variables. No obstante, este volumen incluía una gran cantidad de columnas completamente vacías o con alta proporción de valores nulos. En consecuencia, se eliminaron todas aquellas variables que contenían el 100% de datos ausentes, así como aquellas que presentaban más del 50% de valores nulos, por considerarse que no aportaban información estadísticamente confiable.</p>
<p>Una vez depurado el conjunto en términos de completitud, se procedió a imputar los valores faltantes restantes. Para las variables numéricas, se aplicó una estrategia de imputación basada en K-Nearest Neighbors (<code class="docutils literal notranslate"><span class="pre">KNNImputer</span></code>), en dos fases según el porcentaje de valores ausentes. Las variables con mayor proporción de nulos se imputaron primero para evitar que su carencia influyera en la calidad de la segunda imputación. En cuanto a las variables categóricas, dado que los porcentajes de nulos eran inferiores al 2.5%, se optó por una imputación directa mediante la moda de cada variable.</p>
<p>Adicionalmente, se implementaron procedimientos de reducción de dimensionalidad, comenzando con la eliminación de variables con <strong>alta multicolinealidad</strong> mediante el cálculo del <strong>Factor de Inflación de Varianza (VIF)</strong>. Este proceso se aplicó de manera iterativa antes de la imputación, eliminando sucesivamente las variables con mayor VIF hasta garantizar que todas las variables numéricas restantes presentaran una relación lineal aceptable (VIF &lt; 10). Posteriormente, se evaluó la dependencia entre variables categóricas usando la <strong>prueba de chi-cuadrado de independencia</strong>, eliminando aquellas que presentaban correlación estadísticamente significativa con otras variables, lo cual contribuía a la redundancia en el modelo.</p>
<p>Como resultado de este proceso exhaustivo, el conjunto final de datos quedó conformado por 73 variables, todas completas, sin multicolinealidad severa, sin redundancias categóricas, y aptas para su utilización en el análisis exploratorio y el posterior modelado predictivo. Este procesamiento se documenta con mayor detalle en el cuaderno <code class="docutils literal notranslate"><span class="pre">Limpieza.ipynb</span></code>, donde se ejecutaron y justificaron todas las decisiones tomadas en relación con la estructura del dataset.
Para más información sobre la depuración y preparación del conjunto de datos, consulte la sección de <a class="reference internal" href="#procesamiento-de-los-datos"><span class="xref myst">Procesamiento de los datos</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Filtrar variables numéricas con al menos 2 valores distintos</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;number&#39;</span><span class="p">)</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="n">num_cols</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">num_cols</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Correlación y heatmap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span>  <span class="c1"># Ajusta tamaño según cantidad de columnas</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span>
    <span class="n">num_cols</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rocket&#39;</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">annot</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mapa de calor de correlaciones - variables numéricas con varianza&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0f98dc674eca08866c3d1e66a8774dec59458d849e69012fb0f4b61e80fbcaae.png" src="_images/0f98dc674eca08866c3d1e66a8774dec59458d849e69012fb0f4b61e80fbcaae.png" />
</div>
</div>
<p>Con el objetivo de verificar visualmente la eficacia del procedimiento de reducción de multicolinealidad, se presenta a continuación el mapa de calor de correlaciones entre todas las variables numéricas del dataset final que conservan varianza. Se observa que, tras la eliminación iterativa de variables con alto Factor de Inflación de Varianza (VIF), las correlaciones lineales entre las variables restantes son, en general, moderadas o bajas. Este resultado valida la consistencia del proceso de depuración, ya que no se identifican agrupaciones de variables con correlaciones cercanas a ±1, lo que garantiza una mayor estabilidad en los modelos de clasificación que se construirán posteriormente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ver primeras filas</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Primeras filas del dataset:&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Primeras filas del dataset:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_01</th>
      <th>id_02</th>
      <th>id_05</th>
      <th>id_06</th>
      <th>id_09</th>
      <th>id_10</th>
      <th>id_19</th>
      <th>id_20</th>
      <th>isfraud</th>
      <th>transactiondt</th>
      <th>...</th>
      <th>v296</th>
      <th>v301</th>
      <th>v311</th>
      <th>v313</th>
      <th>v314</th>
      <th>v326</th>
      <th>v335</th>
      <th>v338</th>
      <th>id_38</th>
      <th>card6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>70787.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>-2.800000</td>
      <td>542.0</td>
      <td>144.0</td>
      <td>0.0</td>
      <td>86506.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>T</td>
      <td>credit</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-5.0</td>
      <td>98945.0</td>
      <td>0.0</td>
      <td>-5.0</td>
      <td>0.000000</td>
      <td>-0.400000</td>
      <td>621.0</td>
      <td>500.0</td>
      <td>0.0</td>
      <td>86535.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>T</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-5.0</td>
      <td>191631.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>410.0</td>
      <td>142.0</td>
      <td>0.0</td>
      <td>86549.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>31.841299</td>
      <td>90.327904</td>
      <td>90.327904</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>30.000000</td>
      <td>T</td>
      <td>credit</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-5.0</td>
      <td>221832.0</td>
      <td>0.0</td>
      <td>-6.0</td>
      <td>0.091023</td>
      <td>-0.301124</td>
      <td>176.0</td>
      <td>507.0</td>
      <td>0.0</td>
      <td>86555.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.851416</td>
      <td>59.213495</td>
      <td>151.546395</td>
      <td>T</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>7460.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>529.0</td>
      <td>575.0</td>
      <td>0.0</td>
      <td>86620.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>T</td>
      <td>debit</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 73 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ver resumen de tipos de datos</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tipos de datos en el dataset&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

<span class="c1"># Ver cantidad de valores nulos por columna (top 20)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Valores nulos por columna&quot;</span><span class="p">)</span>
<span class="n">nulls</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nulls</span><span class="p">[</span><span class="n">nulls</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tipos de datos en el dataset
float64    71
object      2
Name: count, dtype: int64

Valores nulos por columna
Series([], dtype: int64)
</pre></div>
</div>
</div>
</div>
<p>Luego de verificar visualmente las correlaciones entre las variables numéricas mediante el mapa de calor, se presenta a continuación un resumen estructural del dataset final. Se observa que el conjunto de datos contiene un total de 73 variables, de las cuales 71 son numéricas (<code class="docutils literal notranslate"><span class="pre">float64</span></code>) y 2 categóricas (<code class="docutils literal notranslate"><span class="pre">object</span></code>). Además, tras el proceso de imputación y depuración descrito previamente, se confirma que ya no existen valores nulos en ninguna columna, lo que garantiza la completitud del conjunto de datos y lo habilita para su análisis exploratorio y posterior modelado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Reafirmar columnas categóricas tipo object</span>
<span class="n">categorical_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Total de filas</span>
<span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Recorrer cada columna categórica y mostrar valores únicos + porcentaje + gráfico</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">categorical_cols</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> ===&quot;</span><span class="p">)</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">percentages</span> <span class="o">=</span> <span class="n">counts</span> <span class="o">/</span> <span class="n">total</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s1">&#39;Valor&#39;</span><span class="p">:</span> <span class="n">counts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
        <span class="s1">&#39;Frecuencia&#39;</span><span class="p">:</span> <span class="n">counts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="s1">&#39;Porcentaje&#39;</span><span class="p">:</span> <span class="n">percentages</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="p">})</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>

    <span class="c1"># Crear gráfico de barras</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">counts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribución de </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valor&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== id_38 ===
      Valor  Frecuencia  Porcentaje
id_38                              
F         F       77170        53.5
T         T       67063        46.5
</pre></div>
</div>
<img alt="_images/984fe6d5e4291b16e4fe89e0b51d24622ef0452fff594591c61d65728e1a30f4.png" src="_images/984fe6d5e4291b16e4fe89e0b51d24622ef0452fff594591c61d65728e1a30f4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== card6 ===
                   Valor  Frecuencia  Porcentaje
card6                                           
credit            credit       75268       52.19
debit              debit       68950       47.80
charge card  charge card          15        0.01
</pre></div>
</div>
<img alt="_images/4a58564280b89ab68643a27eb84d2519283bccb3f6371f60eeb81d41000ac822.png" src="_images/4a58564280b89ab68643a27eb84d2519283bccb3f6371f60eeb81d41000ac822.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Eliminar registros donde card6 es &quot;charge card&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;card6&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;charge card&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nuevo tamaño del dataset: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;card6&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Nuevo tamaño del dataset: (144218, 73)
card6
credit    52.190434
debit     47.809566
Name: proportion, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Se identificó que la categoría “charge card” en la variable <code class="docutils literal notranslate"><span class="pre">card6</span></code> tenía una frecuencia extremadamente baja (15 registros, 0.01%). Por esta razón, se optó por eliminar estos registros, ya que las categorías con muy baja representación pueden introducir ruido y no aportan valor estadístico al modelo.
Tras la limpieza, el dataset quedó con 144,218 registros, y se mantuvo una distribución balanceada entre “credit” (52.19%) y “debit” (47.81%).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Columna&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
    <span class="s1">&#39;Tipo de dato&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">,</span>
    <span class="s1">&#39;Valores únicos&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="p">})</span>

<span class="c1"># Ordenar por tipo de dato (opcional)</span>
<span class="n">info</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Tipo de dato&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           Columna Tipo de dato  Valores únicos
0            id_01      float64              77
1             v261      float64              97
2             v250      float64              27
3             v238      float64              34
4             v229      float64             191
5             v227      float64              61
6             v226      float64             102
7             v267      float64            6231
8             v225      float64              83
9             v223      float64              42
10            v220      float64              43
11            v208      float64            3171
12            v185      float64              46
13            v184      float64              31
14            v177      float64             891
15            v224      float64             160
16            v175      float64              31
17            v271      float64            3165
18            v277      float64            4052
19            v338      float64             706
20            v335      float64            1238
21            v326      float64             138
22            v314      float64            3871
23            v313      float64            2885
24            v311      float64            1921
25            v274      float64           11631
26            v301      float64              16
27            v291      float64              79
28            v289      float64              14
29            v287      float64              15
30            v286      float64               7
31            v282      float64              46
32            v281      float64              31
33            v296      float64              99
34            v174      float64              19
35            v173      float64              16
36              d8      float64           15541
37              d1      float64             724
38             c14      float64             994
39              c3      float64              27
40           addr1      float64            1307
41           card2      float64             997
42           card1      float64            8497
43            v172      float64              49
44  transactionamt      float64            7829
45         isfraud      float64               2
46           id_20      float64            1661
47           id_19      float64            1631
48           id_10      float64              92
49           id_09      float64              72
50           id_06      float64             267
51   transactiondt      float64          142719
52           id_05      float64             184
53              d9      float64            1070
54            v124      float64              16
55            v169      float64              40
56            v164      float64            2916
57            v162      float64             290
58            v161      float64             133
59            v160      float64           12556
60            v159      float64            8958
61             v98      float64              14
62            v152      float64             196
63            v146      float64              43
64            v142      float64              23
65            v141      float64              13
66            v140      float64              73
67            v138      float64              40
68            v135      float64             910
69            v149      float64              41
70           id_02      float64          118476
71           id_38       object               2
72           card6       object               2
</pre></div>
</div>
</div>
</div>
<p>Aunque el tipo de dato de la mayoría de las variables en el dataset es <code class="docutils literal notranslate"><span class="pre">float64</span></code>, esto no implica que todas ellas sean numéricas en su naturaleza. De acuerdo con la documentación del proveedor de datos, un número considerable de variables han sido codificadas desde categorías originales (por ejemplo, indicadores binarios, codificaciones de identidad, relaciones entre entidades o correspondencias de usuario). Este es el caso, por ejemplo, de las variables <code class="docutils literal notranslate"><span class="pre">M1</span></code> a <code class="docutils literal notranslate"><span class="pre">M9</span></code>, <code class="docutils literal notranslate"><span class="pre">id_12</span></code> a <code class="docutils literal notranslate"><span class="pre">id_38</span></code>, así como muchas de las variables <code class="docutils literal notranslate"><span class="pre">Vxxx</span></code>, cuyo significado exacto no es público.</p>
<p>Solamente algunas variables pueden asumirse con certeza como numéricas continuas: entre ellas se encuentran <code class="docutils literal notranslate"><span class="pre">TransactionAMT</span></code> (monto de la transacción), <code class="docutils literal notranslate"><span class="pre">TransactionDT</span></code> (tiempo relativo de la transacción), y algunas variables derivadas de diferencia temporal como <code class="docutils literal notranslate"><span class="pre">D1</span></code>, <code class="docutils literal notranslate"><span class="pre">D8</span></code> y <code class="docutils literal notranslate"><span class="pre">D9</span></code>. Estas variables reflejan cantidades medibles o intervalos reales y no surgen de procesos de codificación categórica.</p>
<p>Este aspecto constituye una limitación importante durante el análisis exploratorio, ya que impide aplicar ciertas técnicas estadísticas sin antes validar o reinterpretar el significado de las variables involucradas. Por tanto, en lo que sigue, los análisis serán aplicados de forma diferenciada, considerando esta ambigüedad en la interpretación de los datos codificados.</p>
<p>Veamos a continuación, el resto del análisis considerando la variable objetivo <code class="docutils literal notranslate"><span class="pre">isfraud</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Conteo y porcentaje de cada clase</span>
<span class="n">conteo</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;isfraud&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">porcentaje</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;isfraud&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Mostrar resumen en texto</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribución de la variable &#39;isFraud&#39;:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">clase</span> <span class="ow">in</span> <span class="n">conteo</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Clase </span><span class="si">{</span><span class="n">clase</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">conteo</span><span class="p">[</span><span class="n">clase</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> transacciones (</span><span class="si">{</span><span class="n">porcentaje</span><span class="p">[</span><span class="n">clase</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distribución de la variable &#39;isFraud&#39;:

Clase 0.0 -&gt; 132,915 transacciones (92.15%)
Clase 1.0 -&gt; 11,318 transacciones (7.85%)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;isfraud&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución de Transacciones Fraudulentas&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;¿Es fraude? (0 = No, 1 = Sí)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cantidad de transacciones&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;No Fraude&#39;</span><span class="p">,</span> <span class="s1">&#39;Fraude&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/23290b6e65410908fabfbc968f28a5ff227b15b5b40e4cc58ca011cae1f24ceb.png" src="_images/23290b6e65410908fabfbc968f28a5ff227b15b5b40e4cc58ca011cae1f24ceb.png" />
</div>
</div>
<p>La distribución de la variable <code class="docutils literal notranslate"><span class="pre">isFraud</span></code> revela un claro desbalance de clases: aproximadamente el 92% de las transacciones corresponden a casos no fraudulentos, mientras que solo el 8% son clasificadas como fraude. Esta desproporción puede afectar el desempeño de los modelos de clasificación, ya que las clases mayoritarias tienden a dominar las predicciones si no se aplican estrategias correctivas. Por esta razón, más adelante se implementarán técnicas de balanceo que permitirán mitigar este sesgo y mejorar la sensibilidad del modelo frente a la clase minoritaria.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Asegurar que tengas la variable de hora</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;transaction_hour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;transactiondt&#39;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">3600</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Agrupar por hora y contar cantidad total de transacciones</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;transaction_hour&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>

<span class="c1"># Graficar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">counts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">counts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribución total de transacciones por hora virtual&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Hora (desde el inicio del dataset)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Número de transacciones&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f97dbe9b2bde2f20f4516700e0d3dfbc717d20b76d575f76de2d99d5fb589056.png" src="_images/f97dbe9b2bde2f20f4516700e0d3dfbc717d20b76d575f76de2d99d5fb589056.png" />
</div>
</div>
<p>La variable <code class="docutils literal notranslate"><span class="pre">TransactionDT</span></code> corresponde a un intervalo de tiempo medido a partir de una fecha y hora de referencia no especificada. Aunque no se detalla su unidad de medida oficial, su comportamiento creciente y el orden secuencial de los registros sugieren que podría representar una magnitud temporal como segundos o minutos. No obstante, dado que esta información no está explícitamente definida, no se asume ninguna escala temporal absoluta.</p>
<p>Para facilitar su análisis, se realizó una transformación sobre esta variable con el fin de obtener una versión más interpretable: la denominada “hora virtual”. Esta transformación consistió en dividir cada valor de <code class="docutils literal notranslate"><span class="pre">TransactionDT</span></code> entre 3600, asumiendo operativamente que el dato representaba segundos, aunque sin pretender establecer correspondencia con una hora real. La finalidad de este procedimiento fue simplemente agrupar los registros en bloques temporales más comprensibles.</p>
<p>El gráfico generado a partir de esta nueva variable muestra la distribución total de transacciones a lo largo del tiempo registrado en el dataset. Se observa una marcada concentración de actividad durante las primeras horas virtuales, seguida de una fase de menor volumen y mayor estabilidad. Este patrón evidencia que la actividad transaccional no fue homogénea en el tiempo y refuerza la utilidad de esta transformación para identificar comportamientos relevantes o posibles anomalías temporales.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lista de variables para histograma</span>
<span class="n">vars_hist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;transactionamt&#39;</span><span class="p">,</span> <span class="s1">&#39;id_02&#39;</span><span class="p">,</span> <span class="s1">&#39;d1&#39;</span><span class="p">,</span> <span class="s1">&#39;card1&#39;</span><span class="p">]</span>

<span class="c1"># Graficar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vars_hist</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribución de </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dca67226ebf637bd4e407c8fabc846273c8206b1b447d466778f87dead12c94b.png" src="_images/dca67226ebf637bd4e407c8fabc846273c8206b1b447d466778f87dead12c94b.png" />
</div>
</div>
<p>En esta sección se presentan los histogramas de cuatro variables con representación numérica: <code class="docutils literal notranslate"><span class="pre">transactionamt</span></code>, <code class="docutils literal notranslate"><span class="pre">id_02</span></code>, <code class="docutils literal notranslate"><span class="pre">d1</span></code> y <code class="docutils literal notranslate"><span class="pre">card1</span></code>. De acuerdo con la documentación, <code class="docutils literal notranslate"><span class="pre">transactionamt</span></code> corresponde al importe de la transacción en dólares estadounidenses, por lo que puede considerarse una variable numérica continua real. En este caso, el uso de un histograma es pertinente y revela una distribución fuertemente asimétrica hacia la derecha, con una alta concentración de montos bajos y algunos valores extremos, posiblemente correspondientes a pagos atípicos o devoluciones.</p>
<p>Por su parte, la variable <code class="docutils literal notranslate"><span class="pre">id_02</span></code> pertenece al conjunto <code class="docutils literal notranslate"><span class="pre">id_12</span></code> a <code class="docutils literal notranslate"><span class="pre">id_38</span></code>, las cuales corresponden a identificadores codificados relacionados con información digital del usuario o del dispositivo. Aunque su formato es numérico, su naturaleza es categórica codificada, por lo que un histograma tradicional pierde valor interpretativo directo. No obstante, observar su distribución permite detectar la existencia de valores dominantes o dispersión extrema, útil para identificar la necesidad de transformaciones o reducción de cardinalidad.</p>
<p>La variable <code class="docutils literal notranslate"><span class="pre">d1</span></code>, según la documentación, representa un intervalo de tiempo asociado a cada registro, posiblemente en días, aunque no se especifica con claridad respecto a qué evento se mide. Su formato es numérico y discreto, con una concentración marcada en valores bajos, lo que sugiere que muchas observaciones presentan un tiempo corto respecto al evento de referencia. El histograma correspondiente permite visualizar esta acumulación y observar la proporción de casos que presentan intervalos prolongados.</p>
<p>Finalmente, <code class="docutils literal notranslate"><span class="pre">card1</span></code> corresponde a un identificador vinculado a la tarjeta del usuario (posiblemente un hash o codificación del emisor o tipo de tarjeta). Su apariencia numérica no refleja una cantidad medible, sino una codificación categórica de alta cardinalidad. Por lo tanto, aunque se grafica como histograma, su interpretación debe limitarse a la detección de frecuencias relativas por categoría codificada, y no como variable continua. En este tipo de variables, otros enfoques como el conteo de valores únicos o su relación directa con la variable objetivo suelen ser más adecuados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1"># Variables que sí tienen sentido en boxplot univariado</span>
<span class="n">vars_box</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;transactionamt&#39;</span><span class="p">,</span> <span class="s1">&#39;d1&#39;</span><span class="p">]</span>

<span class="c1"># Crear figura</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Boxplots individuales</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vars_box</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Boxplot de </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6b056b6206c304642ac11937c3eb41ece41dcfd13a1ab1c4bf91d3b9af5d19fd.png" src="_images/6b056b6206c304642ac11937c3eb41ece41dcfd13a1ab1c4bf91d3b9af5d19fd.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Resumen estadístico de transactionamt y d1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resumen estadístico de &#39;transactionamt&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;transactionamt&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resumen estadístico de &#39;transactionamt&#39;

       transactionamt
count   144233.000000
mean        83.554533
std         99.850258
min          0.251000
25%         25.453000
50%         50.000000
75%        100.000000
max       1800.000000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1"># Detectar columnas D1 a D15 válidas </span>
<span class="n">d_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()]</span>
<span class="n">d_validas</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">d_cols</span> <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.8</span> <span class="ow">and</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Graficar histogramas de las variables D seleccionadas</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">d_validas</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">//</span> <span class="mi">3</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">d_validas</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">d_validas</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">//</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Histograma de </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8cb5460ae7ff2444dd4fd7014dc315f1b498fb82ddbd51504e4fa877c7df0cfb.png" src="_images/8cb5460ae7ff2444dd4fd7014dc315f1b498fb82ddbd51504e4fa877c7df0cfb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionar todas las columnas que comienzan con &#39;d&#39; seguido de número</span>
<span class="n">d_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()]</span>

<span class="c1"># Mostrar resumen estadístico</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resumen estadístico de las variables D1 a D15:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">d_cols</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resumen estadístico de las variables D1 a D15:

                  d1             d8             d9
count  144233.000000  144233.000000  144233.000000
mean       29.330390     172.600160       0.553671
std        95.150487     182.358745       0.240271
min         0.000000       0.000000       0.000000
25%         0.000000      29.083332       0.483333
50%         0.000000     146.058108       0.561057
75%         0.000000     221.791669       0.708333
max       640.000000    1707.791626       0.958333
</pre></div>
</div>
</div>
</div>
<p>Las variables <code class="docutils literal notranslate"><span class="pre">d1</span></code>, <code class="docutils literal notranslate"><span class="pre">d8</span></code> y <code class="docutils literal notranslate"><span class="pre">d9</span></code> forman parte del conjunto <code class="docutils literal notranslate"><span class="pre">D1</span></code> a <code class="docutils literal notranslate"><span class="pre">D15</span></code>, asociadas a intervalos de tiempo entre eventos. Todas fueron incluidas en el modelo sin transformación previa, ya que su formato numérico era compatible y no requería codificación adicional.</p>
<p>En el caso de <code class="docutils literal notranslate"><span class="pre">d1</span></code>, se observa una fuerte concentración en valores bajos, con más del 75% de los registros en cero y presencia de valores atípicos. <code class="docutils literal notranslate"><span class="pre">d8</span></code> presenta mayor dispersión, con una mediana intermedia y valores máximos elevados. Por su parte, <code class="docutils literal notranslate"><span class="pre">d9</span></code> tiene un rango acotado entre 0 y 1, y aunque su significado no es completamente claro, su comportamiento discreto sugiere que podría representar proporciones o una codificación binaria. En todos los casos, su inclusión se justificó por su carácter numérico y por conservar variabilidad suficiente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Usamos la columna original o la winsorizada</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;transactionamt&#39;</span><span class="p">]</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">anderson</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Anderson-Darling Test ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estadístico A: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">critical_values</span><span class="p">)):</span>
    <span class="n">sl</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">significance_level</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">result</span><span class="o">.</span><span class="n">critical_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nivel de significancia: </span><span class="si">{</span><span class="n">sl</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% | Valor crítico: </span><span class="si">{</span><span class="n">cv</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
<span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">statistic</span> <span class="o">&gt;</span> <span class="n">result</span><span class="o">.</span><span class="n">critical_values</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>  
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Conclusión: Rechazamos H0 → No es normal&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Conclusión: No se rechaza H0 → Podría ser normal&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Anderson-Darling Test ===
Estadístico A: 11934.4809
Nivel de significancia: 15.0% | Valor crítico: 0.5760
Nivel de significancia: 10.0% | Valor crítico: 0.6560
Nivel de significancia: 5.0% | Valor crítico: 0.7870
Nivel de significancia: 2.5% | Valor crítico: 0.9180
Nivel de significancia: 1.0% | Valor crítico: 1.0920

Conclusión: Rechazamos H0 → No es normal
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Transformación logarítmica segura (log(1 + x)) para evitar log(0)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;transactionamt_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;transactionamt&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;transactionamt_log&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribución de TransactionAmt transformada con log1p&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/62a023da742a785b981723dba8649dc00d7508c026801d169a922aac0f4020b3.png" src="_images/62a023da742a785b981723dba8649dc00d7508c026801d169a922aac0f4020b3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prueba sobre la variable transformada</span>
<span class="n">result_log</span> <span class="o">=</span> <span class="n">anderson</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;transactionamt_log&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Anderson-Darling sobre log1p(TransactionAmt) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estadístico A: </span><span class="si">{</span><span class="n">result_log</span><span class="o">.</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result_log</span><span class="o">.</span><span class="n">critical_values</span><span class="p">)):</span>
    <span class="n">sl</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">result_log</span><span class="o">.</span><span class="n">significance_level</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">result_log</span><span class="o">.</span><span class="n">critical_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nivel de significancia: </span><span class="si">{</span><span class="n">sl</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% | Valor crítico: </span><span class="si">{</span><span class="n">cv</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
<span class="k">if</span> <span class="n">result_log</span><span class="o">.</span><span class="n">statistic</span> <span class="o">&gt;</span> <span class="n">result_log</span><span class="o">.</span><span class="n">critical_values</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>  <span class="c1"># 5%</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Conclusión: Rechazamos H0 → no es normal&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Conclusión: No se rechaza H0 → Podría ser normal&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Anderson-Darling sobre log1p(TransactionAmt) ===
Estadístico A: 424.5350
Nivel de significancia: 15.0% | Valor crítico: 0.5760
Nivel de significancia: 10.0% | Valor crítico: 0.6560
Nivel de significancia: 5.0% | Valor crítico: 0.7870
Nivel de significancia: 2.5% | Valor crítico: 0.9180
Nivel de significancia: 1.0% | Valor crítico: 1.0920

Conclusión: Rechazamos H0 → no es normal
</pre></div>
</div>
</div>
</div>
<p>La variable <code class="docutils literal notranslate"><span class="pre">transactionamt</span></code>, que representa el valor monetario de cada transacción en dólares estadounidenses, presentó desde el inicio una distribución altamente asimétrica, con la mayoría de los valores concentrados en montos bajos y una cola extendida de transacciones con valores significativamente más altos. Este comportamiento fue confirmado tanto visualmente como mediante el test de Anderson-Darling, que permitió rechazar la hipótesis nula de normalidad.</p>
<p>Dado que esta variable es continua, estrictamente positiva y sensible a valores extremos, se consideró apropiado aplicar una transformación logarítmica. Para ello, se utilizó la función <code class="docutils literal notranslate"><span class="pre">log1p</span></code>, que implementa la transformación <code class="docutils literal notranslate"><span class="pre">log(1</span> <span class="pre">+</span> <span class="pre">x)</span></code>, lo cual permite estabilizar la varianza sin generar errores al procesar valores cercanos a cero. La variable transformada (<code class="docutils literal notranslate"><span class="pre">transactionamt_log</span></code>) mostró una estructura más simétrica y comprimió los valores atípicos, haciendo más robusta su participación en modelos que pueden verse afectados por escalas desproporcionadas. En consecuencia, fue esta versión transformada (<code class="docutils literal notranslate"><span class="pre">transactionamt_log</span></code>) la que se incorporó al conjunto de entrenamiento. Se descartó el uso de la variable original ya que su distribución severamente sesgada podía inducir sesgos en algoritmos lineales o afectar el rendimiento de modelos que asumen cierta homogeneidad en la escala de los predictores.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Paso 1: crear la columna de hora virtual</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;transaction_hour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;transactiondt&#39;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">3600</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Paso 2: agrupar por hora y clase</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;transaction_hour&#39;</span><span class="p">,</span> <span class="s1">&#39;isfraud&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Paso 3: graficar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">counts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;No Fraude&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">counts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">counts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fraude&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;firebrick&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribución temporal de transacciones por hora virtual&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Horas desde el inicio del dataset&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Número de transacciones&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b8d3873c0afc747c9ed47b84dfa7e91169ebfbb21670097dc880c2ae0232ee72.png" src="_images/b8d3873c0afc747c9ed47b84dfa7e91169ebfbb21670097dc880c2ae0232ee72.png" />
</div>
</div>
<p>Con base en la variable <code class="docutils literal notranslate"><span class="pre">TransactionDT</span></code> previamente transformada a una escala de “hora virtual”, se generó una nueva visualización que incorpora la variable objetivo <code class="docutils literal notranslate"><span class="pre">isfraud</span></code>. Esta partición permite comparar directamente el comportamiento temporal de las transacciones legítimas y fraudulentas a lo largo del tiempo registrado en el dataset.</p>
<p>El gráfico evidencia que, aunque ambas clases comparten la misma tendencia general de concentración en las primeras horas virtuales, las transacciones fraudulentas son considerablemente menos frecuentes. Esta superposición permite detectar diferencias de densidad y posibles patrones temporales particulares asociados al fraude. La representación diferenciada refuerza la utilidad de <code class="docutils literal notranslate"><span class="pre">transaction_hour</span></code> como variable explicativa en modelos de clasificación, al capturar dinámicas relevantes en la ocurrencia del fraude en función del tiempo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;id_01&#39;, &#39;id_02&#39;, &#39;id_05&#39;, &#39;id_06&#39;, &#39;id_09&#39;, &#39;id_10&#39;, &#39;id_19&#39;, &#39;id_20&#39;, &#39;isfraud&#39;, &#39;transactiondt&#39;, &#39;transactionamt&#39;, &#39;card1&#39;, &#39;card2&#39;, &#39;addr1&#39;, &#39;c3&#39;, &#39;c14&#39;, &#39;d1&#39;, &#39;d8&#39;, &#39;d9&#39;, &#39;v98&#39;, &#39;v124&#39;, &#39;v135&#39;, &#39;v138&#39;, &#39;v140&#39;, &#39;v141&#39;, &#39;v142&#39;, &#39;v146&#39;, &#39;v149&#39;, &#39;v152&#39;, &#39;v159&#39;, &#39;v160&#39;, &#39;v161&#39;, &#39;v162&#39;, &#39;v164&#39;, &#39;v169&#39;, &#39;v172&#39;, &#39;v173&#39;, &#39;v174&#39;, &#39;v175&#39;, &#39;v177&#39;, &#39;v184&#39;, &#39;v185&#39;, &#39;v208&#39;, &#39;v220&#39;, &#39;v223&#39;, &#39;v224&#39;, &#39;v225&#39;, &#39;v226&#39;, &#39;v227&#39;, &#39;v229&#39;, &#39;v238&#39;, &#39;v250&#39;, &#39;v261&#39;, &#39;v267&#39;, &#39;v271&#39;, &#39;v274&#39;, &#39;v277&#39;, &#39;v281&#39;, &#39;v282&#39;, &#39;v286&#39;, &#39;v287&#39;, &#39;v289&#39;, &#39;v291&#39;, &#39;v296&#39;, &#39;v301&#39;, &#39;v311&#39;, &#39;v313&#39;, &#39;v314&#39;, &#39;v326&#39;, &#39;v335&#39;, &#39;v338&#39;, &#39;id_38&#39;, &#39;card6&#39;, &#39;transaction_hour&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1"># Lista completa de tus variables</span>
<span class="n">columnas</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id_01&#39;</span><span class="p">,</span> <span class="s1">&#39;id_02&#39;</span><span class="p">,</span> <span class="s1">&#39;id_05&#39;</span><span class="p">,</span> <span class="s1">&#39;id_06&#39;</span><span class="p">,</span> <span class="s1">&#39;id_09&#39;</span><span class="p">,</span> <span class="s1">&#39;id_10&#39;</span><span class="p">,</span> <span class="s1">&#39;id_19&#39;</span><span class="p">,</span> <span class="s1">&#39;id_20&#39;</span><span class="p">,</span> <span class="s1">&#39;isfraud&#39;</span><span class="p">,</span>
            <span class="s1">&#39;transactiondt&#39;</span><span class="p">,</span> <span class="s1">&#39;transactionamt&#39;</span><span class="p">,</span> <span class="s1">&#39;card1&#39;</span><span class="p">,</span> <span class="s1">&#39;card2&#39;</span><span class="p">,</span> <span class="s1">&#39;addr1&#39;</span><span class="p">,</span> <span class="s1">&#39;c3&#39;</span><span class="p">,</span> <span class="s1">&#39;c14&#39;</span><span class="p">,</span> <span class="s1">&#39;d1&#39;</span><span class="p">,</span> <span class="s1">&#39;d8&#39;</span><span class="p">,</span> <span class="s1">&#39;d9&#39;</span><span class="p">,</span>
            <span class="s1">&#39;v98&#39;</span><span class="p">,</span> <span class="s1">&#39;v124&#39;</span><span class="p">,</span> <span class="s1">&#39;v135&#39;</span><span class="p">,</span> <span class="s1">&#39;v138&#39;</span><span class="p">,</span> <span class="s1">&#39;v140&#39;</span><span class="p">,</span> <span class="s1">&#39;v141&#39;</span><span class="p">,</span> <span class="s1">&#39;v142&#39;</span><span class="p">,</span> <span class="s1">&#39;v146&#39;</span><span class="p">,</span> <span class="s1">&#39;v149&#39;</span><span class="p">,</span> <span class="s1">&#39;v152&#39;</span><span class="p">,</span> <span class="s1">&#39;v159&#39;</span><span class="p">,</span>
            <span class="s1">&#39;v160&#39;</span><span class="p">,</span> <span class="s1">&#39;v161&#39;</span><span class="p">,</span> <span class="s1">&#39;v162&#39;</span><span class="p">,</span> <span class="s1">&#39;v164&#39;</span><span class="p">,</span> <span class="s1">&#39;v169&#39;</span><span class="p">,</span> <span class="s1">&#39;v172&#39;</span><span class="p">,</span> <span class="s1">&#39;v173&#39;</span><span class="p">,</span> <span class="s1">&#39;v174&#39;</span><span class="p">,</span> <span class="s1">&#39;v175&#39;</span><span class="p">,</span> <span class="s1">&#39;v177&#39;</span><span class="p">,</span> <span class="s1">&#39;v184&#39;</span><span class="p">,</span>
            <span class="s1">&#39;v185&#39;</span><span class="p">,</span> <span class="s1">&#39;v208&#39;</span><span class="p">,</span> <span class="s1">&#39;v220&#39;</span><span class="p">,</span> <span class="s1">&#39;v223&#39;</span><span class="p">,</span> <span class="s1">&#39;v224&#39;</span><span class="p">,</span> <span class="s1">&#39;v225&#39;</span><span class="p">,</span> <span class="s1">&#39;v226&#39;</span><span class="p">,</span> <span class="s1">&#39;v227&#39;</span><span class="p">,</span> <span class="s1">&#39;v229&#39;</span><span class="p">,</span> <span class="s1">&#39;v238&#39;</span><span class="p">,</span> <span class="s1">&#39;v250&#39;</span><span class="p">,</span>
            <span class="s1">&#39;v261&#39;</span><span class="p">,</span> <span class="s1">&#39;v267&#39;</span><span class="p">,</span> <span class="s1">&#39;v271&#39;</span><span class="p">,</span> <span class="s1">&#39;v274&#39;</span><span class="p">,</span> <span class="s1">&#39;v277&#39;</span><span class="p">,</span> <span class="s1">&#39;v281&#39;</span><span class="p">,</span> <span class="s1">&#39;v282&#39;</span><span class="p">,</span> <span class="s1">&#39;v286&#39;</span><span class="p">,</span> <span class="s1">&#39;v287&#39;</span><span class="p">,</span> <span class="s1">&#39;v289&#39;</span><span class="p">,</span> <span class="s1">&#39;v291&#39;</span><span class="p">,</span>
            <span class="s1">&#39;v296&#39;</span><span class="p">,</span> <span class="s1">&#39;v301&#39;</span><span class="p">,</span> <span class="s1">&#39;v311&#39;</span><span class="p">,</span> <span class="s1">&#39;v313&#39;</span><span class="p">,</span> <span class="s1">&#39;v314&#39;</span><span class="p">,</span> <span class="s1">&#39;v326&#39;</span><span class="p">,</span> <span class="s1">&#39;v335&#39;</span><span class="p">,</span> <span class="s1">&#39;v338&#39;</span><span class="p">,</span> <span class="s1">&#39;id_38&#39;</span><span class="p">,</span> <span class="s1">&#39;card6&#39;</span><span class="p">,</span> <span class="s1">&#39;transaction_hour&#39;</span><span class="p">]</span>

<span class="c1"># Graficar proporciones de fraude para columnas con baja cardinalidad</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columnas</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">col</span> <span class="o">!=</span> <span class="s1">&#39;isfraud&#39;</span><span class="p">:</span>
        <span class="n">proporciones</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">col</span><span class="p">)[</span><span class="s1">&#39;isfraud&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">proporciones</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">proporciones</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Proporción de fraude por valor en: </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Proporción de fraude&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d8ecbe297fbe4718c7924826c31de864a61e8ef5a6189c65de587518d2286ab8.png" src="_images/d8ecbe297fbe4718c7924826c31de864a61e8ef5a6189c65de587518d2286ab8.png" />
<img alt="_images/3cec29578af799c5d38b4662b858e9918862a968dd8957de975efd4998e5836f.png" src="_images/3cec29578af799c5d38b4662b858e9918862a968dd8957de975efd4998e5836f.png" />
<img alt="_images/2273a4bd559d81ca90c346911728b72b7e49a396c95dfa931ef8c39849044662.png" src="_images/2273a4bd559d81ca90c346911728b72b7e49a396c95dfa931ef8c39849044662.png" />
<img alt="_images/0049b7fcc3735ea838b19b8b0b191d175f8499ca35a7c2675ea9e4793bf5176c.png" src="_images/0049b7fcc3735ea838b19b8b0b191d175f8499ca35a7c2675ea9e4793bf5176c.png" />
<img alt="_images/8c593e4c9ba1360f0829de6cf2cedf5e92f5b272ac8e53c3bb7e73815eff5b13.png" src="_images/8c593e4c9ba1360f0829de6cf2cedf5e92f5b272ac8e53c3bb7e73815eff5b13.png" />
<img alt="_images/1701c7bfab823c488cd644b658753212aa39d5c8f4eb1fce8a668e3b3d42357f.png" src="_images/1701c7bfab823c488cd644b658753212aa39d5c8f4eb1fce8a668e3b3d42357f.png" />
<img alt="_images/228c5b34ad9fc93f899e40148bae47eec86e3f0fb20a1695feb9026558b7f878.png" src="_images/228c5b34ad9fc93f899e40148bae47eec86e3f0fb20a1695feb9026558b7f878.png" />
<img alt="_images/4f27668fcbadc4f3f226d2b0acaaccfea653d35198623abcb850b1900987c745.png" src="_images/4f27668fcbadc4f3f226d2b0acaaccfea653d35198623abcb850b1900987c745.png" />
<img alt="_images/9e3b3ab2c0a5b890058935fc85f6fa0ad6f6c49fbc450ceb412dbcb193870ac3.png" src="_images/9e3b3ab2c0a5b890058935fc85f6fa0ad6f6c49fbc450ceb412dbcb193870ac3.png" />
<img alt="_images/74dd831a037f06b72aa1b69f0fe4e52dbf10f1b5387739d686fee9784d3c592d.png" src="_images/74dd831a037f06b72aa1b69f0fe4e52dbf10f1b5387739d686fee9784d3c592d.png" />
<img alt="_images/fcdd3bbe6f0415dfcd631089ddfd107d88ef297eb2e08b996d2256006579c8d5.png" src="_images/fcdd3bbe6f0415dfcd631089ddfd107d88ef297eb2e08b996d2256006579c8d5.png" />
<img alt="_images/554fd4c1bd31a0ec7a7a0984f34f59b5b95c7c1b1d72129ab9d11dc5936283d2.png" src="_images/554fd4c1bd31a0ec7a7a0984f34f59b5b95c7c1b1d72129ab9d11dc5936283d2.png" />
<img alt="_images/d1e2514bb2695962c7d8758b553bd2df8a55fe38791df797266f29d9be4a6dac.png" src="_images/d1e2514bb2695962c7d8758b553bd2df8a55fe38791df797266f29d9be4a6dac.png" />
<img alt="_images/023041c7031b0ba7006e248e2ba1daa62db90c8030d344f5c3cb2357adc72196.png" src="_images/023041c7031b0ba7006e248e2ba1daa62db90c8030d344f5c3cb2357adc72196.png" />
<img alt="_images/ac7eb9a59f759929e5e40dda82e6c8a58e7f4e9057e6064fe1ffb7ba5ff683a2.png" src="_images/ac7eb9a59f759929e5e40dda82e6c8a58e7f4e9057e6064fe1ffb7ba5ff683a2.png" />
<img alt="_images/d36ee9ad81c856ef14b2b963a35a236d655952191c8137b1cf15a4ae27927d15.png" src="_images/d36ee9ad81c856ef14b2b963a35a236d655952191c8137b1cf15a4ae27927d15.png" />
<img alt="_images/31aa9da83134be64ed7a7a968f509f64f03a46bb2a480666e34c4846d68488f0.png" src="_images/31aa9da83134be64ed7a7a968f509f64f03a46bb2a480666e34c4846d68488f0.png" />
<img alt="_images/93aa1212d139c12a7a5a98b51385b4840a730de9b40335ca50db8f1ee933687b.png" src="_images/93aa1212d139c12a7a5a98b51385b4840a730de9b40335ca50db8f1ee933687b.png" />
<img alt="_images/d0ac14308fbfffed385972cc57ef851192ec28d6c3e1d49c796447e27139ef00.png" src="_images/d0ac14308fbfffed385972cc57ef851192ec28d6c3e1d49c796447e27139ef00.png" />
<img alt="_images/5151a2124980b9dab146a9562864e35ce08bb9d4b8e8c99af5e6b070b0e5a495.png" src="_images/5151a2124980b9dab146a9562864e35ce08bb9d4b8e8c99af5e6b070b0e5a495.png" />
<img alt="_images/cdcbd3254cee8cb987306aa297d929ef2d6110af852bd336790b84256264eb7e.png" src="_images/cdcbd3254cee8cb987306aa297d929ef2d6110af852bd336790b84256264eb7e.png" />
<img alt="_images/bd655be986185d007557bfaccc980aacfca5ac823ed299113e4bb9dce5a181df.png" src="_images/bd655be986185d007557bfaccc980aacfca5ac823ed299113e4bb9dce5a181df.png" />
<img alt="_images/76bed9621fb56d861e35554ff2a141c3b0211dcc9425f2d27ba123fb6b990f30.png" src="_images/76bed9621fb56d861e35554ff2a141c3b0211dcc9425f2d27ba123fb6b990f30.png" />
<img alt="_images/e4b78debd7b08694297c2bc105acd7413273f2bda01553a0ae4230b13132e189.png" src="_images/e4b78debd7b08694297c2bc105acd7413273f2bda01553a0ae4230b13132e189.png" />
<img alt="_images/39a223ab05c0cf06ddfb7d1753ec22930df44905f389e8dc5e8e76cd44b7fdbf.png" src="_images/39a223ab05c0cf06ddfb7d1753ec22930df44905f389e8dc5e8e76cd44b7fdbf.png" />
<img alt="_images/bbbbfb94d668daf4ad99e615fbf309a83580502251b92e84a42ef1058bc3fdc4.png" src="_images/bbbbfb94d668daf4ad99e615fbf309a83580502251b92e84a42ef1058bc3fdc4.png" />
<img alt="_images/47ec90bfd453550489b0a8364c0fd6342f9ab6f89064d9ca3a94af6c016adf30.png" src="_images/47ec90bfd453550489b0a8364c0fd6342f9ab6f89064d9ca3a94af6c016adf30.png" />
</div>
</div>
<p>A partir de las gráficas generadas que representan la proporción de fraude por valor específico en distintas variables con baja cardinalidad, se pueden observar patrones interesantes de asociación entre ciertos valores y la variable objetivo <code class="docutils literal notranslate"><span class="pre">isfraud</span></code>. La mayoría de las variables analizadas provienen del grupo codificado como <code class="docutils literal notranslate"><span class="pre">vXXX</span></code>, correspondiente a funciones de la plataforma Vesta relacionadas con clasificaciones y relaciones entre entidades. Por ejemplo, variables como <code class="docutils literal notranslate"><span class="pre">v124</span></code>, <code class="docutils literal notranslate"><span class="pre">v142</span></code>, <code class="docutils literal notranslate"><span class="pre">v146</span></code> o <code class="docutils literal notranslate"><span class="pre">v238</span></code> muestran una concentración significativa de fraude en un subconjunto reducido de valores, con proporciones que incluso alcanzan el 100% para ciertos casos, lo que sugiere que pueden tener una alta capacidad discriminativa si se utilizan adecuadamente en el modelo.</p>
<p>Este análisis resulta útil para detectar valores que podrían estar correlacionados con transacciones fraudulentas, especialmente en contextos donde la variable original ha sido codificada y no se tiene una interpretación directa. A pesar de ello, hay que tener en cuenta que no todas las variables mostraron un patrón claro; algunas como <code class="docutils literal notranslate"><span class="pre">c3</span></code> o <code class="docutils literal notranslate"><span class="pre">v286</span></code> presentan una distribución mucho más homogénea o irrelevante.</p>
<p>Estos hallazgos respaldan la necesidad de tratar estas variables con criterios adicionales (como su relevancia estadística o mediante técnicas automáticas de selección) en lugar de descartar a priori por su naturaleza codificada. En definitiva, este enfoque permite rescatar señales útiles incluso en variables no interpretables directamente.</p>
<section id="transformacion-final">
<h3><strong>Transformación final</strong><a class="headerlink" href="#transformacion-final" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd"># Eliminar columna original si ya no se usará</span>
<span class="sd">df = df.drop(columns=[&#39;transactionamt&#39;])</span>

<span class="sd"># Renombrar la transformada para mantener consistencia</span>
<span class="sd">df.rename(columns={&#39;transactionamt_log&#39;: &#39;transactionamt&#39;}, inplace=True)</span>

<span class="sd"># Guardar</span>
<span class="sd">df.to_csv(&quot;fraude_final.csv&quot;, index=False)</span>

<span class="sd">print(&quot;Dataset guardado como &#39;fraude_final.csv&#39; con la versión logarítmica.&quot;)</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Limpieza.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Procesamiento de los datos</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="Modelo_clasificacion.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Modelos de Clasificación</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias"><strong>Librerias</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contextualizacion-del-conjunto-de-datos"><strong>Contextualización del Conjunto de Datos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformacion-final"><strong>Transformación final</strong></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>