
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Procesamiento de los datos &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Limpieza';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Análisis Exploratorio de Datos (EDA)" href="EDA.html" />
    <link rel="prev" title="Proyecto de Detección de Fraude" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpeg" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.jpeg" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Proyecto de Detección de Fraude
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Procesamiento de los datos</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="EDA.html"><strong>Análisis Exploratorio de Datos (EDA)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Modelo_clasificacion.html"><strong>Modelos de Clasificación</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Pipeline_modelos.html"><strong>Modelos con Pipelines</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Modelo_original.html"><strong>Modelo Original</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FLimpieza.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Limpieza.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Procesamiento de los datos</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias"><strong>Librerias</strong></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="procesamiento-de-los-datos">
<h1><strong>Procesamiento de los datos</strong><a class="headerlink" href="#procesamiento-de-los-datos" title="Link to this heading">#</a></h1>
<section id="librerias">
<h2><strong>Librerias</strong><a class="headerlink" href="#librerias" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">anderson</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span> <span class="k">as</span> <span class="n">PILImage</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Cargar los datasets</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;train_transaction.csv&quot;</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;train_identity.csv&quot;</span><span class="p">)</span>


<span class="c1">#Exploración inicial</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Primer dataset:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Primer dataset:
   TransactionID  isFraud  TransactionDT  TransactionAmt ProductCD  card1  \
0        2987000        0          86400            68.5         W  13926   
1        2987001        0          86401            29.0         W   2755   
2        2987002        0          86469            59.0         W   4663   
3        2987003        0          86499            50.0         W  18132   
4        2987004        0          86506            50.0         H   4497   

   card2  card3       card4  card5  ... V330  V331  V332  V333  V334 V335  \
0    NaN  150.0    discover  142.0  ...  NaN   NaN   NaN   NaN   NaN  NaN   
1  404.0  150.0  mastercard  102.0  ...  NaN   NaN   NaN   NaN   NaN  NaN   
2  490.0  150.0        visa  166.0  ...  NaN   NaN   NaN   NaN   NaN  NaN   
3  567.0  150.0  mastercard  117.0  ...  NaN   NaN   NaN   NaN   NaN  NaN   
4  514.0  150.0  mastercard  102.0  ...  0.0   0.0   0.0   0.0   0.0  0.0   

  V336  V337  V338  V339  
0  NaN   NaN   NaN   NaN  
1  NaN   NaN   NaN   NaN  
2  NaN   NaN   NaN   NaN  
3  NaN   NaN   NaN   NaN  
4  0.0   0.0   0.0   0.0  

[5 rows x 394 columns]
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 590540 entries, 0 to 590539
Columns: 394 entries, TransactionID to V339
dtypes: float64(376), int64(4), object(14)
memory usage: 1.7+ GB
None
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Segundo dataset:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Segundo dataset:
   TransactionID  id_01     id_02  id_03  id_04  id_05  id_06  id_07  id_08  \
0        2987004    0.0   70787.0    NaN    NaN    NaN    NaN    NaN    NaN   
1        2987008   -5.0   98945.0    NaN    NaN    0.0   -5.0    NaN    NaN   
2        2987010   -5.0  191631.0    0.0    0.0    0.0    0.0    NaN    NaN   
3        2987011   -5.0  221832.0    NaN    NaN    0.0   -6.0    NaN    NaN   
4        2987016    0.0    7460.0    0.0    0.0    1.0    0.0    NaN    NaN   

   id_09  ...                id_31  id_32      id_33           id_34  id_35  \
0    NaN  ...  samsung browser 6.2   32.0  2220x1080  match_status:2      T   
1    NaN  ...   mobile safari 11.0   32.0   1334x750  match_status:1      T   
2    0.0  ...          chrome 62.0    NaN        NaN             NaN      F   
3    NaN  ...          chrome 62.0    NaN        NaN             NaN      F   
4    0.0  ...          chrome 62.0   24.0   1280x800  match_status:2      T   

  id_36 id_37  id_38  DeviceType                     DeviceInfo  
0     F     T      T      mobile  SAMSUNG SM-G892A Build/NRD90M  
1     F     F      T      mobile                     iOS Device  
2     F     T      T     desktop                        Windows  
3     F     T      T     desktop                            NaN  
4     F     T      T     desktop                          MacOS  

[5 rows x 41 columns]
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 144233 entries, 0 to 144232
Data columns (total 41 columns):
 #   Column         Non-Null Count   Dtype  
---  ------         --------------   -----  
 0   TransactionID  144233 non-null  int64  
 1   id_01          144233 non-null  float64
 2   id_02          140872 non-null  float64
 3   id_03          66324 non-null   float64
 4   id_04          66324 non-null   float64
 5   id_05          136865 non-null  float64
 6   id_06          136865 non-null  float64
 7   id_07          5155 non-null    float64
 8   id_08          5155 non-null    float64
 9   id_09          74926 non-null   float64
 10  id_10          74926 non-null   float64
 11  id_11          140978 non-null  float64
 12  id_12          144233 non-null  object 
 13  id_13          127320 non-null  float64
 14  id_14          80044 non-null   float64
 15  id_15          140985 non-null  object 
 16  id_16          129340 non-null  object 
 17  id_17          139369 non-null  float64
 18  id_18          45113 non-null   float64
 19  id_19          139318 non-null  float64
 20  id_20          139261 non-null  float64
 21  id_21          5159 non-null    float64
 22  id_22          5169 non-null    float64
 23  id_23          5169 non-null    object 
 24  id_24          4747 non-null    float64
 25  id_25          5132 non-null    float64
 26  id_26          5163 non-null    float64
 27  id_27          5169 non-null    object 
 28  id_28          140978 non-null  object 
 29  id_29          140978 non-null  object 
 30  id_30          77565 non-null   object 
 31  id_31          140282 non-null  object 
 32  id_32          77586 non-null   float64
 33  id_33          73289 non-null   object 
 34  id_34          77805 non-null   object 
 35  id_35          140985 non-null  object 
 36  id_36          140985 non-null  object 
 37  id_37          140985 non-null  object 
 38  id_38          140985 non-null  object 
 39  DeviceType     140810 non-null  object 
 40  DeviceInfo     118666 non-null  object 
dtypes: float64(23), int64(1), object(17)
memory usage: 45.1+ MB
None
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convertir nombres de columnas a minúsculas</span>
<span class="n">df1</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">df2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="c1"># Revisar si hay duplicados por TransactionID</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Duplicados en df1:&quot;</span><span class="p">,</span> <span class="n">df1</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;transactionid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Duplicados en df2:&quot;</span><span class="p">,</span> <span class="n">df2</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;transactionid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Duplicados en df1: 0
Duplicados en df2: 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar todas las filas sin truncamiento</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># Volver a imprimir el resultado completo</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Porcentaje de valores nulos en df2 (train_transaction):&quot;</span><span class="p">)</span>
<span class="n">missing_df1</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="n">missing_df1</span><span class="p">[</span><span class="n">missing_df1</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Porcentaje de valores nulos en df2 (train_transaction):
dist2            93.63
d7               93.41
d13              89.51
d14              89.47
d12              89.04
d6               87.61
d9               87.31
d8               87.31
v153             86.12
v139             86.12
v162             86.12
v161             86.12
v154             86.12
v138             86.12
v158             86.12
v157             86.12
v163             86.12
v156             86.12
v155             86.12
v149             86.12
v148             86.12
v147             86.12
v146             86.12
v142             86.12
v141             86.12
v140             86.12
v151             86.12
v152             86.12
v145             86.12
v144             86.12
v150             86.12
v143             86.12
v160             86.12
v166             86.12
v164             86.12
v159             86.12
v165             86.12
v322             86.05
v332             86.05
v338             86.05
v337             86.05
v336             86.05
v335             86.05
v334             86.05
v333             86.05
v331             86.05
v323             86.05
v330             86.05
v328             86.05
v327             86.05
v326             86.05
v325             86.05
v324             86.05
v329             86.05
v339             86.05
v240             77.91
v235             77.91
v252             77.91
v249             77.91
v248             77.91
v247             77.91
v246             77.91
v244             77.91
v243             77.91
v242             77.91
v241             77.91
v237             77.91
v236             77.91
v233             77.91
v254             77.91
v232             77.91
v231             77.91
v230             77.91
v229             77.91
v228             77.91
v217             77.91
v226             77.91
v225             77.91
v224             77.91
v223             77.91
v218             77.91
v253             77.91
v219             77.91
v266             77.91
v262             77.91
v268             77.91
v267             77.91
v273             77.91
v274             77.91
v275             77.91
v276             77.91
v265             77.91
v264             77.91
v263             77.91
v277             77.91
v261             77.91
v260             77.91
v278             77.91
v258             77.91
v257             77.91
v269             77.91
r_emaildomain    76.75
v203             76.36
v196             76.36
v202             76.36
v207             76.36
v204             76.36
v216             76.36
v206             76.36
v215             76.36
v214             76.36
v213             76.36
v212             76.36
v205             76.36
v211             76.36
v192             76.36
v193             76.36
v186             76.36
v183             76.36
v190             76.36
v167             76.36
v168             76.36
v187             76.36
v172             76.36
v173             76.36
v182             76.36
v199             76.36
v176             76.36
v177             76.36
v178             76.36
v179             76.36
v191             76.36
v181             76.36
v195             76.32
v189             76.32
v198             76.32
v188             76.32
v197             76.32
v194             76.32
v170             76.32
v200             76.32
v201             76.32
v208             76.32
v209             76.32
v210             76.32
v184             76.32
v185             76.32
v175             76.32
v174             76.32
v171             76.32
v169             76.32
v180             76.32
v221             76.05
v220             76.05
v250             76.05
v272             76.05
v271             76.05
v270             76.05
v256             76.05
v255             76.05
v251             76.05
v259             76.05
v245             76.05
v239             76.05
v238             76.05
v234             76.05
v227             76.05
v222             76.05
dist1            59.65
m5               59.35
m7               58.64
m9               58.63
m8               58.63
d5               52.47
m4               47.66
d2               47.55
v2               47.29
d11              47.29
v1               47.29
v6               47.29
v7               47.29
v8               47.29
v9               47.29
v10              47.29
v11              47.29
v5               47.29
v3               47.29
v4               47.29
m3               45.91
m1               45.91
m2               45.91
d3               44.51
m6               28.68
v35              28.61
v36              28.61
v38              28.61
v51              28.61
v52              28.61
v50              28.61
v49              28.61
v48              28.61
v47              28.61
v46              28.61
v45              28.61
v44              28.61
v43              28.61
v42              28.61
v41              28.61
v40              28.61
v37              28.61
v39              28.61
d4               28.60
p_emaildomain    15.99
v82              15.10
v91              15.10
v76              15.10
v77              15.10
v78              15.10
v79              15.10
v94              15.10
v93              15.10
v92              15.10
v89              15.10
v90              15.10
v81              15.10
v88              15.10
v87              15.10
v86              15.10
v85              15.10
v84              15.10
v83              15.10
v75              15.10
v80              15.10
d15              15.09
v70              13.06
v62              13.06
v53              13.06
v54              13.06
v55              13.06
v56              13.06
v57              13.06
v58              13.06
v59              13.06
v60              13.06
v61              13.06
v63              13.06
v72              13.06
v64              13.06
v65              13.06
v66              13.06
v67              13.06
v68              13.06
v69              13.06
v74              13.06
v73              13.06
v71              13.06
v33              12.88
v15              12.88
v24              12.88
v12              12.88
v13              12.88
v14              12.88
v16              12.88
v17              12.88
v18              12.88
v19              12.88
v21              12.88
v22              12.88
v23              12.88
v20              12.88
v25              12.88
v30              12.88
v34              12.88
v26              12.88
v31              12.88
v32              12.88
v29              12.88
v28              12.88
v27              12.88
d10              12.87
addr1            11.13
addr2            11.13
card2             1.51
card5             0.72
card4             0.27
card6             0.27
card3             0.27
v315              0.21
v282              0.21
d1                0.21
v314              0.21
v313              0.21
v301              0.21
v300              0.21
v283              0.21
v288              0.21
v296              0.21
v289              0.21
v281              0.21
v125              0.05
v126              0.05
v117              0.05
v128              0.05
v129              0.05
v130              0.05
v131              0.05
v133              0.05
v134              0.05
v135              0.05
v136              0.05
v118              0.05
v116              0.05
v137              0.05
v119              0.05
v120              0.05
v124              0.05
v123              0.05
v95               0.05
v121              0.05
v122              0.05
v127              0.05
v132              0.05
v115              0.05
v97               0.05
v99               0.05
v100              0.05
v101              0.05
v102              0.05
v103              0.05
v114              0.05
v104              0.05
v105              0.05
v98               0.05
v106              0.05
v107              0.05
v108              0.05
v109              0.05
v96               0.05
v110              0.05
v111              0.05
v112              0.05
v113              0.05
v306              0.00
v311              0.00
v308              0.00
v309              0.00
v310              0.00
v307              0.00
v317              0.00
v312              0.00
v316              0.00
v318              0.00
v319              0.00
v320              0.00
v321              0.00
v304              0.00
v305              0.00
v293              0.00
v303              0.00
v291              0.00
v302              0.00
v279              0.00
v280              0.00
v284              0.00
v285              0.00
v287              0.00
v290              0.00
v286              0.00
v292              0.00
v294              0.00
v295              0.00
v297              0.00
v298              0.00
v299              0.00
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar todas las filas sin truncamiento</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># Volver a imprimir el resultado completo</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Porcentaje de valores nulos en df2 (train_transaction):&quot;</span><span class="p">)</span>
<span class="n">missing_df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="n">missing_df2</span><span class="p">[</span><span class="n">missing_df2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Porcentaje de valores nulos en df2 (train_transaction):
id_24         96.71
id_25         96.44
id_07         96.43
id_08         96.43
id_21         96.42
id_26         96.42
id_23         96.42
id_27         96.42
id_22         96.42
id_18         68.72
id_03         54.02
id_04         54.02
id_33         49.19
id_09         48.05
id_10         48.05
id_30         46.22
id_32         46.21
id_34         46.06
id_14         44.50
deviceinfo    17.73
id_13         11.73
id_16         10.33
id_06          5.11
id_05          5.11
id_20          3.45
id_19          3.41
id_17          3.37
id_31          2.74
devicetype     2.37
id_02          2.33
id_28          2.26
id_29          2.26
id_11          2.26
id_15          2.25
id_35          2.25
id_36          2.25
id_37          2.25
id_38          2.25
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verificar nombres en df1 y df2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;transactionid&#39;, &#39;isfraud&#39;, &#39;transactiondt&#39;, &#39;transactionamt&#39;, &#39;productcd&#39;, &#39;card1&#39;, &#39;card2&#39;, &#39;card3&#39;, &#39;card4&#39;, &#39;card5&#39;, &#39;card6&#39;, &#39;addr1&#39;, &#39;addr2&#39;, &#39;dist1&#39;, &#39;dist2&#39;, &#39;p_emaildomain&#39;, &#39;r_emaildomain&#39;, &#39;c1&#39;, &#39;c2&#39;, &#39;c3&#39;, &#39;c4&#39;, &#39;c5&#39;, &#39;c6&#39;, &#39;c7&#39;, &#39;c8&#39;, &#39;c9&#39;, &#39;c10&#39;, &#39;c11&#39;, &#39;c12&#39;, &#39;c13&#39;, &#39;c14&#39;, &#39;d1&#39;, &#39;d2&#39;, &#39;d3&#39;, &#39;d4&#39;, &#39;d5&#39;, &#39;d6&#39;, &#39;d7&#39;, &#39;d8&#39;, &#39;d9&#39;, &#39;d10&#39;, &#39;d11&#39;, &#39;d12&#39;, &#39;d13&#39;, &#39;d14&#39;, &#39;d15&#39;, &#39;m1&#39;, &#39;m2&#39;, &#39;m3&#39;, &#39;m4&#39;, &#39;m5&#39;, &#39;m6&#39;, &#39;m7&#39;, &#39;m8&#39;, &#39;m9&#39;, &#39;v1&#39;, &#39;v2&#39;, &#39;v3&#39;, &#39;v4&#39;, &#39;v5&#39;, &#39;v6&#39;, &#39;v7&#39;, &#39;v8&#39;, &#39;v9&#39;, &#39;v10&#39;, &#39;v11&#39;, &#39;v12&#39;, &#39;v13&#39;, &#39;v14&#39;, &#39;v15&#39;, &#39;v16&#39;, &#39;v17&#39;, &#39;v18&#39;, &#39;v19&#39;, &#39;v20&#39;, &#39;v21&#39;, &#39;v22&#39;, &#39;v23&#39;, &#39;v24&#39;, &#39;v25&#39;, &#39;v26&#39;, &#39;v27&#39;, &#39;v28&#39;, &#39;v29&#39;, &#39;v30&#39;, &#39;v31&#39;, &#39;v32&#39;, &#39;v33&#39;, &#39;v34&#39;, &#39;v35&#39;, &#39;v36&#39;, &#39;v37&#39;, &#39;v38&#39;, &#39;v39&#39;, &#39;v40&#39;, &#39;v41&#39;, &#39;v42&#39;, &#39;v43&#39;, &#39;v44&#39;, &#39;v45&#39;, &#39;v46&#39;, &#39;v47&#39;, &#39;v48&#39;, &#39;v49&#39;, &#39;v50&#39;, &#39;v51&#39;, &#39;v52&#39;, &#39;v53&#39;, &#39;v54&#39;, &#39;v55&#39;, &#39;v56&#39;, &#39;v57&#39;, &#39;v58&#39;, &#39;v59&#39;, &#39;v60&#39;, &#39;v61&#39;, &#39;v62&#39;, &#39;v63&#39;, &#39;v64&#39;, &#39;v65&#39;, &#39;v66&#39;, &#39;v67&#39;, &#39;v68&#39;, &#39;v69&#39;, &#39;v70&#39;, &#39;v71&#39;, &#39;v72&#39;, &#39;v73&#39;, &#39;v74&#39;, &#39;v75&#39;, &#39;v76&#39;, &#39;v77&#39;, &#39;v78&#39;, &#39;v79&#39;, &#39;v80&#39;, &#39;v81&#39;, &#39;v82&#39;, &#39;v83&#39;, &#39;v84&#39;, &#39;v85&#39;, &#39;v86&#39;, &#39;v87&#39;, &#39;v88&#39;, &#39;v89&#39;, &#39;v90&#39;, &#39;v91&#39;, &#39;v92&#39;, &#39;v93&#39;, &#39;v94&#39;, &#39;v95&#39;, &#39;v96&#39;, &#39;v97&#39;, &#39;v98&#39;, &#39;v99&#39;, &#39;v100&#39;, &#39;v101&#39;, &#39;v102&#39;, &#39;v103&#39;, &#39;v104&#39;, &#39;v105&#39;, &#39;v106&#39;, &#39;v107&#39;, &#39;v108&#39;, &#39;v109&#39;, &#39;v110&#39;, &#39;v111&#39;, &#39;v112&#39;, &#39;v113&#39;, &#39;v114&#39;, &#39;v115&#39;, &#39;v116&#39;, &#39;v117&#39;, &#39;v118&#39;, &#39;v119&#39;, &#39;v120&#39;, &#39;v121&#39;, &#39;v122&#39;, &#39;v123&#39;, &#39;v124&#39;, &#39;v125&#39;, &#39;v126&#39;, &#39;v127&#39;, &#39;v128&#39;, &#39;v129&#39;, &#39;v130&#39;, &#39;v131&#39;, &#39;v132&#39;, &#39;v133&#39;, &#39;v134&#39;, &#39;v135&#39;, &#39;v136&#39;, &#39;v137&#39;, &#39;v138&#39;, &#39;v139&#39;, &#39;v140&#39;, &#39;v141&#39;, &#39;v142&#39;, &#39;v143&#39;, &#39;v144&#39;, &#39;v145&#39;, &#39;v146&#39;, &#39;v147&#39;, &#39;v148&#39;, &#39;v149&#39;, &#39;v150&#39;, &#39;v151&#39;, &#39;v152&#39;, &#39;v153&#39;, &#39;v154&#39;, &#39;v155&#39;, &#39;v156&#39;, &#39;v157&#39;, &#39;v158&#39;, &#39;v159&#39;, &#39;v160&#39;, &#39;v161&#39;, &#39;v162&#39;, &#39;v163&#39;, &#39;v164&#39;, &#39;v165&#39;, &#39;v166&#39;, &#39;v167&#39;, &#39;v168&#39;, &#39;v169&#39;, &#39;v170&#39;, &#39;v171&#39;, &#39;v172&#39;, &#39;v173&#39;, &#39;v174&#39;, &#39;v175&#39;, &#39;v176&#39;, &#39;v177&#39;, &#39;v178&#39;, &#39;v179&#39;, &#39;v180&#39;, &#39;v181&#39;, &#39;v182&#39;, &#39;v183&#39;, &#39;v184&#39;, &#39;v185&#39;, &#39;v186&#39;, &#39;v187&#39;, &#39;v188&#39;, &#39;v189&#39;, &#39;v190&#39;, &#39;v191&#39;, &#39;v192&#39;, &#39;v193&#39;, &#39;v194&#39;, &#39;v195&#39;, &#39;v196&#39;, &#39;v197&#39;, &#39;v198&#39;, &#39;v199&#39;, &#39;v200&#39;, &#39;v201&#39;, &#39;v202&#39;, &#39;v203&#39;, &#39;v204&#39;, &#39;v205&#39;, &#39;v206&#39;, &#39;v207&#39;, &#39;v208&#39;, &#39;v209&#39;, &#39;v210&#39;, &#39;v211&#39;, &#39;v212&#39;, &#39;v213&#39;, &#39;v214&#39;, &#39;v215&#39;, &#39;v216&#39;, &#39;v217&#39;, &#39;v218&#39;, &#39;v219&#39;, &#39;v220&#39;, &#39;v221&#39;, &#39;v222&#39;, &#39;v223&#39;, &#39;v224&#39;, &#39;v225&#39;, &#39;v226&#39;, &#39;v227&#39;, &#39;v228&#39;, &#39;v229&#39;, &#39;v230&#39;, &#39;v231&#39;, &#39;v232&#39;, &#39;v233&#39;, &#39;v234&#39;, &#39;v235&#39;, &#39;v236&#39;, &#39;v237&#39;, &#39;v238&#39;, &#39;v239&#39;, &#39;v240&#39;, &#39;v241&#39;, &#39;v242&#39;, &#39;v243&#39;, &#39;v244&#39;, &#39;v245&#39;, &#39;v246&#39;, &#39;v247&#39;, &#39;v248&#39;, &#39;v249&#39;, &#39;v250&#39;, &#39;v251&#39;, &#39;v252&#39;, &#39;v253&#39;, &#39;v254&#39;, &#39;v255&#39;, &#39;v256&#39;, &#39;v257&#39;, &#39;v258&#39;, &#39;v259&#39;, &#39;v260&#39;, &#39;v261&#39;, &#39;v262&#39;, &#39;v263&#39;, &#39;v264&#39;, &#39;v265&#39;, &#39;v266&#39;, &#39;v267&#39;, &#39;v268&#39;, &#39;v269&#39;, &#39;v270&#39;, &#39;v271&#39;, &#39;v272&#39;, &#39;v273&#39;, &#39;v274&#39;, &#39;v275&#39;, &#39;v276&#39;, &#39;v277&#39;, &#39;v278&#39;, &#39;v279&#39;, &#39;v280&#39;, &#39;v281&#39;, &#39;v282&#39;, &#39;v283&#39;, &#39;v284&#39;, &#39;v285&#39;, &#39;v286&#39;, &#39;v287&#39;, &#39;v288&#39;, &#39;v289&#39;, &#39;v290&#39;, &#39;v291&#39;, &#39;v292&#39;, &#39;v293&#39;, &#39;v294&#39;, &#39;v295&#39;, &#39;v296&#39;, &#39;v297&#39;, &#39;v298&#39;, &#39;v299&#39;, &#39;v300&#39;, &#39;v301&#39;, &#39;v302&#39;, &#39;v303&#39;, &#39;v304&#39;, &#39;v305&#39;, &#39;v306&#39;, &#39;v307&#39;, &#39;v308&#39;, &#39;v309&#39;, &#39;v310&#39;, &#39;v311&#39;, &#39;v312&#39;, &#39;v313&#39;, &#39;v314&#39;, &#39;v315&#39;, &#39;v316&#39;, &#39;v317&#39;, &#39;v318&#39;, &#39;v319&#39;, &#39;v320&#39;, &#39;v321&#39;, &#39;v322&#39;, &#39;v323&#39;, &#39;v324&#39;, &#39;v325&#39;, &#39;v326&#39;, &#39;v327&#39;, &#39;v328&#39;, &#39;v329&#39;, &#39;v330&#39;, &#39;v331&#39;, &#39;v332&#39;, &#39;v333&#39;, &#39;v334&#39;, &#39;v335&#39;, &#39;v336&#39;, &#39;v337&#39;, &#39;v338&#39;, &#39;v339&#39;]
[&#39;transactionid&#39;, &#39;id_01&#39;, &#39;id_02&#39;, &#39;id_03&#39;, &#39;id_04&#39;, &#39;id_05&#39;, &#39;id_06&#39;, &#39;id_07&#39;, &#39;id_08&#39;, &#39;id_09&#39;, &#39;id_10&#39;, &#39;id_11&#39;, &#39;id_12&#39;, &#39;id_13&#39;, &#39;id_14&#39;, &#39;id_15&#39;, &#39;id_16&#39;, &#39;id_17&#39;, &#39;id_18&#39;, &#39;id_19&#39;, &#39;id_20&#39;, &#39;id_21&#39;, &#39;id_22&#39;, &#39;id_23&#39;, &#39;id_24&#39;, &#39;id_25&#39;, &#39;id_26&#39;, &#39;id_27&#39;, &#39;id_28&#39;, &#39;id_29&#39;, &#39;id_30&#39;, &#39;id_31&#39;, &#39;id_32&#39;, &#39;id_33&#39;, &#39;id_34&#39;, &#39;id_35&#39;, &#39;id_36&#39;, &#39;id_37&#39;, &#39;id_38&#39;, &#39;devicetype&#39;, &#39;deviceinfo&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Realizar el merge tipo LEFT JOIN</span>
<span class="n">df_full</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">df1</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;transactionid&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Verificar dimensiones del nuevo DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensiones del dataframe combinado:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_full</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Ver primeras filas</span>
<span class="c1">#df_full.head()</span>
<span class="n">df_full</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dimensiones del dataframe combinado:
(144233, 434)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>transactionid</th>
      <th>id_01</th>
      <th>id_02</th>
      <th>id_03</th>
      <th>id_04</th>
      <th>id_05</th>
      <th>id_06</th>
      <th>id_07</th>
      <th>id_08</th>
      <th>id_09</th>
      <th>...</th>
      <th>v330</th>
      <th>v331</th>
      <th>v332</th>
      <th>v333</th>
      <th>v334</th>
      <th>v335</th>
      <th>v336</th>
      <th>v337</th>
      <th>v338</th>
      <th>v339</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1.442330e+05</td>
      <td>144233.000000</td>
      <td>140872.000000</td>
      <td>66324.000000</td>
      <td>66324.000000</td>
      <td>136865.000000</td>
      <td>136865.000000</td>
      <td>5155.000000</td>
      <td>5155.000000</td>
      <td>74926.000000</td>
      <td>...</td>
      <td>82041.000000</td>
      <td>82041.000000</td>
      <td>82041.000000</td>
      <td>82041.000000</td>
      <td>82041.000000</td>
      <td>82041.000000</td>
      <td>82041.000000</td>
      <td>82041.000000</td>
      <td>82041.000000</td>
      <td>82041.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.236329e+06</td>
      <td>-10.170502</td>
      <td>174716.584708</td>
      <td>0.060189</td>
      <td>-0.058938</td>
      <td>1.615585</td>
      <td>-6.698710</td>
      <td>13.285354</td>
      <td>-38.600388</td>
      <td>0.091023</td>
      <td>...</td>
      <td>0.777733</td>
      <td>723.339755</td>
      <td>1379.108414</td>
      <td>1017.190218</td>
      <td>9.837929</td>
      <td>59.213495</td>
      <td>28.592672</td>
      <td>55.461163</td>
      <td>151.546395</td>
      <td>100.950114</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.788496e+05</td>
      <td>14.347949</td>
      <td>159651.816856</td>
      <td>0.598231</td>
      <td>0.701015</td>
      <td>5.249856</td>
      <td>16.491104</td>
      <td>11.384207</td>
      <td>26.084899</td>
      <td>0.983842</td>
      <td>...</td>
      <td>4.735065</td>
      <td>6222.466950</td>
      <td>11181.344838</td>
      <td>7964.623789</td>
      <td>244.320100</td>
      <td>388.035252</td>
      <td>275.048519</td>
      <td>669.707372</td>
      <td>1096.739466</td>
      <td>816.354359</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2.987004e+06</td>
      <td>-100.000000</td>
      <td>1.000000</td>
      <td>-13.000000</td>
      <td>-28.000000</td>
      <td>-72.000000</td>
      <td>-100.000000</td>
      <td>-46.000000</td>
      <td>-100.000000</td>
      <td>-36.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>3.077142e+06</td>
      <td>-10.000000</td>
      <td>67992.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-6.000000</td>
      <td>5.000000</td>
      <td>-48.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.198818e+06</td>
      <td>-5.000000</td>
      <td>125800.500000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.000000</td>
      <td>-34.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.392923e+06</td>
      <td>-5.000000</td>
      <td>228749.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>22.000000</td>
      <td>-23.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>25.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.577534e+06</td>
      <td>0.000000</td>
      <td>999595.000000</td>
      <td>10.000000</td>
      <td>0.000000</td>
      <td>52.000000</td>
      <td>0.000000</td>
      <td>61.000000</td>
      <td>0.000000</td>
      <td>25.000000</td>
      <td>...</td>
      <td>55.000000</td>
      <td>160000.000000</td>
      <td>160000.000000</td>
      <td>160000.000000</td>
      <td>55125.000000</td>
      <td>55125.000000</td>
      <td>55125.000000</td>
      <td>104060.000000</td>
      <td>104060.000000</td>
      <td>104060.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 403 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_full</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_12</th>
      <th>id_15</th>
      <th>id_16</th>
      <th>id_23</th>
      <th>id_27</th>
      <th>id_28</th>
      <th>id_29</th>
      <th>id_30</th>
      <th>id_31</th>
      <th>id_33</th>
      <th>...</th>
      <th>r_emaildomain</th>
      <th>m1</th>
      <th>m2</th>
      <th>m3</th>
      <th>m4</th>
      <th>m5</th>
      <th>m6</th>
      <th>m7</th>
      <th>m8</th>
      <th>m9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>144233</td>
      <td>140985</td>
      <td>129340</td>
      <td>5169</td>
      <td>5169</td>
      <td>140978</td>
      <td>140978</td>
      <td>77565</td>
      <td>140282</td>
      <td>73289</td>
      <td>...</td>
      <td>131083</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>60831</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>75</td>
      <td>130</td>
      <td>260</td>
      <td>...</td>
      <td>60</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>top</th>
      <td>NotFound</td>
      <td>Found</td>
      <td>Found</td>
      <td>IP_PROXY:TRANSPARENT</td>
      <td>Found</td>
      <td>Found</td>
      <td>Found</td>
      <td>Windows 10</td>
      <td>chrome 63.0</td>
      <td>1920x1080</td>
      <td>...</td>
      <td>gmail.com</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>M2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>123025</td>
      <td>67728</td>
      <td>66324</td>
      <td>3489</td>
      <td>5155</td>
      <td>76232</td>
      <td>74926</td>
      <td>21155</td>
      <td>22000</td>
      <td>16874</td>
      <td>...</td>
      <td>55079</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>50300</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 31 columns</p>
</div></div></div>
</div>
<p>Ya combinados los dataframes, se procede a verificar de manera completa la cantidad de valores nulos por columnas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular número y porcentaje de nulos por columna</span>
<span class="n">nulos_abs</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">nulos_pct</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Crear DataFrame combinado</span>
<span class="n">missing_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;missing_count&#39;</span><span class="p">:</span> <span class="n">nulos_abs</span><span class="p">,</span>
    <span class="s1">&#39;missing_percentage&#39;</span><span class="p">:</span> <span class="n">nulos_pct</span>
<span class="p">})</span>

<span class="c1"># Filtrar solo columnas con al menos 1 valor nulo</span>
<span class="n">missing_df</span> <span class="o">=</span> <span class="n">missing_df</span><span class="p">[</span><span class="n">missing_df</span><span class="p">[</span><span class="s1">&#39;missing_count&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Ordenar de mayor a menor porcentaje</span>
<span class="n">missing_df</span> <span class="o">=</span> <span class="n">missing_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;missing_percentage&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">missing_df</span>

<span class="c1"># Ver tabla</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">missing_df</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columnas con al menos un valor nulo: </span><span class="si">{</span><span class="n">missing_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>missing_count</th>
      <th>missing_percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>v11</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>m9</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>d11</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>v8</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>v7</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>v6</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>v5</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>v4</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>v9</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>v2</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>v1</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>v3</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>m8</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>m7</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>m1</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>m2</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>m3</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>v10</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>dist1</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>m5</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>m6</th>
      <td>144233</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>id_24</th>
      <td>139486</td>
      <td>96.71</td>
    </tr>
    <tr>
      <th>id_25</th>
      <td>139101</td>
      <td>96.44</td>
    </tr>
    <tr>
      <th>id_08</th>
      <td>139078</td>
      <td>96.43</td>
    </tr>
    <tr>
      <th>id_07</th>
      <td>139078</td>
      <td>96.43</td>
    </tr>
    <tr>
      <th>id_21</th>
      <td>139074</td>
      <td>96.42</td>
    </tr>
    <tr>
      <th>id_26</th>
      <td>139070</td>
      <td>96.42</td>
    </tr>
    <tr>
      <th>id_22</th>
      <td>139064</td>
      <td>96.42</td>
    </tr>
    <tr>
      <th>id_23</th>
      <td>139064</td>
      <td>96.42</td>
    </tr>
    <tr>
      <th>id_27</th>
      <td>139064</td>
      <td>96.42</td>
    </tr>
    <tr>
      <th>d3</th>
      <td>115174</td>
      <td>79.85</td>
    </tr>
    <tr>
      <th>d2</th>
      <td>113117</td>
      <td>78.43</td>
    </tr>
    <tr>
      <th>d5</th>
      <td>111158</td>
      <td>77.07</td>
    </tr>
    <tr>
      <th>d7</th>
      <td>108093</td>
      <td>74.94</td>
    </tr>
    <tr>
      <th>dist2</th>
      <td>106640</td>
      <td>73.94</td>
    </tr>
    <tr>
      <th>id_18</th>
      <td>99120</td>
      <td>68.72</td>
    </tr>
    <tr>
      <th>d12</th>
      <td>85324</td>
      <td>59.16</td>
    </tr>
    <tr>
      <th>m4</th>
      <td>83402</td>
      <td>57.82</td>
    </tr>
    <tr>
      <th>d13</th>
      <td>82297</td>
      <td>57.06</td>
    </tr>
    <tr>
      <th>d14</th>
      <td>82068</td>
      <td>56.90</td>
    </tr>
    <tr>
      <th>v37</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v38</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v39</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v40</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v52</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v51</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v42</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v43</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v44</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v45</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v46</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v47</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v48</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v49</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v50</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v41</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v36</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>v35</th>
      <td>79488</td>
      <td>55.11</td>
    </tr>
    <tr>
      <th>d4</th>
      <td>79465</td>
      <td>55.09</td>
    </tr>
    <tr>
      <th>id_03</th>
      <td>77909</td>
      <td>54.02</td>
    </tr>
    <tr>
      <th>id_04</th>
      <td>77909</td>
      <td>54.02</td>
    </tr>
    <tr>
      <th>d6</th>
      <td>76860</td>
      <td>53.29</td>
    </tr>
    <tr>
      <th>v68</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v53</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v54</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v56</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v74</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v73</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v72</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v71</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v70</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v69</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v57</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v67</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v65</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v64</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v63</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v62</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v61</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v60</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v58</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v59</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v55</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v66</th>
      <td>76527</td>
      <td>53.06</td>
    </tr>
    <tr>
      <th>v91</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v89</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v90</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v94</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v92</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v93</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v87</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v88</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v82</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v86</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v85</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v84</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v83</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v81</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v80</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v79</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v78</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v77</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v76</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>v75</th>
      <td>75967</td>
      <td>52.67</td>
    </tr>
    <tr>
      <th>d15</th>
      <td>75916</td>
      <td>52.63</td>
    </tr>
    <tr>
      <th>v32</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v21</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v33</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v13</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v14</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v15</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v16</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v17</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v18</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v19</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v20</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v12</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v22</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v28</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v34</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v23</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v30</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v29</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v31</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v27</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v26</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v25</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>v24</th>
      <td>75052</td>
      <td>52.04</td>
    </tr>
    <tr>
      <th>d10</th>
      <td>75001</td>
      <td>52.00</td>
    </tr>
    <tr>
      <th>id_33</th>
      <td>70944</td>
      <td>49.19</td>
    </tr>
    <tr>
      <th>d9</th>
      <td>69307</td>
      <td>48.05</td>
    </tr>
    <tr>
      <th>d8</th>
      <td>69307</td>
      <td>48.05</td>
    </tr>
    <tr>
      <th>id_10</th>
      <td>69307</td>
      <td>48.05</td>
    </tr>
    <tr>
      <th>id_09</th>
      <td>69307</td>
      <td>48.05</td>
    </tr>
    <tr>
      <th>id_30</th>
      <td>66668</td>
      <td>46.22</td>
    </tr>
    <tr>
      <th>id_32</th>
      <td>66647</td>
      <td>46.21</td>
    </tr>
    <tr>
      <th>id_34</th>
      <td>66428</td>
      <td>46.06</td>
    </tr>
    <tr>
      <th>id_14</th>
      <td>64189</td>
      <td>44.50</td>
    </tr>
    <tr>
      <th>v163</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v155</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v156</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v157</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v158</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v154</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v138</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v146</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v153</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v149</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v148</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v147</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v162</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v142</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v141</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v140</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v139</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v161</th>
      <td>62596</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v164</th>
      <td>62590</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v165</th>
      <td>62590</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v166</th>
      <td>62590</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v150</th>
      <td>62590</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v160</th>
      <td>62590</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v159</th>
      <td>62590</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v152</th>
      <td>62590</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v151</th>
      <td>62590</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v145</th>
      <td>62590</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v143</th>
      <td>62590</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v144</th>
      <td>62590</td>
      <td>43.40</td>
    </tr>
    <tr>
      <th>v322</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v339</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v323</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v335</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v324</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v325</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v326</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v327</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v328</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v329</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v330</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v332</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v333</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v334</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v331</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v336</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v337</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>v338</th>
      <td>62192</td>
      <td>43.12</td>
    </tr>
    <tr>
      <th>addr1</th>
      <td>60447</td>
      <td>41.91</td>
    </tr>
    <tr>
      <th>addr2</th>
      <td>60447</td>
      <td>41.91</td>
    </tr>
    <tr>
      <th>deviceinfo</th>
      <td>25567</td>
      <td>17.73</td>
    </tr>
    <tr>
      <th>id_13</th>
      <td>16913</td>
      <td>11.73</td>
    </tr>
    <tr>
      <th>id_16</th>
      <td>14893</td>
      <td>10.33</td>
    </tr>
    <tr>
      <th>v223</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v231</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v225</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v230</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v229</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v228</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v219</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v226</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v278</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v218</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v217</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v233</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v232</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v224</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v235</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v264</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v236</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v260</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v261</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v262</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v276</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v263</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v265</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v257</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v266</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v267</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v268</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v269</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v275</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v274</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v277</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v258</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v254</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v253</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v237</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v240</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v241</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v242</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v243</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v244</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v273</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v246</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v247</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v248</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v249</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>v252</th>
      <td>13964</td>
      <td>9.68</td>
    </tr>
    <tr>
      <th>p_emaildomain</th>
      <td>13391</td>
      <td>9.28</td>
    </tr>
    <tr>
      <th>r_emaildomain</th>
      <td>13150</td>
      <td>9.12</td>
    </tr>
    <tr>
      <th>id_06</th>
      <td>7368</td>
      <td>5.11</td>
    </tr>
    <tr>
      <th>id_05</th>
      <td>7368</td>
      <td>5.11</td>
    </tr>
    <tr>
      <th>id_20</th>
      <td>4972</td>
      <td>3.45</td>
    </tr>
    <tr>
      <th>id_19</th>
      <td>4915</td>
      <td>3.41</td>
    </tr>
    <tr>
      <th>id_17</th>
      <td>4864</td>
      <td>3.37</td>
    </tr>
    <tr>
      <th>v177</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v187</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v204</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v203</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v202</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v207</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v199</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v172</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v196</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v211</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v193</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v192</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v191</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v190</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v212</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v206</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v213</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v186</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v179</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v173</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v167</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v168</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v176</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v214</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v178</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v216</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v181</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v182</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v183</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v215</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v205</th>
      <td>4602</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>v210</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v209</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v169</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v208</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v171</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v201</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v200</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v198</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v195</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v194</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v189</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v188</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v185</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v184</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v180</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v170</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v175</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v174</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>v197</th>
      <td>4414</td>
      <td>3.06</td>
    </tr>
    <tr>
      <th>id_31</th>
      <td>3951</td>
      <td>2.74</td>
    </tr>
    <tr>
      <th>devicetype</th>
      <td>3423</td>
      <td>2.37</td>
    </tr>
    <tr>
      <th>id_02</th>
      <td>3361</td>
      <td>2.33</td>
    </tr>
    <tr>
      <th>id_11</th>
      <td>3255</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>id_28</th>
      <td>3255</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>id_29</th>
      <td>3255</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>id_36</th>
      <td>3248</td>
      <td>2.25</td>
    </tr>
    <tr>
      <th>id_38</th>
      <td>3248</td>
      <td>2.25</td>
    </tr>
    <tr>
      <th>id_15</th>
      <td>3248</td>
      <td>2.25</td>
    </tr>
    <tr>
      <th>id_35</th>
      <td>3248</td>
      <td>2.25</td>
    </tr>
    <tr>
      <th>id_37</th>
      <td>3248</td>
      <td>2.25</td>
    </tr>
    <tr>
      <th>v250</th>
      <td>3127</td>
      <td>2.17</td>
    </tr>
    <tr>
      <th>v251</th>
      <td>3127</td>
      <td>2.17</td>
    </tr>
    <tr>
      <th>v221</th>
      <td>3127</td>
      <td>2.17</td>
    </tr>
    <tr>
      <th>v255</th>
      <td>3127</td>
      <td>2.17</td>
    </tr>
    <tr>
      <th>v222</th>
      <td>3127</td>
      <td>2.17</td>
    </tr>
    <tr>
      <th>v256</th>
      <td>3127</td>
      <td>2.17</td>
    </tr>
    <tr>
      <th>v270</th>
      <td>3127</td>
      <td>2.17</td>
    </tr>
    <tr>
      <th>v272</th>
      <td>3127</td>
      <td>2.17</td>
    </tr>
    <tr>
      <th>v259</th>
      <td>3127</td>
      <td>2.17</td>
    </tr>
    <tr>
      <th>v245</th>
      <td>3127</td>
      <td>2.17</td>
    </tr>
    <tr>
      <th>v271</th>
      <td>3127</td>
      <td>2.17</td>
    </tr>
    <tr>
      <th>v220</th>
      <td>3127</td>
      <td>2.17</td>
    </tr>
    <tr>
      <th>v227</th>
      <td>3127</td>
      <td>2.17</td>
    </tr>
    <tr>
      <th>v234</th>
      <td>3127</td>
      <td>2.17</td>
    </tr>
    <tr>
      <th>v239</th>
      <td>3127</td>
      <td>2.17</td>
    </tr>
    <tr>
      <th>v238</th>
      <td>3127</td>
      <td>2.17</td>
    </tr>
    <tr>
      <th>card5</th>
      <td>956</td>
      <td>0.66</td>
    </tr>
    <tr>
      <th>card2</th>
      <td>902</td>
      <td>0.63</td>
    </tr>
    <tr>
      <th>v314</th>
      <td>218</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>v283</th>
      <td>218</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>v281</th>
      <td>218</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>v288</th>
      <td>218</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>v313</th>
      <td>218</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>v289</th>
      <td>218</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>v296</th>
      <td>218</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>v300</th>
      <td>218</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>v301</th>
      <td>218</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>d1</th>
      <td>218</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>v315</th>
      <td>218</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>v282</th>
      <td>218</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>card4</th>
      <td>184</td>
      <td>0.13</td>
    </tr>
    <tr>
      <th>card6</th>
      <td>178</td>
      <td>0.12</td>
    </tr>
    <tr>
      <th>card3</th>
      <td>172</td>
      <td>0.12</td>
    </tr>
    <tr>
      <th>v111</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v120</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v121</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v110</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v123</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v124</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v125</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v97</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v96</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v95</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v126</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v127</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v118</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v128</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v129</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v130</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v131</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v132</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v133</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v135</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v136</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v137</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v119</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v122</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v116</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v117</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v98</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v99</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v100</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v101</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v102</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v103</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v114</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v113</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v112</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v104</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v105</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v106</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v107</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v108</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v109</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v115</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v134</th>
      <td>64</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>v308</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v309</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v291</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v292</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v293</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v294</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v295</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v286</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v297</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v298</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v299</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v285</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v284</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v302</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v303</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v304</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v305</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v279</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v280</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v321</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v320</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v319</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v318</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v317</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v316</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v306</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v290</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v307</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v312</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v311</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v310</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>v287</th>
      <td>2</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Columnas con al menos un valor nulo: 412
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular número y porcentaje de nulos por columna</span>
<span class="n">nulos_abs</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">nulos_pct</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Crear DataFrame combinado</span>
<span class="n">missing_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;missing_count&#39;</span><span class="p">:</span> <span class="n">nulos_abs</span><span class="p">,</span>
    <span class="s1">&#39;missing_percentage&#39;</span><span class="p">:</span> <span class="n">nulos_pct</span>
<span class="p">})</span>

<span class="c1"># Filtrar solo columnas con al menos 1 valor nulo</span>
<span class="n">missing_df</span> <span class="o">=</span> <span class="n">missing_df</span><span class="p">[</span><span class="n">missing_df</span><span class="p">[</span><span class="s1">&#39;missing_count&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Ordenar de mayor a menor porcentaje</span>
<span class="n">missing_df</span> <span class="o">=</span> <span class="n">missing_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;missing_percentage&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">missing_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columnas con al menos un valor nulo: </span><span class="si">{</span><span class="n">missing_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               missing_count  missing_percentage
v11                   144233          100.000000
m9                    144233          100.000000
d11                   144233          100.000000
v8                    144233          100.000000
v7                    144233          100.000000
v6                    144233          100.000000
v5                    144233          100.000000
v4                    144233          100.000000
v9                    144233          100.000000
v2                    144233          100.000000
v1                    144233          100.000000
v3                    144233          100.000000
m8                    144233          100.000000
m7                    144233          100.000000
m1                    144233          100.000000
m2                    144233          100.000000
m3                    144233          100.000000
v10                   144233          100.000000
dist1                 144233          100.000000
m5                    144233          100.000000
m6                    144233          100.000000
id_24                 139486           96.708798
id_25                 139101           96.441868
id_08                 139078           96.425922
id_07                 139078           96.425922
id_21                 139074           96.423149
id_26                 139070           96.420375
id_22                 139064           96.416215
id_23                 139064           96.416215
id_27                 139064           96.416215
d3                    115174           79.852738
d2                    113117           78.426574
d5                    111158           77.068355
d7                    108093           74.943321
dist2                 106640           73.935923
id_18                  99120           68.722137
d12                    85324           59.157058
m4                     83402           57.824492
d13                    82297           57.058371
d14                    82068           56.899600
v37                    79488           55.110828
v38                    79488           55.110828
v39                    79488           55.110828
v40                    79488           55.110828
v52                    79488           55.110828
v51                    79488           55.110828
v42                    79488           55.110828
v43                    79488           55.110828
v44                    79488           55.110828
v45                    79488           55.110828
v46                    79488           55.110828
v47                    79488           55.110828
v48                    79488           55.110828
v49                    79488           55.110828
v50                    79488           55.110828
v41                    79488           55.110828
v36                    79488           55.110828
v35                    79488           55.110828
d4                     79465           55.094881
id_03                  77909           54.016071
id_04                  77909           54.016071
d6                     76860           53.288776
v68                    76527           53.057899
v53                    76527           53.057899
v54                    76527           53.057899
v56                    76527           53.057899
v74                    76527           53.057899
v73                    76527           53.057899
v72                    76527           53.057899
v71                    76527           53.057899
v70                    76527           53.057899
v69                    76527           53.057899
v57                    76527           53.057899
v67                    76527           53.057899
v65                    76527           53.057899
v64                    76527           53.057899
v63                    76527           53.057899
v62                    76527           53.057899
v61                    76527           53.057899
v60                    76527           53.057899
v58                    76527           53.057899
v59                    76527           53.057899
v55                    76527           53.057899
v66                    76527           53.057899
v91                    75967           52.669639
v89                    75967           52.669639
v90                    75967           52.669639
v94                    75967           52.669639
v92                    75967           52.669639
v93                    75967           52.669639
v87                    75967           52.669639
v88                    75967           52.669639
v82                    75967           52.669639
v86                    75967           52.669639
v85                    75967           52.669639
v84                    75967           52.669639
v83                    75967           52.669639
v81                    75967           52.669639
v80                    75967           52.669639
v79                    75967           52.669639
v78                    75967           52.669639
v77                    75967           52.669639
v76                    75967           52.669639
v75                    75967           52.669639
d15                    75916           52.634279
v32                    75052           52.035249
v21                    75052           52.035249
v33                    75052           52.035249
v13                    75052           52.035249
v14                    75052           52.035249
v15                    75052           52.035249
v16                    75052           52.035249
v17                    75052           52.035249
v18                    75052           52.035249
v19                    75052           52.035249
v20                    75052           52.035249
v12                    75052           52.035249
v22                    75052           52.035249
v28                    75052           52.035249
v34                    75052           52.035249
v23                    75052           52.035249
v30                    75052           52.035249
v29                    75052           52.035249
v31                    75052           52.035249
v27                    75052           52.035249
v26                    75052           52.035249
v25                    75052           52.035249
v24                    75052           52.035249
d10                    75001           51.999889
id_33                  70944           49.187079
d9                     69307           48.052110
d8                     69307           48.052110
id_10                  69307           48.052110
id_09                  69307           48.052110
id_30                  66668           46.222432
id_32                  66647           46.207872
id_34                  66428           46.056034
id_14                  64189           44.503685
v163                   62596           43.399222
v155                   62596           43.399222
v156                   62596           43.399222
v157                   62596           43.399222
v158                   62596           43.399222
v154                   62596           43.399222
v138                   62596           43.399222
v146                   62596           43.399222
v153                   62596           43.399222
v149                   62596           43.399222
v148                   62596           43.399222
v147                   62596           43.399222
v162                   62596           43.399222
v142                   62596           43.399222
v141                   62596           43.399222
v140                   62596           43.399222
v139                   62596           43.399222
v161                   62596           43.399222
v164                   62590           43.395062
v165                   62590           43.395062
v166                   62590           43.395062
v150                   62590           43.395062
v160                   62590           43.395062
v159                   62590           43.395062
v152                   62590           43.395062
v151                   62590           43.395062
v145                   62590           43.395062
v143                   62590           43.395062
v144                   62590           43.395062
v322                   62192           43.119120
v339                   62192           43.119120
v323                   62192           43.119120
v335                   62192           43.119120
v324                   62192           43.119120
v325                   62192           43.119120
v326                   62192           43.119120
v327                   62192           43.119120
v328                   62192           43.119120
v329                   62192           43.119120
v330                   62192           43.119120
v332                   62192           43.119120
v333                   62192           43.119120
v334                   62192           43.119120
v331                   62192           43.119120
v336                   62192           43.119120
v337                   62192           43.119120
v338                   62192           43.119120
addr1                  60447           41.909272
addr2                  60447           41.909272
deviceinfo             25567           17.726179
id_13                  16913           11.726165
id_16                  14893           10.325654
v223                   13964            9.681557
v231                   13964            9.681557
v225                   13964            9.681557
v230                   13964            9.681557
v229                   13964            9.681557
v228                   13964            9.681557
v219                   13964            9.681557
v226                   13964            9.681557
v278                   13964            9.681557
v218                   13964            9.681557
v217                   13964            9.681557
v233                   13964            9.681557
v232                   13964            9.681557
v224                   13964            9.681557
v235                   13964            9.681557
v264                   13964            9.681557
v236                   13964            9.681557
v260                   13964            9.681557
v261                   13964            9.681557
v262                   13964            9.681557
v276                   13964            9.681557
v263                   13964            9.681557
v265                   13964            9.681557
v257                   13964            9.681557
v266                   13964            9.681557
v267                   13964            9.681557
v268                   13964            9.681557
v269                   13964            9.681557
v275                   13964            9.681557
v274                   13964            9.681557
v277                   13964            9.681557
v258                   13964            9.681557
v254                   13964            9.681557
v253                   13964            9.681557
v237                   13964            9.681557
v240                   13964            9.681557
v241                   13964            9.681557
v242                   13964            9.681557
v243                   13964            9.681557
v244                   13964            9.681557
v273                   13964            9.681557
v246                   13964            9.681557
v247                   13964            9.681557
v248                   13964            9.681557
v249                   13964            9.681557
v252                   13964            9.681557
p_emaildomain          13391            9.284283
r_emaildomain          13150            9.117192
id_06                   7368            5.108401
id_05                   7368            5.108401
id_20                   4972            3.447200
id_19                   4915            3.407681
id_17                   4864            3.372321
v177                    4602            3.190671
v187                    4602            3.190671
v204                    4602            3.190671
v203                    4602            3.190671
v202                    4602            3.190671
v207                    4602            3.190671
v199                    4602            3.190671
v172                    4602            3.190671
v196                    4602            3.190671
v211                    4602            3.190671
v193                    4602            3.190671
v192                    4602            3.190671
v191                    4602            3.190671
v190                    4602            3.190671
v212                    4602            3.190671
v206                    4602            3.190671
v213                    4602            3.190671
v186                    4602            3.190671
v179                    4602            3.190671
v173                    4602            3.190671
v167                    4602            3.190671
v168                    4602            3.190671
v176                    4602            3.190671
v214                    4602            3.190671
v178                    4602            3.190671
v216                    4602            3.190671
v181                    4602            3.190671
v182                    4602            3.190671
v183                    4602            3.190671
v215                    4602            3.190671
v205                    4602            3.190671
v210                    4414            3.060326
v209                    4414            3.060326
v169                    4414            3.060326
v208                    4414            3.060326
v171                    4414            3.060326
v201                    4414            3.060326
v200                    4414            3.060326
v198                    4414            3.060326
v195                    4414            3.060326
v194                    4414            3.060326
v189                    4414            3.060326
v188                    4414            3.060326
v185                    4414            3.060326
v184                    4414            3.060326
v180                    4414            3.060326
v170                    4414            3.060326
v175                    4414            3.060326
v174                    4414            3.060326
v197                    4414            3.060326
id_31                   3951            2.739318
devicetype              3423            2.373243
id_02                   3361            2.330257
id_11                   3255            2.256765
id_28                   3255            2.256765
id_29                   3255            2.256765
id_36                   3248            2.251912
id_38                   3248            2.251912
id_15                   3248            2.251912
id_35                   3248            2.251912
id_37                   3248            2.251912
v250                    3127            2.168020
v251                    3127            2.168020
v221                    3127            2.168020
v255                    3127            2.168020
v222                    3127            2.168020
v256                    3127            2.168020
v270                    3127            2.168020
v272                    3127            2.168020
v259                    3127            2.168020
v245                    3127            2.168020
v271                    3127            2.168020
v220                    3127            2.168020
v227                    3127            2.168020
v234                    3127            2.168020
v239                    3127            2.168020
v238                    3127            2.168020
card5                    956            0.662816
card2                    902            0.625377
v314                     218            0.151144
v283                     218            0.151144
v281                     218            0.151144
v288                     218            0.151144
v313                     218            0.151144
v289                     218            0.151144
v296                     218            0.151144
v300                     218            0.151144
v301                     218            0.151144
d1                       218            0.151144
v315                     218            0.151144
v282                     218            0.151144
card4                    184            0.127571
card6                    178            0.123411
card3                    172            0.119251
v111                      64            0.044373
v120                      64            0.044373
v121                      64            0.044373
v110                      64            0.044373
v123                      64            0.044373
v124                      64            0.044373
v125                      64            0.044373
v97                       64            0.044373
v96                       64            0.044373
v95                       64            0.044373
v126                      64            0.044373
v127                      64            0.044373
v118                      64            0.044373
v128                      64            0.044373
v129                      64            0.044373
v130                      64            0.044373
v131                      64            0.044373
v132                      64            0.044373
v133                      64            0.044373
v135                      64            0.044373
v136                      64            0.044373
v137                      64            0.044373
v119                      64            0.044373
v122                      64            0.044373
v116                      64            0.044373
v117                      64            0.044373
v98                       64            0.044373
v99                       64            0.044373
v100                      64            0.044373
v101                      64            0.044373
v102                      64            0.044373
v103                      64            0.044373
v114                      64            0.044373
v113                      64            0.044373
v112                      64            0.044373
v104                      64            0.044373
v105                      64            0.044373
v106                      64            0.044373
v107                      64            0.044373
v108                      64            0.044373
v109                      64            0.044373
v115                      64            0.044373
v134                      64            0.044373
v308                       2            0.001387
v309                       2            0.001387
v291                       2            0.001387
v292                       2            0.001387
v293                       2            0.001387
v294                       2            0.001387
v295                       2            0.001387
v286                       2            0.001387
v297                       2            0.001387
v298                       2            0.001387
v299                       2            0.001387
v285                       2            0.001387
v284                       2            0.001387
v302                       2            0.001387
v303                       2            0.001387
v304                       2            0.001387
v305                       2            0.001387
v279                       2            0.001387
v280                       2            0.001387
v321                       2            0.001387
v320                       2            0.001387
v319                       2            0.001387
v318                       2            0.001387
v317                       2            0.001387
v316                       2            0.001387
v306                       2            0.001387
v290                       2            0.001387
v307                       2            0.001387
v312                       2            0.001387
v311                       2            0.001387
v310                       2            0.001387
v287                       2            0.001387
Columnas con al menos un valor nulo: 412
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtrar las columnas con 100% de nulos</span>
<span class="n">cols_100_null</span> <span class="o">=</span> <span class="n">missing_df</span><span class="p">[</span><span class="n">missing_df</span><span class="p">[</span><span class="s1">&#39;missing_percentage&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># Ver cuántas son</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columnas con 100% de nulos a eliminar: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cols_100_null</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Eliminar del DataFrame principal</span>
<span class="n">df_full</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">cols_100_null</span><span class="p">)</span>

<span class="c1"># Ver nueva forma del DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nueva dimensión de df_full:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_full</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Columnas con 100% de nulos a eliminar: 21
Nueva dimensión de df_full:
(144233, 413)
</pre></div>
</div>
</div>
</div>
<p>Se eliminaron un total de 21 columnas del conjunto de datos combinado df_full debido a que presentaban el 100% de sus valores como faltantes (NaN).
Estas columnas no contienen ninguna información observable que pueda ser utilizada para análisis exploratorio, imputación, o modelado, y por tanto, no aportan valor al proceso de detección de fraude. Además, no es posible aplicar técnicas de imputación, codificación ni análisis de correlación sobre variables completamente vacías.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df_full</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Número total de columnas: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_full</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;transactionid&#39;, &#39;id_01&#39;, &#39;id_02&#39;, &#39;id_03&#39;, &#39;id_04&#39;, &#39;id_05&#39;, &#39;id_06&#39;, &#39;id_07&#39;, &#39;id_08&#39;, &#39;id_09&#39;, &#39;id_10&#39;, &#39;id_11&#39;, &#39;id_12&#39;, &#39;id_13&#39;, &#39;id_14&#39;, &#39;id_15&#39;, &#39;id_16&#39;, &#39;id_17&#39;, &#39;id_18&#39;, &#39;id_19&#39;, &#39;id_20&#39;, &#39;id_21&#39;, &#39;id_22&#39;, &#39;id_23&#39;, &#39;id_24&#39;, &#39;id_25&#39;, &#39;id_26&#39;, &#39;id_27&#39;, &#39;id_28&#39;, &#39;id_29&#39;, &#39;id_30&#39;, &#39;id_31&#39;, &#39;id_32&#39;, &#39;id_33&#39;, &#39;id_34&#39;, &#39;id_35&#39;, &#39;id_36&#39;, &#39;id_37&#39;, &#39;id_38&#39;, &#39;devicetype&#39;, &#39;deviceinfo&#39;, &#39;isfraud&#39;, &#39;transactiondt&#39;, &#39;transactionamt&#39;, &#39;productcd&#39;, &#39;card1&#39;, &#39;card2&#39;, &#39;card3&#39;, &#39;card4&#39;, &#39;card5&#39;, &#39;card6&#39;, &#39;addr1&#39;, &#39;addr2&#39;, &#39;dist2&#39;, &#39;p_emaildomain&#39;, &#39;r_emaildomain&#39;, &#39;c1&#39;, &#39;c2&#39;, &#39;c3&#39;, &#39;c4&#39;, &#39;c5&#39;, &#39;c6&#39;, &#39;c7&#39;, &#39;c8&#39;, &#39;c9&#39;, &#39;c10&#39;, &#39;c11&#39;, &#39;c12&#39;, &#39;c13&#39;, &#39;c14&#39;, &#39;d1&#39;, &#39;d2&#39;, &#39;d3&#39;, &#39;d4&#39;, &#39;d5&#39;, &#39;d6&#39;, &#39;d7&#39;, &#39;d8&#39;, &#39;d9&#39;, &#39;d10&#39;, &#39;d12&#39;, &#39;d13&#39;, &#39;d14&#39;, &#39;d15&#39;, &#39;m4&#39;, &#39;v12&#39;, &#39;v13&#39;, &#39;v14&#39;, &#39;v15&#39;, &#39;v16&#39;, &#39;v17&#39;, &#39;v18&#39;, &#39;v19&#39;, &#39;v20&#39;, &#39;v21&#39;, &#39;v22&#39;, &#39;v23&#39;, &#39;v24&#39;, &#39;v25&#39;, &#39;v26&#39;, &#39;v27&#39;, &#39;v28&#39;, &#39;v29&#39;, &#39;v30&#39;, &#39;v31&#39;, &#39;v32&#39;, &#39;v33&#39;, &#39;v34&#39;, &#39;v35&#39;, &#39;v36&#39;, &#39;v37&#39;, &#39;v38&#39;, &#39;v39&#39;, &#39;v40&#39;, &#39;v41&#39;, &#39;v42&#39;, &#39;v43&#39;, &#39;v44&#39;, &#39;v45&#39;, &#39;v46&#39;, &#39;v47&#39;, &#39;v48&#39;, &#39;v49&#39;, &#39;v50&#39;, &#39;v51&#39;, &#39;v52&#39;, &#39;v53&#39;, &#39;v54&#39;, &#39;v55&#39;, &#39;v56&#39;, &#39;v57&#39;, &#39;v58&#39;, &#39;v59&#39;, &#39;v60&#39;, &#39;v61&#39;, &#39;v62&#39;, &#39;v63&#39;, &#39;v64&#39;, &#39;v65&#39;, &#39;v66&#39;, &#39;v67&#39;, &#39;v68&#39;, &#39;v69&#39;, &#39;v70&#39;, &#39;v71&#39;, &#39;v72&#39;, &#39;v73&#39;, &#39;v74&#39;, &#39;v75&#39;, &#39;v76&#39;, &#39;v77&#39;, &#39;v78&#39;, &#39;v79&#39;, &#39;v80&#39;, &#39;v81&#39;, &#39;v82&#39;, &#39;v83&#39;, &#39;v84&#39;, &#39;v85&#39;, &#39;v86&#39;, &#39;v87&#39;, &#39;v88&#39;, &#39;v89&#39;, &#39;v90&#39;, &#39;v91&#39;, &#39;v92&#39;, &#39;v93&#39;, &#39;v94&#39;, &#39;v95&#39;, &#39;v96&#39;, &#39;v97&#39;, &#39;v98&#39;, &#39;v99&#39;, &#39;v100&#39;, &#39;v101&#39;, &#39;v102&#39;, &#39;v103&#39;, &#39;v104&#39;, &#39;v105&#39;, &#39;v106&#39;, &#39;v107&#39;, &#39;v108&#39;, &#39;v109&#39;, &#39;v110&#39;, &#39;v111&#39;, &#39;v112&#39;, &#39;v113&#39;, &#39;v114&#39;, &#39;v115&#39;, &#39;v116&#39;, &#39;v117&#39;, &#39;v118&#39;, &#39;v119&#39;, &#39;v120&#39;, &#39;v121&#39;, &#39;v122&#39;, &#39;v123&#39;, &#39;v124&#39;, &#39;v125&#39;, &#39;v126&#39;, &#39;v127&#39;, &#39;v128&#39;, &#39;v129&#39;, &#39;v130&#39;, &#39;v131&#39;, &#39;v132&#39;, &#39;v133&#39;, &#39;v134&#39;, &#39;v135&#39;, &#39;v136&#39;, &#39;v137&#39;, &#39;v138&#39;, &#39;v139&#39;, &#39;v140&#39;, &#39;v141&#39;, &#39;v142&#39;, &#39;v143&#39;, &#39;v144&#39;, &#39;v145&#39;, &#39;v146&#39;, &#39;v147&#39;, &#39;v148&#39;, &#39;v149&#39;, &#39;v150&#39;, &#39;v151&#39;, &#39;v152&#39;, &#39;v153&#39;, &#39;v154&#39;, &#39;v155&#39;, &#39;v156&#39;, &#39;v157&#39;, &#39;v158&#39;, &#39;v159&#39;, &#39;v160&#39;, &#39;v161&#39;, &#39;v162&#39;, &#39;v163&#39;, &#39;v164&#39;, &#39;v165&#39;, &#39;v166&#39;, &#39;v167&#39;, &#39;v168&#39;, &#39;v169&#39;, &#39;v170&#39;, &#39;v171&#39;, &#39;v172&#39;, &#39;v173&#39;, &#39;v174&#39;, &#39;v175&#39;, &#39;v176&#39;, &#39;v177&#39;, &#39;v178&#39;, &#39;v179&#39;, &#39;v180&#39;, &#39;v181&#39;, &#39;v182&#39;, &#39;v183&#39;, &#39;v184&#39;, &#39;v185&#39;, &#39;v186&#39;, &#39;v187&#39;, &#39;v188&#39;, &#39;v189&#39;, &#39;v190&#39;, &#39;v191&#39;, &#39;v192&#39;, &#39;v193&#39;, &#39;v194&#39;, &#39;v195&#39;, &#39;v196&#39;, &#39;v197&#39;, &#39;v198&#39;, &#39;v199&#39;, &#39;v200&#39;, &#39;v201&#39;, &#39;v202&#39;, &#39;v203&#39;, &#39;v204&#39;, &#39;v205&#39;, &#39;v206&#39;, &#39;v207&#39;, &#39;v208&#39;, &#39;v209&#39;, &#39;v210&#39;, &#39;v211&#39;, &#39;v212&#39;, &#39;v213&#39;, &#39;v214&#39;, &#39;v215&#39;, &#39;v216&#39;, &#39;v217&#39;, &#39;v218&#39;, &#39;v219&#39;, &#39;v220&#39;, &#39;v221&#39;, &#39;v222&#39;, &#39;v223&#39;, &#39;v224&#39;, &#39;v225&#39;, &#39;v226&#39;, &#39;v227&#39;, &#39;v228&#39;, &#39;v229&#39;, &#39;v230&#39;, &#39;v231&#39;, &#39;v232&#39;, &#39;v233&#39;, &#39;v234&#39;, &#39;v235&#39;, &#39;v236&#39;, &#39;v237&#39;, &#39;v238&#39;, &#39;v239&#39;, &#39;v240&#39;, &#39;v241&#39;, &#39;v242&#39;, &#39;v243&#39;, &#39;v244&#39;, &#39;v245&#39;, &#39;v246&#39;, &#39;v247&#39;, &#39;v248&#39;, &#39;v249&#39;, &#39;v250&#39;, &#39;v251&#39;, &#39;v252&#39;, &#39;v253&#39;, &#39;v254&#39;, &#39;v255&#39;, &#39;v256&#39;, &#39;v257&#39;, &#39;v258&#39;, &#39;v259&#39;, &#39;v260&#39;, &#39;v261&#39;, &#39;v262&#39;, &#39;v263&#39;, &#39;v264&#39;, &#39;v265&#39;, &#39;v266&#39;, &#39;v267&#39;, &#39;v268&#39;, &#39;v269&#39;, &#39;v270&#39;, &#39;v271&#39;, &#39;v272&#39;, &#39;v273&#39;, &#39;v274&#39;, &#39;v275&#39;, &#39;v276&#39;, &#39;v277&#39;, &#39;v278&#39;, &#39;v279&#39;, &#39;v280&#39;, &#39;v281&#39;, &#39;v282&#39;, &#39;v283&#39;, &#39;v284&#39;, &#39;v285&#39;, &#39;v286&#39;, &#39;v287&#39;, &#39;v288&#39;, &#39;v289&#39;, &#39;v290&#39;, &#39;v291&#39;, &#39;v292&#39;, &#39;v293&#39;, &#39;v294&#39;, &#39;v295&#39;, &#39;v296&#39;, &#39;v297&#39;, &#39;v298&#39;, &#39;v299&#39;, &#39;v300&#39;, &#39;v301&#39;, &#39;v302&#39;, &#39;v303&#39;, &#39;v304&#39;, &#39;v305&#39;, &#39;v306&#39;, &#39;v307&#39;, &#39;v308&#39;, &#39;v309&#39;, &#39;v310&#39;, &#39;v311&#39;, &#39;v312&#39;, &#39;v313&#39;, &#39;v314&#39;, &#39;v315&#39;, &#39;v316&#39;, &#39;v317&#39;, &#39;v318&#39;, &#39;v319&#39;, &#39;v320&#39;, &#39;v321&#39;, &#39;v322&#39;, &#39;v323&#39;, &#39;v324&#39;, &#39;v325&#39;, &#39;v326&#39;, &#39;v327&#39;, &#39;v328&#39;, &#39;v329&#39;, &#39;v330&#39;, &#39;v331&#39;, &#39;v332&#39;, &#39;v333&#39;, &#39;v334&#39;, &#39;v335&#39;, &#39;v336&#39;, &#39;v337&#39;, &#39;v338&#39;, &#39;v339&#39;]
Número total de columnas: 413
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Eliminar columnas con más del 90% de valores nulos sin errores</span>
<span class="n">df_full</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_full</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.10</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dimensión del DataFrame después de eliminar columnas con &gt;90% nulos: </span><span class="si">{</span><span class="n">df_full</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dimensión del DataFrame después de eliminar columnas con &gt;90% nulos: (144233, 404)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Clasificación de columnas según el diccionario del dataset (ajustado a nombres en minúscula y sin solapamientos)</span>

<span class="c1"># Listado completo de columnas</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># Inicializar conjunto de columnas ya clasificadas</span>
<span class="n">asignadas</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

<span class="c1"># Clasificarlas por prefijo sin duplicados</span>
<span class="n">cols_base</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;transactionid&#39;</span><span class="p">,</span> <span class="s1">&#39;transactiondt&#39;</span><span class="p">,</span> <span class="s1">&#39;transactionamt&#39;</span><span class="p">,</span> <span class="s1">&#39;productcd&#39;</span><span class="p">,</span> <span class="s1">&#39;isfraud&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">asignadas</span><span class="p">]</span>
<span class="n">asignadas</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cols_base</span><span class="p">)</span>

<span class="n">cols_card</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;card&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">asignadas</span><span class="p">]</span>
<span class="n">asignadas</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cols_card</span><span class="p">)</span>

<span class="n">cols_addr</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">asignadas</span><span class="p">]</span>
<span class="n">asignadas</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cols_addr</span><span class="p">)</span>

<span class="n">cols_dist</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;dist&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">asignadas</span><span class="p">]</span>
<span class="n">asignadas</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cols_dist</span><span class="p">)</span>

<span class="n">cols_email</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="s1">&#39;emaildomain&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">asignadas</span><span class="p">]</span>
<span class="n">asignadas</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cols_email</span><span class="p">)</span>

<span class="n">cols_C</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">asignadas</span><span class="p">]</span>
<span class="n">asignadas</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cols_C</span><span class="p">)</span>

<span class="n">cols_device</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;devicetype&#39;</span><span class="p">,</span> <span class="s1">&#39;deviceinfo&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">asignadas</span><span class="p">]</span>
<span class="n">asignadas</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cols_device</span><span class="p">)</span>

<span class="n">cols_D</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">asignadas</span><span class="p">]</span>
<span class="n">asignadas</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cols_D</span><span class="p">)</span>

<span class="n">cols_M</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">asignadas</span><span class="p">]</span>
<span class="n">asignadas</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cols_M</span><span class="p">)</span>

<span class="n">cols_V</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">asignadas</span><span class="p">]</span>
<span class="n">asignadas</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cols_V</span><span class="p">)</span>

<span class="n">cols_id</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;id_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">asignadas</span><span class="p">]</span>
<span class="n">asignadas</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cols_id</span><span class="p">)</span>



<span class="c1"># Diccionario final sin duplicados</span>
<span class="n">column_groups</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="n">cols_base</span><span class="p">,</span>
    <span class="s1">&#39;card&#39;</span><span class="p">:</span> <span class="n">cols_card</span><span class="p">,</span>
    <span class="s1">&#39;addr&#39;</span><span class="p">:</span> <span class="n">cols_addr</span><span class="p">,</span>
    <span class="s1">&#39;dist&#39;</span><span class="p">:</span> <span class="n">cols_dist</span><span class="p">,</span>
    <span class="s1">&#39;emaildomain&#39;</span><span class="p">:</span> <span class="n">cols_email</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">cols_C</span><span class="p">,</span>
    <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="n">cols_D</span><span class="p">,</span>
    <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="n">cols_M</span><span class="p">,</span>
    <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="n">cols_V</span><span class="p">,</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">cols_id</span><span class="p">,</span>
    <span class="s1">&#39;device&#39;</span><span class="p">:</span> <span class="n">cols_device</span>
<span class="p">}</span>

<span class="c1"># Mostrar resumen de grupos</span>
<span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">col_list</span> <span class="ow">in</span> <span class="n">column_groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">col_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> columnas → </span><span class="si">{</span><span class="n">col_list</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="si">}{</span><span class="s1">&#39;...&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">col_list</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Mostrar total de columnas únicas agrupadas</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total de columnas agrupadas sin duplicados: </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">column_groups</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>base: 5 columnas → [&#39;transactionid&#39;, &#39;transactiondt&#39;, &#39;transactionamt&#39;, &#39;productcd&#39;, &#39;isfraud&#39;]
card: 6 columnas → [&#39;card1&#39;, &#39;card2&#39;, &#39;card3&#39;, &#39;card4&#39;, &#39;card5&#39;]...
addr: 2 columnas → [&#39;addr1&#39;, &#39;addr2&#39;]
dist: 1 columnas → [&#39;dist2&#39;]
emaildomain: 2 columnas → [&#39;p_emaildomain&#39;, &#39;r_emaildomain&#39;]
c: 14 columnas → [&#39;c1&#39;, &#39;c2&#39;, &#39;c3&#39;, &#39;c4&#39;, &#39;c5&#39;]...
d: 14 columnas → [&#39;d1&#39;, &#39;d2&#39;, &#39;d3&#39;, &#39;d4&#39;, &#39;d5&#39;]...
m: 1 columnas → [&#39;m4&#39;]
v: 328 columnas → [&#39;v12&#39;, &#39;v13&#39;, &#39;v14&#39;, &#39;v15&#39;, &#39;v16&#39;]...
id: 29 columnas → [&#39;id_01&#39;, &#39;id_02&#39;, &#39;id_03&#39;, &#39;id_04&#39;, &#39;id_05&#39;]...
device: 2 columnas → [&#39;devicetype&#39;, &#39;deviceinfo&#39;]

Total de columnas agrupadas sin duplicados: 404
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular número y porcentaje de nulos por columna</span>
<span class="n">nulos_abs</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">nulos_pct</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Crear DataFrame combinado</span>
<span class="n">missing_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;missing_count&#39;</span><span class="p">:</span> <span class="n">nulos_abs</span><span class="p">,</span>
    <span class="s1">&#39;missing_percentage&#39;</span><span class="p">:</span> <span class="n">nulos_pct</span>
<span class="p">})</span>

<span class="c1"># Filtrar solo columnas con al menos 1 valor nulo</span>
<span class="n">missing_df</span> <span class="o">=</span> <span class="n">missing_df</span><span class="p">[</span><span class="n">missing_df</span><span class="p">[</span><span class="s1">&#39;missing_count&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Ordenar de mayor a menor porcentaje</span>
<span class="n">missing_df</span> <span class="o">=</span> <span class="n">missing_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;missing_percentage&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">missing_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columnas con al menos un valor nulo: </span><span class="si">{</span><span class="n">missing_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               missing_count  missing_percentage
d3                    115174           79.852738
d2                    113117           78.426574
d5                    111158           77.068355
d7                    108093           74.943321
dist2                 106640           73.935923
id_18                  99120           68.722137
d12                    85324           59.157058
m4                     83402           57.824492
d13                    82297           57.058371
d14                    82068           56.899600
v50                    79488           55.110828
v49                    79488           55.110828
v48                    79488           55.110828
v44                    79488           55.110828
v47                    79488           55.110828
v46                    79488           55.110828
v45                    79488           55.110828
v35                    79488           55.110828
v43                    79488           55.110828
v42                    79488           55.110828
v41                    79488           55.110828
v40                    79488           55.110828
v39                    79488           55.110828
v38                    79488           55.110828
v37                    79488           55.110828
v51                    79488           55.110828
v52                    79488           55.110828
v36                    79488           55.110828
d4                     79465           55.094881
id_04                  77909           54.016071
id_03                  77909           54.016071
d6                     76860           53.288776
v66                    76527           53.057899
v73                    76527           53.057899
v72                    76527           53.057899
v71                    76527           53.057899
v70                    76527           53.057899
v69                    76527           53.057899
v68                    76527           53.057899
v67                    76527           53.057899
v53                    76527           53.057899
v54                    76527           53.057899
v64                    76527           53.057899
v63                    76527           53.057899
v62                    76527           53.057899
v61                    76527           53.057899
v60                    76527           53.057899
v59                    76527           53.057899
v58                    76527           53.057899
v57                    76527           53.057899
v56                    76527           53.057899
v55                    76527           53.057899
v65                    76527           53.057899
v74                    76527           53.057899
v80                    75967           52.669639
v76                    75967           52.669639
v77                    75967           52.669639
v78                    75967           52.669639
v79                    75967           52.669639
v81                    75967           52.669639
v82                    75967           52.669639
v83                    75967           52.669639
v84                    75967           52.669639
v85                    75967           52.669639
v86                    75967           52.669639
v87                    75967           52.669639
v88                    75967           52.669639
v89                    75967           52.669639
v90                    75967           52.669639
v91                    75967           52.669639
v92                    75967           52.669639
v75                    75967           52.669639
v93                    75967           52.669639
v94                    75967           52.669639
d15                    75916           52.634279
v13                    75052           52.035249
v12                    75052           52.035249
v34                    75052           52.035249
v25                    75052           52.035249
v14                    75052           52.035249
v15                    75052           52.035249
v33                    75052           52.035249
v18                    75052           52.035249
v19                    75052           52.035249
v20                    75052           52.035249
v21                    75052           52.035249
v22                    75052           52.035249
v23                    75052           52.035249
v24                    75052           52.035249
v17                    75052           52.035249
v26                    75052           52.035249
v31                    75052           52.035249
v27                    75052           52.035249
v32                    75052           52.035249
v16                    75052           52.035249
v30                    75052           52.035249
v28                    75052           52.035249
v29                    75052           52.035249
d10                    75001           51.999889
id_33                  70944           49.187079
d9                     69307           48.052110
d8                     69307           48.052110
id_09                  69307           48.052110
id_10                  69307           48.052110
id_30                  66668           46.222432
id_32                  66647           46.207872
id_34                  66428           46.056034
id_14                  64189           44.503685
v142                   62596           43.399222
v140                   62596           43.399222
v141                   62596           43.399222
v147                   62596           43.399222
v146                   62596           43.399222
v148                   62596           43.399222
v154                   62596           43.399222
v155                   62596           43.399222
v153                   62596           43.399222
v149                   62596           43.399222
v138                   62596           43.399222
v161                   62596           43.399222
v156                   62596           43.399222
v163                   62596           43.399222
v162                   62596           43.399222
v139                   62596           43.399222
v158                   62596           43.399222
v157                   62596           43.399222
v160                   62590           43.395062
v144                   62590           43.395062
v151                   62590           43.395062
v152                   62590           43.395062
v159                   62590           43.395062
v145                   62590           43.395062
v143                   62590           43.395062
v166                   62590           43.395062
v165                   62590           43.395062
v164                   62590           43.395062
v150                   62590           43.395062
v333                   62192           43.119120
v336                   62192           43.119120
v337                   62192           43.119120
v338                   62192           43.119120
v335                   62192           43.119120
v334                   62192           43.119120
v331                   62192           43.119120
v332                   62192           43.119120
v330                   62192           43.119120
v329                   62192           43.119120
v327                   62192           43.119120
v326                   62192           43.119120
v325                   62192           43.119120
v324                   62192           43.119120
v323                   62192           43.119120
v322                   62192           43.119120
v328                   62192           43.119120
v339                   62192           43.119120
addr1                  60447           41.909272
addr2                  60447           41.909272
deviceinfo             25567           17.726179
id_13                  16913           11.726165
id_16                  14893           10.325654
v235                   13964            9.681557
v236                   13964            9.681557
v237                   13964            9.681557
v240                   13964            9.681557
v241                   13964            9.681557
v226                   13964            9.681557
v242                   13964            9.681557
v244                   13964            9.681557
v246                   13964            9.681557
v247                   13964            9.681557
v248                   13964            9.681557
v243                   13964            9.681557
v233                   13964            9.681557
v252                   13964            9.681557
v232                   13964            9.681557
v231                   13964            9.681557
v230                   13964            9.681557
v229                   13964            9.681557
v223                   13964            9.681557
v217                   13964            9.681557
v218                   13964            9.681557
v219                   13964            9.681557
v228                   13964            9.681557
v225                   13964            9.681557
v249                   13964            9.681557
v224                   13964            9.681557
v253                   13964            9.681557
v266                   13964            9.681557
v278                   13964            9.681557
v277                   13964            9.681557
v276                   13964            9.681557
v275                   13964            9.681557
v274                   13964            9.681557
v273                   13964            9.681557
v269                   13964            9.681557
v268                   13964            9.681557
v267                   13964            9.681557
v265                   13964            9.681557
v264                   13964            9.681557
v263                   13964            9.681557
v262                   13964            9.681557
v261                   13964            9.681557
v260                   13964            9.681557
v258                   13964            9.681557
v257                   13964            9.681557
v254                   13964            9.681557
p_emaildomain          13391            9.284283
r_emaildomain          13150            9.117192
id_06                   7368            5.108401
id_05                   7368            5.108401
id_20                   4972            3.447200
id_19                   4915            3.407681
id_17                   4864            3.372321
v204                    4602            3.190671
v192                    4602            3.190671
v193                    4602            3.190671
v196                    4602            3.190671
v199                    4602            3.190671
v190                    4602            3.190671
v202                    4602            3.190671
v203                    4602            3.190671
v206                    4602            3.190671
v205                    4602            3.190671
v207                    4602            3.190671
v211                    4602            3.190671
v212                    4602            3.190671
v213                    4602            3.190671
v214                    4602            3.190671
v215                    4602            3.190671
v216                    4602            3.190671
v191                    4602            3.190671
v183                    4602            3.190671
v178                    4602            3.190671
v182                    4602            3.190671
v167                    4602            3.190671
v172                    4602            3.190671
v173                    4602            3.190671
v176                    4602            3.190671
v177                    4602            3.190671
v179                    4602            3.190671
v181                    4602            3.190671
v168                    4602            3.190671
v187                    4602            3.190671
v186                    4602            3.190671
v200                    4414            3.060326
v201                    4414            3.060326
v169                    4414            3.060326
v170                    4414            3.060326
v171                    4414            3.060326
v194                    4414            3.060326
v174                    4414            3.060326
v175                    4414            3.060326
v195                    4414            3.060326
v210                    4414            3.060326
v209                    4414            3.060326
v208                    4414            3.060326
v185                    4414            3.060326
v188                    4414            3.060326
v197                    4414            3.060326
v180                    4414            3.060326
v198                    4414            3.060326
v184                    4414            3.060326
v189                    4414            3.060326
id_31                   3951            2.739318
devicetype              3423            2.373243
id_02                   3361            2.330257
id_29                   3255            2.256765
id_11                   3255            2.256765
id_28                   3255            2.256765
id_35                   3248            2.251912
id_38                   3248            2.251912
id_15                   3248            2.251912
id_37                   3248            2.251912
id_36                   3248            2.251912
v250                    3127            2.168020
v251                    3127            2.168020
v222                    3127            2.168020
v221                    3127            2.168020
v270                    3127            2.168020
v255                    3127            2.168020
v256                    3127            2.168020
v272                    3127            2.168020
v271                    3127            2.168020
v245                    3127            2.168020
v259                    3127            2.168020
v238                    3127            2.168020
v227                    3127            2.168020
v220                    3127            2.168020
v239                    3127            2.168020
v234                    3127            2.168020
card5                    956            0.662816
card2                    902            0.625377
v283                     218            0.151144
v281                     218            0.151144
v313                     218            0.151144
v301                     218            0.151144
v288                     218            0.151144
v289                     218            0.151144
v296                     218            0.151144
v300                     218            0.151144
v315                     218            0.151144
v314                     218            0.151144
v282                     218            0.151144
d1                       218            0.151144
card4                    184            0.127571
card6                    178            0.123411
card3                    172            0.119251
v112                      64            0.044373
v95                       64            0.044373
v103                      64            0.044373
v137                      64            0.044373
v101                      64            0.044373
v100                      64            0.044373
v99                       64            0.044373
v98                       64            0.044373
v123                      64            0.044373
v97                       64            0.044373
v96                       64            0.044373
v122                      64            0.044373
v105                      64            0.044373
v121                      64            0.044373
v120                      64            0.044373
v119                      64            0.044373
v118                      64            0.044373
v117                      64            0.044373
v114                      64            0.044373
v116                      64            0.044373
v115                      64            0.044373
v104                      64            0.044373
v102                      64            0.044373
v108                      64            0.044373
v107                      64            0.044373
v125                      64            0.044373
v126                      64            0.044373
v127                      64            0.044373
v128                      64            0.044373
v129                      64            0.044373
v109                      64            0.044373
v110                      64            0.044373
v111                      64            0.044373
v130                      64            0.044373
v131                      64            0.044373
v132                      64            0.044373
v133                      64            0.044373
v134                      64            0.044373
v135                      64            0.044373
v136                      64            0.044373
v124                      64            0.044373
v113                      64            0.044373
v106                      64            0.044373
v307                       2            0.001387
v304                       2            0.001387
v290                       2            0.001387
v291                       2            0.001387
v292                       2            0.001387
v293                       2            0.001387
v294                       2            0.001387
v295                       2            0.001387
v285                       2            0.001387
v297                       2            0.001387
v298                       2            0.001387
v299                       2            0.001387
v284                       2            0.001387
v302                       2            0.001387
v303                       2            0.001387
v305                       2            0.001387
v308                       2            0.001387
v279                       2            0.001387
v321                       2            0.001387
v320                       2            0.001387
v319                       2            0.001387
v318                       2            0.001387
v317                       2            0.001387
v316                       2            0.001387
v280                       2            0.001387
v286                       2            0.001387
v306                       2            0.001387
v312                       2            0.001387
v311                       2            0.001387
v310                       2            0.001387
v309                       2            0.001387
v287                       2            0.001387
Columnas con al menos un valor nulo: 382
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ver de que tipos son las columnas</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_full</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>transactionid       int64
id_01             float64
id_02             float64
id_03             float64
id_04             float64
id_05             float64
id_06             float64
id_09             float64
id_10             float64
id_11             float64
id_12              object
id_13             float64
id_14             float64
id_15              object
id_16              object
id_17             float64
id_18             float64
id_19             float64
id_20             float64
id_28              object
id_29              object
id_30              object
id_31              object
id_32             float64
id_33              object
id_34              object
id_35              object
id_36              object
id_37              object
id_38              object
devicetype         object
deviceinfo         object
isfraud             int64
transactiondt       int64
transactionamt    float64
productcd          object
card1               int64
card2             float64
card3             float64
card4              object
card5             float64
card6              object
addr1             float64
addr2             float64
dist2             float64
p_emaildomain      object
r_emaildomain      object
c1                float64
c2                float64
c3                float64
c4                float64
c5                float64
c6                float64
c7                float64
c8                float64
c9                float64
c10               float64
c11               float64
c12               float64
c13               float64
c14               float64
d1                float64
d2                float64
d3                float64
d4                float64
d5                float64
d6                float64
d7                float64
d8                float64
d9                float64
d10               float64
d12               float64
d13               float64
d14               float64
d15               float64
m4                 object
v12               float64
v13               float64
v14               float64
v15               float64
v16               float64
v17               float64
v18               float64
v19               float64
v20               float64
v21               float64
v22               float64
v23               float64
v24               float64
v25               float64
v26               float64
v27               float64
v28               float64
v29               float64
v30               float64
v31               float64
v32               float64
v33               float64
v34               float64
v35               float64
v36               float64
v37               float64
v38               float64
v39               float64
v40               float64
v41               float64
v42               float64
v43               float64
v44               float64
v45               float64
v46               float64
v47               float64
v48               float64
v49               float64
v50               float64
v51               float64
v52               float64
v53               float64
v54               float64
v55               float64
v56               float64
v57               float64
v58               float64
v59               float64
v60               float64
v61               float64
v62               float64
v63               float64
v64               float64
v65               float64
v66               float64
v67               float64
v68               float64
v69               float64
v70               float64
v71               float64
v72               float64
v73               float64
v74               float64
v75               float64
v76               float64
v77               float64
v78               float64
v79               float64
v80               float64
v81               float64
v82               float64
v83               float64
v84               float64
v85               float64
v86               float64
v87               float64
v88               float64
v89               float64
v90               float64
v91               float64
v92               float64
v93               float64
v94               float64
v95               float64
v96               float64
v97               float64
v98               float64
v99               float64
v100              float64
v101              float64
v102              float64
v103              float64
v104              float64
v105              float64
v106              float64
v107              float64
v108              float64
v109              float64
v110              float64
v111              float64
v112              float64
v113              float64
v114              float64
v115              float64
v116              float64
v117              float64
v118              float64
v119              float64
v120              float64
v121              float64
v122              float64
v123              float64
v124              float64
v125              float64
v126              float64
v127              float64
v128              float64
v129              float64
v130              float64
v131              float64
v132              float64
v133              float64
v134              float64
v135              float64
v136              float64
v137              float64
v138              float64
v139              float64
v140              float64
v141              float64
v142              float64
v143              float64
v144              float64
v145              float64
v146              float64
v147              float64
v148              float64
v149              float64
v150              float64
v151              float64
v152              float64
v153              float64
v154              float64
v155              float64
v156              float64
v157              float64
v158              float64
v159              float64
v160              float64
v161              float64
v162              float64
v163              float64
v164              float64
v165              float64
v166              float64
v167              float64
v168              float64
v169              float64
v170              float64
v171              float64
v172              float64
v173              float64
v174              float64
v175              float64
v176              float64
v177              float64
v178              float64
v179              float64
v180              float64
v181              float64
v182              float64
v183              float64
v184              float64
v185              float64
v186              float64
v187              float64
v188              float64
v189              float64
v190              float64
v191              float64
v192              float64
v193              float64
v194              float64
v195              float64
v196              float64
v197              float64
v198              float64
v199              float64
v200              float64
v201              float64
v202              float64
v203              float64
v204              float64
v205              float64
v206              float64
v207              float64
v208              float64
v209              float64
v210              float64
v211              float64
v212              float64
v213              float64
v214              float64
v215              float64
v216              float64
v217              float64
v218              float64
v219              float64
v220              float64
v221              float64
v222              float64
v223              float64
v224              float64
v225              float64
v226              float64
v227              float64
v228              float64
v229              float64
v230              float64
v231              float64
v232              float64
v233              float64
v234              float64
v235              float64
v236              float64
v237              float64
v238              float64
v239              float64
v240              float64
v241              float64
v242              float64
v243              float64
v244              float64
v245              float64
v246              float64
v247              float64
v248              float64
v249              float64
v250              float64
v251              float64
v252              float64
v253              float64
v254              float64
v255              float64
v256              float64
v257              float64
v258              float64
v259              float64
v260              float64
v261              float64
v262              float64
v263              float64
v264              float64
v265              float64
v266              float64
v267              float64
v268              float64
v269              float64
v270              float64
v271              float64
v272              float64
v273              float64
v274              float64
v275              float64
v276              float64
v277              float64
v278              float64
v279              float64
v280              float64
v281              float64
v282              float64
v283              float64
v284              float64
v285              float64
v286              float64
v287              float64
v288              float64
v289              float64
v290              float64
v291              float64
v292              float64
v293              float64
v294              float64
v295              float64
v296              float64
v297              float64
v298              float64
v299              float64
v300              float64
v301              float64
v302              float64
v303              float64
v304              float64
v305              float64
v306              float64
v307              float64
v308              float64
v309              float64
v310              float64
v311              float64
v312              float64
v313              float64
v314              float64
v315              float64
v316              float64
v317              float64
v318              float64
v319              float64
v320              float64
v321              float64
v322              float64
v323              float64
v324              float64
v325              float64
v326              float64
v327              float64
v328              float64
v329              float64
v330              float64
v331              float64
v332              float64
v333              float64
v334              float64
v335              float64
v336              float64
v337              float64
v338              float64
v339              float64
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular porcentaje de nulos</span>
<span class="n">nulos_pct</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Filtrar columnas con más del 50%</span>
<span class="n">cols_50plus</span> <span class="o">=</span> <span class="n">nulos_pct</span><span class="p">[</span><span class="n">nulos_pct</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columnas con más del 50% de nulos: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cols_50plus</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Columnas con más del 50% de nulos: 99
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">analizadas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols_50plus</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">df_full</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">20</span><span class="p">:</span>  <span class="c1"># solo si tiene pocos valores únicos</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Análisis de </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Valores únicos (sin NA):&quot;</span><span class="p">,</span> <span class="n">df_full</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribución de fraude por categoría:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">df_full</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">col</span><span class="p">)[</span><span class="s1">&#39;isfraud&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="n">analizadas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total de variables analizadas: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">analizadas</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Análisis de id_04
Valores únicos (sin NA): 15
Distribución de fraude por categoría:
id_04
-11.0    0.629
-12.0    0.618
-13.0    0.583
-8.0     0.469
-2.0     0.467
-10.0    0.333
-9.0     0.231
-7.0     0.190
-4.0     0.157
-6.0     0.112
 0.0     0.106
-3.0     0.100
-5.0     0.098
-28.0    0.000
-1.0     0.000
Name: isfraud, dtype: float64

Análisis de id_18
Valores únicos (sin NA): 18
Distribución de fraude por categoría:
id_18
29.0    0.333
11.0    0.194
24.0    0.115
20.0    0.106
15.0    0.102
18.0    0.065
27.0    0.062
12.0    0.057
13.0    0.056
17.0    0.026
26.0    0.022
21.0    0.013
14.0    0.000
16.0    0.000
23.0    0.000
25.0    0.000
28.0    0.000
10.0    0.000
Name: isfraud, dtype: float64

Análisis de m4
Valores únicos (sin NA): 3
Distribución de fraude por categoría:
m4
M1    0.126
M2    0.125
M0    0.115
Name: isfraud, dtype: float64

Análisis de v12
Valores únicos (sin NA): 1
Distribución de fraude por categoría:
v12
0.0    0.108
Name: isfraud, dtype: float64

Análisis de v13
Valores únicos (sin NA): 1
Distribución de fraude por categoría:
v13
0.0    0.108
Name: isfraud, dtype: float64

Análisis de v14
Valores únicos (sin NA): 2
Distribución de fraude por categoría:
v14
1.0    0.108
0.0    0.016
Name: isfraud, dtype: float64

Análisis de v15
Valores únicos (sin NA): 8
Distribución de fraude por categoría:
v15
3.0    0.440
5.0    0.333
2.0    0.287
4.0    0.250
1.0    0.123
0.0    0.037
6.0    0.000
7.0    0.000
Name: isfraud, dtype: float64

Análisis de v16
Valores únicos (sin NA): 15
Distribución de fraude por categoría:
v16
4.0     0.500
6.0     0.286
3.0     0.264
2.0     0.249
1.0     0.122
5.0     0.111
0.0     0.037
7.0     0.000
8.0     0.000
9.0     0.000
10.0    0.000
11.0    0.000
13.0    0.000
14.0    0.000
15.0    0.000
Name: isfraud, dtype: float64

Análisis de v17
Valores únicos (sin NA): 16
Distribución de fraude por categoría:
v17
10.0    1.000
11.0    1.000
12.0    1.000
13.0    1.000
14.0    1.000
15.0    1.000
7.0     0.917
8.0     0.875
9.0     0.833
6.0     0.810
5.0     0.700
4.0     0.485
3.0     0.351
2.0     0.240
1.0     0.106
0.0     0.061
Name: isfraud, dtype: float64

Análisis de v18
Valores únicos (sin NA): 16
Distribución de fraude por categoría:
v18
10.0    1.000
11.0    1.000
12.0    1.000
13.0    1.000
14.0    1.000
15.0    1.000
9.0     0.833
7.0     0.688
5.0     0.617
6.0     0.613
8.0     0.538
4.0     0.425
3.0     0.384
2.0     0.211
1.0     0.105
0.0     0.061
Name: isfraud, dtype: float64

Análisis de v19
Valores únicos (sin NA): 8
Distribución de fraude por categoría:
v19
3.0    0.355
5.0    0.333
4.0    0.250
2.0    0.225
1.0    0.113
0.0    0.053
6.0    0.000
7.0    0.000
Name: isfraud, dtype: float64

Análisis de v20
Valores únicos (sin NA): 15
Distribución de fraude por categoría:
v20
4.0     0.500
6.0     0.286
3.0     0.241
2.0     0.185
1.0     0.113
5.0     0.111
0.0     0.053
7.0     0.000
8.0     0.000
9.0     0.000
10.0    0.000
11.0    0.000
13.0    0.000
14.0    0.000
15.0    0.000
Name: isfraud, dtype: float64

Análisis de v21
Valores únicos (sin NA): 6
Distribución de fraude por categoría:
v21
4.0    1.000
1.0    0.110
2.0    0.108
3.0    0.104
0.0    0.074
5.0    0.000
Name: isfraud, dtype: float64

Análisis de v22
Valores únicos (sin NA): 9
Distribución de fraude por categoría:
v22
3.0    0.287
6.0    0.286
1.0    0.110
4.0    0.083
2.0    0.082
0.0    0.074
5.0    0.000
7.0    0.000
8.0    0.000
Name: isfraud, dtype: float64

Análisis de v23
Valores únicos (sin NA): 14
Distribución de fraude por categoría:
v23
10.0    1.000
11.0    1.000
12.0    1.000
13.0    1.000
7.0     0.919
6.0     0.909
9.0     0.900
5.0     0.863
8.0     0.828
4.0     0.809
3.0     0.676
2.0     0.398
1.0     0.088
0.0     0.070
Name: isfraud, dtype: float64

Análisis de v24
Valores únicos (sin NA): 14
Distribución de fraude por categoría:
v24
12.0    1.000
13.0    1.000
8.0     0.867
10.0    0.867
7.0     0.860
6.0     0.808
9.0     0.792
4.0     0.791
5.0     0.754
11.0    0.625
3.0     0.621
2.0     0.377
1.0     0.088
0.0     0.066
Name: isfraud, dtype: float64

Análisis de v25
Valores únicos (sin NA): 6
Distribución de fraude por categoría:
v25
5.0    1.000
3.0    0.253
2.0    0.194
4.0    0.167
1.0    0.108
0.0    0.090
Name: isfraud, dtype: float64

Análisis de v26
Valores únicos (sin NA): 11
Distribución de fraude por categoría:
v26
7.0     0.400
6.0     0.375
4.0     0.286
3.0     0.267
5.0     0.200
2.0     0.146
1.0     0.108
0.0     0.090
8.0     0.000
9.0     0.000
10.0    0.000
Name: isfraud, dtype: float64

Análisis de v27
Valores únicos (sin NA): 4
Distribución de fraude por categoría:
v27
0.0    0.109
1.0    0.000
2.0    0.000
4.0    0.000
Name: isfraud, dtype: float64

Análisis de v28
Valores únicos (sin NA): 4
Distribución de fraude por categoría:
v28
0.0    0.109
1.0    0.000
2.0    0.000
4.0    0.000
Name: isfraud, dtype: float64

Análisis de v29
Valores únicos (sin NA): 1
Distribución de fraude por categoría:
v29
0.0    0.108
Name: isfraud, dtype: float64

Análisis de v30
Valores únicos (sin NA): 1
Distribución de fraude por categoría:
v30
0.0    0.108
Name: isfraud, dtype: float64

Análisis de v31
Valores únicos (sin NA): 8
Distribución de fraude por categoría:
v31
2.0    0.209
5.0    0.200
1.0    0.109
0.0    0.077
3.0    0.076
4.0    0.065
6.0    0.000
7.0    0.000
Name: isfraud, dtype: float64

Análisis de v32
Valores únicos (sin NA): 15
Distribución de fraude por categoría:
v32
4.0     0.405
6.0     0.250
2.0     0.180
1.0     0.109
3.0     0.102
0.0     0.077
5.0     0.073
7.0     0.000
8.0     0.000
9.0     0.000
10.0    0.000
11.0    0.000
13.0    0.000
14.0    0.000
15.0    0.000
Name: isfraud, dtype: float64

Análisis de v33
Valores únicos (sin NA): 6
Distribución de fraude por categoría:
v33
5.0    1.000
3.0    0.370
2.0    0.259
4.0    0.167
1.0    0.123
0.0    0.037
Name: isfraud, dtype: float64

Análisis de v34
Valores únicos (sin NA): 11
Distribución de fraude por categoría:
v34
7.0     0.400
6.0     0.375
3.0     0.352
4.0     0.286
2.0     0.208
5.0     0.200
1.0     0.122
0.0     0.037
8.0     0.000
9.0     0.000
10.0    0.000
Name: isfraud, dtype: float64

Análisis de v35
Valores únicos (sin NA): 1
Distribución de fraude por categoría:
v35
0.0    0.113
Name: isfraud, dtype: float64

Análisis de v36
Valores únicos (sin NA): 1
Distribución de fraude por categoría:
v36
0.0    0.113
Name: isfraud, dtype: float64

Análisis de v39
Valores únicos (sin NA): 16
Distribución de fraude por categoría:
v39
12.0    0.750
13.0    0.667
9.0     0.611
10.0    0.583
11.0    0.500
3.0     0.410
8.0     0.405
4.0     0.353
5.0     0.346
6.0     0.338
7.0     0.311
2.0     0.300
1.0     0.102
14.0    0.067
0.0     0.064
15.0    0.000
Name: isfraud, dtype: float64

Análisis de v40
Valores únicos (sin NA): 18
Distribución de fraude por categoría:
v40
24.0    1.000
23.0    1.000
13.0    0.667
10.0    0.593
11.0    0.500
9.0     0.500
8.0     0.440
6.0     0.430
3.0     0.399
4.0     0.365
12.0    0.333
7.0     0.307
5.0     0.271
2.0     0.243
1.0     0.096
14.0    0.062
0.0     0.057
15.0    0.000
Name: isfraud, dtype: float64

Análisis de v41
Valores únicos (sin NA): 2
Distribución de fraude por categoría:
v41
1.0    0.113
0.0    0.007
Name: isfraud, dtype: float64

Análisis de v42
Valores únicos (sin NA): 9
Distribución de fraude por categoría:
v42
5.0    0.500
3.0    0.303
2.0    0.264
1.0    0.108
4.0    0.100
0.0    0.095
6.0    0.000
7.0    0.000
8.0    0.000
Name: isfraud, dtype: float64

Análisis de v43
Valores únicos (sin NA): 9
Distribución de fraude por categoría:
v43
6.0    0.769
7.0    0.714
4.0    0.390
3.0    0.328
2.0    0.190
5.0    0.138
1.0    0.102
0.0    0.090
8.0    0.000
Name: isfraud, dtype: float64

Análisis de v46
Valores únicos (sin NA): 7
Distribución de fraude por categoría:
v46
5.0    1.000
6.0    1.000
4.0    0.827
3.0    0.704
2.0    0.340
1.0    0.099
0.0    0.006
Name: isfraud, dtype: float64

Análisis de v47
Valores únicos (sin NA): 9
Distribución de fraude por categoría:
v47
6.0     1.000
7.0     1.000
12.0    1.000
4.0     0.846
5.0     0.800
3.0     0.659
2.0     0.290
1.0     0.092
0.0     0.006
Name: isfraud, dtype: float64

Análisis de v48
Valores únicos (sin NA): 1
Distribución de fraude por categoría:
v48
0.0    0.113
Name: isfraud, dtype: float64

Análisis de v49
Valores únicos (sin NA): 1
Distribución de fraude por categoría:
v49
0.0    0.113
Name: isfraud, dtype: float64

Análisis de v50
Valores únicos (sin NA): 6
Distribución de fraude por categoría:
v50
1.0    0.115
4.0    0.067
2.0    0.035
0.0    0.035
3.0    0.019
5.0    0.000
Name: isfraud, dtype: float64

Análisis de v51
Valores únicos (sin NA): 7
Distribución de fraude por categoría:
v51
5.0    1.000
6.0    1.000
4.0    0.754
3.0    0.722
2.0    0.349
1.0    0.107
0.0    0.026
Name: isfraud, dtype: float64

Análisis de v52
Valores únicos (sin NA): 9
Distribución de fraude por categoría:
v52
6.0     1.000
7.0     1.000
12.0    1.000
4.0     0.852
5.0     0.789
3.0     0.671
2.0     0.294
1.0     0.100
0.0     0.026
Name: isfraud, dtype: float64

Análisis de v53
Valores únicos (sin NA): 1
Distribución de fraude por categoría:
v53
0.0    0.101
Name: isfraud, dtype: float64

Análisis de v54
Valores únicos (sin NA): 1
Distribución de fraude por categoría:
v54
0.0    0.101
Name: isfraud, dtype: float64

Análisis de v55
Valores únicos (sin NA): 18
Distribución de fraude por categoría:
v55
8.0     0.276
2.0     0.125
1.0     0.101
5.0     0.088
3.0     0.086
4.0     0.064
6.0     0.025
7.0     0.016
0.0     0.006
13.0    0.000
16.0    0.000
15.0    0.000
14.0    0.000
9.0     0.000
12.0    0.000
11.0    0.000
10.0    0.000
17.0    0.000
Name: isfraud, dtype: float64

Análisis de v57
Valores únicos (sin NA): 7
Distribución de fraude por categoría:
v57
5.0    0.500
2.0    0.280
3.0    0.243
4.0    0.208
1.0    0.107
0.0    0.040
6.0    0.000
Name: isfraud, dtype: float64

Análisis de v58
Valores únicos (sin NA): 11
Distribución de fraude por categoría:
v58
3.0     0.405
2.0     0.300
5.0     0.258
4.0     0.253
1.0     0.102
0.0     0.038
7.0     0.022
6.0     0.000
8.0     0.000
9.0     0.000
10.0    0.000
Name: isfraud, dtype: float64

Análisis de v59
Valores únicos (sin NA): 17
Distribución de fraude por categoría:
v59
4.0     0.208
3.0     0.208
2.0     0.192
1.0     0.098
0.0     0.091
5.0     0.050
11.0    0.000
15.0    0.000
14.0    0.000
13.0    0.000
12.0    0.000
8.0     0.000
10.0    0.000
9.0     0.000
7.0     0.000
6.0     0.000
16.0    0.000
Name: isfraud, dtype: float64

Análisis de v60
Valores únicos (sin NA): 17
Distribución de fraude por categoría:
v60
2.0     0.189
4.0     0.164
3.0     0.156
5.0     0.106
1.0     0.095
0.0     0.083
7.0     0.083
6.0     0.060
8.0     0.059
9.0     0.048
10.0    0.000
11.0    0.000
12.0    0.000
13.0    0.000
14.0    0.000
15.0    0.000
16.0    0.000
Name: isfraud, dtype: float64

Análisis de v61
Valores únicos (sin NA): 7
Distribución de fraude por categoría:
v61
5.0    0.500
2.0    0.273
3.0    0.243
4.0    0.208
1.0    0.101
0.0    0.059
6.0    0.000
Name: isfraud, dtype: float64

Análisis de v62
Valores únicos (sin NA): 11
Distribución de fraude por categoría:
v62
3.0     0.405
2.0     0.291
5.0     0.258
4.0     0.253
1.0     0.096
0.0     0.057
7.0     0.022
6.0     0.000
8.0     0.000
9.0     0.000
10.0    0.000
Name: isfraud, dtype: float64

Análisis de v63
Valores únicos (sin NA): 8
Distribución de fraude por categoría:
v63
4.0    0.281
3.0    0.193
2.0    0.174
0.0    0.100
1.0    0.099
5.0    0.000
6.0    0.000
7.0    0.000
Name: isfraud, dtype: float64

Análisis de v64
Valores únicos (sin NA): 8
Distribución de fraude por categoría:
v64
7.0    0.400
4.0    0.209
3.0    0.199
5.0    0.148
2.0    0.138
1.0    0.097
0.0    0.093
6.0    0.028
Name: isfraud, dtype: float64

Análisis de v65
Valores únicos (sin NA): 2
Distribución de fraude por categoría:
v65
1.0    0.102
0.0    0.006
Name: isfraud, dtype: float64

Análisis de v66
Valores únicos (sin NA): 8
Distribución de fraude por categoría:
v66
4.0    0.375
3.0    0.332
5.0    0.300
2.0    0.229
0.0    0.102
1.0    0.096
6.0    0.000
7.0    0.000
Name: isfraud, dtype: float64

Análisis de v67
Valores únicos (sin NA): 9
Distribución de fraude por categoría:
v67
8.0    1.000
6.0    0.667
7.0    0.667
5.0    0.500
4.0    0.481
3.0    0.374
2.0    0.217
0.0    0.100
1.0    0.091
Name: isfraud, dtype: float64

Análisis de v68
Valores únicos (sin NA): 3
Distribución de fraude por categoría:
v68
0.0    0.102
1.0    0.000
2.0    0.000
Name: isfraud, dtype: float64

Análisis de v69
Valores únicos (sin NA): 1
Distribución de fraude por categoría:
v69
0.0    0.101
Name: isfraud, dtype: float64

Análisis de v70
Valores únicos (sin NA): 1
Distribución de fraude por categoría:
v70
0.0    0.101
Name: isfraud, dtype: float64

Análisis de v71
Valores únicos (sin NA): 7
Distribución de fraude por categoría:
v71
5.0    0.500
2.0    0.262
4.0    0.161
3.0    0.152
1.0    0.097
0.0    0.093
6.0    0.000
Name: isfraud, dtype: float64

Análisis de v72
Valores únicos (sin NA): 11
Distribución de fraude por categoría:
v72
3.0     0.286
2.0     0.285
4.0     0.203
5.0     0.148
1.0     0.093
0.0     0.091
7.0     0.022
6.0     0.000
8.0     0.000
9.0     0.000
10.0    0.000
Name: isfraud, dtype: float64

Análisis de v73
Valores únicos (sin NA): 8
Distribución de fraude por categoría:
v73
4.0    0.375
3.0    0.332
5.0    0.300
2.0    0.235
1.0    0.106
0.0    0.040
6.0    0.000
7.0    0.000
Name: isfraud, dtype: float64

Análisis de v74
Valores únicos (sin NA): 9
Distribución de fraude por categoría:
v74
8.0    1.000
7.0    0.667
5.0    0.500
6.0    0.500
4.0    0.481
3.0    0.377
2.0    0.222
1.0    0.101
0.0    0.038
Name: isfraud, dtype: float64

Análisis de v75
Valores únicos (sin NA): 1
Distribución de fraude por categoría:
v75
0.0    0.109
Name: isfraud, dtype: float64

Análisis de v76
Valores únicos (sin NA): 1
Distribución de fraude por categoría:
v76
0.0    0.109
Name: isfraud, dtype: float64

Análisis de v79
Valores únicos (sin NA): 8
Distribución de fraude por categoría:
v79
6.0    0.538
4.0    0.492
3.0    0.485
2.0    0.346
1.0    0.113
5.0    0.059
0.0    0.020
7.0    0.000
Name: isfraud, dtype: float64

Análisis de v80
Valores únicos (sin NA): 20
Distribución de fraude por categoría:
v80
19.0    1.000
18.0    1.000
17.0    1.000
16.0    1.000
12.0    0.667
14.0    0.667
13.0    0.667
10.0    0.556
11.0    0.500
15.0    0.500
9.0     0.385
7.0     0.354
5.0     0.330
6.0     0.327
4.0     0.314
8.0     0.300
3.0     0.238
2.0     0.215
1.0     0.104
0.0     0.069
Name: isfraud, dtype: float64

Análisis de v81
Valores únicos (sin NA): 20
Distribución de fraude por categoría:
v81
19.0    1.000
18.0    1.000
17.0    1.000
16.0    1.000
13.0    0.800
12.0    0.750
14.0    0.667
15.0    0.500
11.0    0.429
9.0     0.400
6.0     0.330
7.0     0.309
8.0     0.276
10.0    0.273
3.0     0.271
4.0     0.240
5.0     0.229
2.0     0.190
1.0     0.101
0.0     0.061
Name: isfraud, dtype: float64

Análisis de v82
Valores únicos (sin NA): 8
Distribución de fraude por categoría:
v82
6.0    0.875
4.0    0.773
3.0    0.426
2.0    0.318
5.0    0.200
1.0    0.108
0.0    0.029
7.0    0.000
Name: isfraud, dtype: float64

Análisis de v83
Valores únicos (sin NA): 8
Distribución de fraude por categoría:
v83
6.0    0.538
4.0    0.492
3.0    0.486
2.0    0.329
1.0    0.104
5.0    0.059
0.0    0.029
7.0    0.000
Name: isfraud, dtype: float64

Análisis de v84
Valores únicos (sin NA): 8
Distribución de fraude por categoría:
v84
4.0    0.294
2.0    0.161
3.0    0.151
1.0    0.108
0.0    0.085
5.0    0.000
6.0    0.000
7.0    0.000
Name: isfraud, dtype: float64

Análisis de v85
Valores únicos (sin NA): 8
Distribución de fraude por categoría:
v85
4.0    0.344
7.0    0.333
3.0    0.207
5.0    0.191
2.0    0.138
1.0    0.105
0.0    0.081
6.0    0.041
Name: isfraud, dtype: float64

Análisis de v88
Valores únicos (sin NA): 2
Distribución de fraude por categoría:
v88
1.0    0.110
0.0    0.031
Name: isfraud, dtype: float64

Análisis de v89
Valores únicos (sin NA): 3
Distribución de fraude por categoría:
v89
0.0    0.11
1.0    0.00
2.0    0.00
Name: isfraud, dtype: float64

Análisis de v90
Valores únicos (sin NA): 1
Distribución de fraude por categoría:
v90
0.0    0.109
Name: isfraud, dtype: float64

Análisis de v91
Valores únicos (sin NA): 1
Distribución de fraude por categoría:
v91
0.0    0.109
Name: isfraud, dtype: float64

Análisis de v92
Valores únicos (sin NA): 8
Distribución de fraude por categoría:
v92
6.0    0.875
4.0    0.321
2.0    0.300
3.0    0.292
5.0    0.200
1.0    0.105
0.0    0.020
7.0    0.000
Name: isfraud, dtype: float64

Análisis de v93
Valores únicos (sin NA): 8
Distribución de fraude por categoría:
v93
6.0    0.538
4.0    0.413
3.0    0.386
2.0    0.290
1.0    0.102
5.0    0.023
0.0    0.019
7.0    0.000
Name: isfraud, dtype: float64

Análisis de v94
Valores únicos (sin NA): 2
Distribución de fraude por categoría:
v94
1.0    0.123
0.0    0.021
Name: isfraud, dtype: float64

Total de variables analizadas: 77
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Eliminar variables con un solo valor único</span>
<span class="n">vars_un_valor</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">analizadas</span> <span class="k">if</span> <span class="n">df_full</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1">#  Eliminar variables donde todas las categorías tienen tasa de fraude 0.0</span>
<span class="n">vars_sin_fraude</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">analizadas</span><span class="p">:</span>
    <span class="n">fraude_rates</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">col</span><span class="p">)[</span><span class="s1">&#39;isfraud&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">fraude_rates</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">vars_sin_fraude</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

<span class="c1"># Unir todas las variables a eliminar</span>
<span class="n">vars_a_eliminar</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">vars_un_valor</span> <span class="o">+</span> <span class="n">vars_sin_fraude</span><span class="p">))</span>

<span class="c1"># Eliminar del dataframe</span>
<span class="n">df_reducido</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">vars_a_eliminar</span><span class="p">)</span>

<span class="c1"># Mostrar resultado</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variables eliminadas: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">vars_a_eliminar</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vars_a_eliminar</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape original: </span><span class="si">{</span><span class="n">df_full</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape reducido: </span><span class="si">{</span><span class="n">df_reducido</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables eliminadas: 16
[&#39;v29&#39;, &#39;v76&#39;, &#39;v30&#39;, &#39;v53&#39;, &#39;v75&#39;, &#39;v35&#39;, &#39;v48&#39;, &#39;v12&#39;, &#39;v36&#39;, &#39;v91&#39;, &#39;v49&#39;, &#39;v90&#39;, &#39;v70&#39;, &#39;v54&#39;, &#39;v69&#39;, &#39;v13&#39;]
Shape original: (144233, 404)
Shape reducido: (144233, 388)
</pre></div>
</div>
</div>
</div>
<p>Como parte del preprocesamiento inicial del conjunto de datos, se implementó un análisis exploratorio orientado a reducir la dimensionalidad, específicamente sobre las variables con 50 o más valores únicos (<code class="docutils literal notranslate"><span class="pre">cols_50plus</span></code>). Se aplicó un filtro para analizar únicamente aquellas variables que poseían <strong>20 o menos valores únicos distintos</strong> (sin contar los valores faltantes). Este criterio no discrimina según el tipo de dato (<code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">object</span></code>, etc.), sino que se basa en la <strong>cardinalidad efectiva</strong> observada. Por lo tanto, se incluyeron tanto variables categóricas como numéricas que, en la práctica, presentaban un comportamiento discreto.</p>
<p>El análisis consistió en calcular la <strong>proporción de fraude (<code class="docutils literal notranslate"><span class="pre">isfraud</span></code>) asociada a cada valor</strong> dentro de dichas variables, mediante la agregación <code class="docutils literal notranslate"><span class="pre">groupby(col)['isfraud'].mean()</span></code>. Esto permitió detectar variables que <strong>no mostraban variación informativa</strong> relevante para el objetivo de clasificación. Entre ellas, podemos notar casos como la variable <code class="docutils literal notranslate"><span class="pre">v12</span></code> presentaba un único valor (<code class="docutils literal notranslate"><span class="pre">0.0</span></code>) con una tasa de fraude constante (0.108). Las variables <code class="docutils literal notranslate"><span class="pre">v29</span></code>, <code class="docutils literal notranslate"><span class="pre">v69</span></code>, <code class="docutils literal notranslate"><span class="pre">v70</span></code>, <code class="docutils literal notranslate"><span class="pre">v76</span></code>, entre otras, también contenían un solo valor o múltiples categorías cuya tasa de fraude era nula o constante.</p>
<p>Estas características indican que dichas variables <strong>no aportan capacidad de discriminación</strong> al modelo y podrían incluso introducir ruido o sobreajuste en etapas posteriores. Como resultado de este proceso, se procedió a <strong>eliminar 16 variables</strong> que cumplían con este perfil. El conjunto de datos se redujo de <strong>404 a 388 columnas</strong>, lo que representa una segunda etapa de depuración antes de aplicar técnicas más avanzadas de reducción de multicolinealidad como el <strong>Variance Inflation Factor (VIF)</strong>. Esta limpieza inicial es clave para facilitar la interpretación del VIF y evitar que variables carentes de significado influyan artificialmente en su cálculo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Identificar variables con más del 50% de NA</span>
<span class="n">na_50plus_restantes</span> <span class="o">=</span> <span class="n">df_reducido</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">df_reducido</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>

<span class="c1"># Mostrar cantidad y nombres</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variables con más del 50% de NA que aún permanecen: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">na_50plus_restantes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">na_50plus_restantes</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables con más del 50% de NA que aún permanecen: 83
[&#39;id_03&#39;, &#39;id_04&#39;, &#39;id_18&#39;, &#39;dist2&#39;, &#39;d2&#39;, &#39;d3&#39;, &#39;d4&#39;, &#39;d5&#39;, &#39;d6&#39;, &#39;d7&#39;, &#39;d10&#39;, &#39;d12&#39;, &#39;d13&#39;, &#39;d14&#39;, &#39;d15&#39;, &#39;m4&#39;, &#39;v14&#39;, &#39;v15&#39;, &#39;v16&#39;, &#39;v17&#39;, &#39;v18&#39;, &#39;v19&#39;, &#39;v20&#39;, &#39;v21&#39;, &#39;v22&#39;, &#39;v23&#39;, &#39;v24&#39;, &#39;v25&#39;, &#39;v26&#39;, &#39;v27&#39;, &#39;v28&#39;, &#39;v31&#39;, &#39;v32&#39;, &#39;v33&#39;, &#39;v34&#39;, &#39;v37&#39;, &#39;v38&#39;, &#39;v39&#39;, &#39;v40&#39;, &#39;v41&#39;, &#39;v42&#39;, &#39;v43&#39;, &#39;v44&#39;, &#39;v45&#39;, &#39;v46&#39;, &#39;v47&#39;, &#39;v50&#39;, &#39;v51&#39;, &#39;v52&#39;, &#39;v55&#39;, &#39;v56&#39;, &#39;v57&#39;, &#39;v58&#39;, &#39;v59&#39;, &#39;v60&#39;, &#39;v61&#39;, &#39;v62&#39;, &#39;v63&#39;, &#39;v64&#39;, &#39;v65&#39;, &#39;v66&#39;, &#39;v67&#39;, &#39;v68&#39;, &#39;v71&#39;, &#39;v72&#39;, &#39;v73&#39;, &#39;v74&#39;, &#39;v77&#39;, &#39;v78&#39;, &#39;v79&#39;, &#39;v80&#39;, &#39;v81&#39;, &#39;v82&#39;, &#39;v83&#39;, &#39;v84&#39;, &#39;v85&#39;, &#39;v86&#39;, &#39;v87&#39;, &#39;v88&#39;, &#39;v89&#39;, &#39;v92&#39;, &#39;v93&#39;, &#39;v94&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variables_50na</span> <span class="o">=</span> <span class="n">na_50plus_restantes</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">numericas_50na</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">variables_50na</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df_reducido</span><span class="p">[</span><span class="n">col</span><span class="p">])]</span>
<span class="n">categoricas_50na</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">variables_50na</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df_reducido</span><span class="p">[</span><span class="n">col</span><span class="p">])]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variables numéricas con &gt;50% NA: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">numericas_50na</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">numericas_50na</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Variables categóricas con &gt;50% NA: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">categoricas_50na</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">categoricas_50na</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables numéricas con &gt;50% NA: 82
[&#39;id_03&#39;, &#39;id_04&#39;, &#39;id_18&#39;, &#39;dist2&#39;, &#39;d2&#39;, &#39;d3&#39;, &#39;d4&#39;, &#39;d5&#39;, &#39;d6&#39;, &#39;d7&#39;, &#39;d10&#39;, &#39;d12&#39;, &#39;d13&#39;, &#39;d14&#39;, &#39;d15&#39;, &#39;v14&#39;, &#39;v15&#39;, &#39;v16&#39;, &#39;v17&#39;, &#39;v18&#39;, &#39;v19&#39;, &#39;v20&#39;, &#39;v21&#39;, &#39;v22&#39;, &#39;v23&#39;, &#39;v24&#39;, &#39;v25&#39;, &#39;v26&#39;, &#39;v27&#39;, &#39;v28&#39;, &#39;v31&#39;, &#39;v32&#39;, &#39;v33&#39;, &#39;v34&#39;, &#39;v37&#39;, &#39;v38&#39;, &#39;v39&#39;, &#39;v40&#39;, &#39;v41&#39;, &#39;v42&#39;, &#39;v43&#39;, &#39;v44&#39;, &#39;v45&#39;, &#39;v46&#39;, &#39;v47&#39;, &#39;v50&#39;, &#39;v51&#39;, &#39;v52&#39;, &#39;v55&#39;, &#39;v56&#39;, &#39;v57&#39;, &#39;v58&#39;, &#39;v59&#39;, &#39;v60&#39;, &#39;v61&#39;, &#39;v62&#39;, &#39;v63&#39;, &#39;v64&#39;, &#39;v65&#39;, &#39;v66&#39;, &#39;v67&#39;, &#39;v68&#39;, &#39;v71&#39;, &#39;v72&#39;, &#39;v73&#39;, &#39;v74&#39;, &#39;v77&#39;, &#39;v78&#39;, &#39;v79&#39;, &#39;v80&#39;, &#39;v81&#39;, &#39;v82&#39;, &#39;v83&#39;, &#39;v84&#39;, &#39;v85&#39;, &#39;v86&#39;, &#39;v87&#39;, &#39;v88&#39;, &#39;v89&#39;, &#39;v92&#39;, &#39;v93&#39;, &#39;v94&#39;]

Variables categóricas con &gt;50% NA: 1
[&#39;m4&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtrar solo variables numéricas</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">numericas_50plus</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">na_50plus_restantes</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">df_reducido</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)]</span>

<span class="c1"># Resumen estadístico para estas variables</span>
<span class="n">resumen_numericas</span> <span class="o">=</span> <span class="n">df_reducido</span><span class="p">[</span><span class="n">numericas_50plus</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># Mostrar cantidad y primeras filas</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total variables numéricas con &gt;50% NA: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">numericas_50plus</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">resumen_numericas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total variables numéricas con &gt;50% NA: 82
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id_03</th>
      <td>66324.0</td>
      <td>0.060189</td>
      <td>0.598231</td>
      <td>-13.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>id_04</th>
      <td>66324.0</td>
      <td>-0.058938</td>
      <td>0.701015</td>
      <td>-28.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>id_18</th>
      <td>45113.0</td>
      <td>14.237337</td>
      <td>1.561302</td>
      <td>10.0</td>
      <td>13.0</td>
      <td>15.0</td>
      <td>15.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>dist2</th>
      <td>37593.0</td>
      <td>231.945575</td>
      <td>529.251862</td>
      <td>0.0</td>
      <td>7.0</td>
      <td>37.0</td>
      <td>206.0</td>
      <td>11623.0</td>
    </tr>
    <tr>
      <th>d2</th>
      <td>31116.0</td>
      <td>123.092685</td>
      <td>164.379461</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>37.0</td>
      <td>209.0</td>
      <td>640.0</td>
    </tr>
    <tr>
      <th>d3</th>
      <td>29059.0</td>
      <td>34.339241</td>
      <td>85.971337</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>15.0</td>
      <td>819.0</td>
    </tr>
    <tr>
      <th>d4</th>
      <td>64768.0</td>
      <td>60.953449</td>
      <td>137.813840</td>
      <td>-83.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>15.0</td>
      <td>869.0</td>
    </tr>
    <tr>
      <th>d5</th>
      <td>33075.0</td>
      <td>46.471081</td>
      <td>107.273166</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>21.0</td>
      <td>819.0</td>
    </tr>
    <tr>
      <th>d6</th>
      <td>67373.0</td>
      <td>70.927924</td>
      <td>145.236135</td>
      <td>-83.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>42.0</td>
      <td>873.0</td>
    </tr>
    <tr>
      <th>d7</th>
      <td>36140.0</td>
      <td>41.297593</td>
      <td>99.961129</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>16.0</td>
      <td>843.0</td>
    </tr>
    <tr>
      <th>d10</th>
      <td>69232.0</td>
      <td>23.168795</td>
      <td>96.129424</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>876.0</td>
    </tr>
    <tr>
      <th>d12</th>
      <td>58909.0</td>
      <td>53.612962</td>
      <td>123.964969</td>
      <td>-83.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>648.0</td>
    </tr>
    <tr>
      <th>d13</th>
      <td>61936.0</td>
      <td>17.897168</td>
      <td>67.606903</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>847.0</td>
    </tr>
    <tr>
      <th>d14</th>
      <td>62165.0</td>
      <td>57.727033</td>
      <td>136.321564</td>
      <td>-193.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>878.0</td>
    </tr>
    <tr>
      <th>d15</th>
      <td>68317.0</td>
      <td>54.710189</td>
      <td>138.511006</td>
      <td>-83.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>879.0</td>
    </tr>
    <tr>
      <th>v14</th>
      <td>69181.0</td>
      <td>0.996328</td>
      <td>0.060482</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>v15</th>
      <td>69181.0</td>
      <td>0.827482</td>
      <td>0.400924</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>v16</th>
      <td>69181.0</td>
      <td>0.832873</td>
      <td>0.434386</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>v17</th>
      <td>69181.0</td>
      <td>0.994131</td>
      <td>0.359516</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>v18</th>
      <td>69181.0</td>
      <td>1.003513</td>
      <td>0.388810</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>v19</th>
      <td>69181.0</td>
      <td>0.911030</td>
      <td>0.319081</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>v20</th>
      <td>69181.0</td>
      <td>0.917116</td>
      <td>0.360141</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>v21</th>
      <td>69181.0</td>
      <td>0.961912</td>
      <td>0.226804</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>v22</th>
      <td>69181.0</td>
      <td>0.980732</td>
      <td>0.350470</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>v23</th>
      <td>69181.0</td>
      <td>1.074891</td>
      <td>0.478007</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>v24</th>
      <td>69181.0</td>
      <td>1.083679</td>
      <td>0.508650</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>v25</th>
      <td>69181.0</td>
      <td>0.968170</td>
      <td>0.224024</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>v26</th>
      <td>69181.0</td>
      <td>0.975080</td>
      <td>0.268815</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>v27</th>
      <td>69181.0</td>
      <td>0.005739</td>
      <td>0.077613</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>v28</th>
      <td>69181.0</td>
      <td>0.006143</td>
      <td>0.084536</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>v31</th>
      <td>69181.0</td>
      <td>0.964036</td>
      <td>0.267020</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>v32</th>
      <td>69181.0</td>
      <td>0.973418</td>
      <td>0.326087</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>v33</th>
      <td>69181.0</td>
      <td>0.827380</td>
      <td>0.396512</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>v34</th>
      <td>69181.0</td>
      <td>0.832729</td>
      <td>0.423137</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>v37</th>
      <td>64745.0</td>
      <td>1.480670</td>
      <td>1.608326</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>54.0</td>
    </tr>
    <tr>
      <th>v38</th>
      <td>64745.0</td>
      <td>1.666523</td>
      <td>1.972178</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>54.0</td>
    </tr>
    <tr>
      <th>v39</th>
      <td>64745.0</td>
      <td>1.063403</td>
      <td>0.592604</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>v40</th>
      <td>64745.0</td>
      <td>1.134018</td>
      <td>0.742462</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>v41</th>
      <td>64745.0</td>
      <td>0.995505</td>
      <td>0.066891</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>v42</th>
      <td>64745.0</td>
      <td>1.000108</td>
      <td>0.307677</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>v43</th>
      <td>64745.0</td>
      <td>1.082091</td>
      <td>0.463226</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>v44</th>
      <td>64745.0</td>
      <td>1.297089</td>
      <td>1.518729</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>48.0</td>
    </tr>
    <tr>
      <th>v45</th>
      <td>64745.0</td>
      <td>1.374361</td>
      <td>1.698082</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>48.0</td>
    </tr>
    <tr>
      <th>v46</th>
      <td>64745.0</td>
      <td>1.050954</td>
      <td>0.286515</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>v47</th>
      <td>64745.0</td>
      <td>1.091976</td>
      <td>0.416759</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>v50</th>
      <td>64745.0</td>
      <td>0.983937</td>
      <td>0.174669</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>v51</th>
      <td>64745.0</td>
      <td>0.957402</td>
      <td>0.408359</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>v52</th>
      <td>64745.0</td>
      <td>0.996556</td>
      <td>0.507394</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>v55</th>
      <td>67706.0</td>
      <td>1.291348</td>
      <td>0.895342</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>v56</th>
      <td>67706.0</td>
      <td>1.470904</td>
      <td>1.595454</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>v57</th>
      <td>67706.0</td>
      <td>0.884899</td>
      <td>0.411417</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>v58</th>
      <td>67706.0</td>
      <td>0.915030</td>
      <td>0.499703</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>v59</th>
      <td>67706.0</td>
      <td>1.004180</td>
      <td>0.446037</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>v60</th>
      <td>67706.0</td>
      <td>1.064499</td>
      <td>0.567663</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>v61</th>
      <td>67706.0</td>
      <td>0.935870</td>
      <td>0.358540</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>v62</th>
      <td>67706.0</td>
      <td>0.966576</td>
      <td>0.454460</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>v63</th>
      <td>67706.0</td>
      <td>0.976871</td>
      <td>0.340197</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>v64</th>
      <td>67706.0</td>
      <td>1.059256</td>
      <td>0.509481</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>v65</th>
      <td>67706.0</td>
      <td>0.997445</td>
      <td>0.050484</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>v66</th>
      <td>67706.0</td>
      <td>0.991744</td>
      <td>0.323612</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>v67</th>
      <td>67706.0</td>
      <td>1.026999</td>
      <td>0.386743</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>v68</th>
      <td>67706.0</td>
      <td>0.004047</td>
      <td>0.065322</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>v71</th>
      <td>67706.0</td>
      <td>0.978288</td>
      <td>0.320302</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>v72</th>
      <td>67706.0</td>
      <td>1.011048</td>
      <td>0.430876</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>v73</th>
      <td>67706.0</td>
      <td>0.896892</td>
      <td>0.432851</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>v74</th>
      <td>67706.0</td>
      <td>0.931409</td>
      <td>0.487605</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>v77</th>
      <td>68266.0</td>
      <td>1.417528</td>
      <td>1.280691</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>v78</th>
      <td>68266.0</td>
      <td>1.618448</td>
      <td>1.889664</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>v79</th>
      <td>68266.0</td>
      <td>0.915448</td>
      <td>0.508479</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>v80</th>
      <td>68266.0</td>
      <td>1.048619</td>
      <td>0.524527</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>v81</th>
      <td>68266.0</td>
      <td>1.111974</td>
      <td>0.649189</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>v82</th>
      <td>68266.0</td>
      <td>0.974277</td>
      <td>0.310202</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>v83</th>
      <td>68266.0</td>
      <td>1.001377</td>
      <td>0.428937</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>v84</th>
      <td>68266.0</td>
      <td>0.998975</td>
      <td>0.303787</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>v85</th>
      <td>68266.0</td>
      <td>1.090982</td>
      <td>0.504196</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>v86</th>
      <td>68266.0</td>
      <td>1.233191</td>
      <td>0.981711</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>v87</th>
      <td>68266.0</td>
      <td>1.288885</td>
      <td>1.154573</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>v88</th>
      <td>68266.0</td>
      <td>0.994727</td>
      <td>0.072428</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>v89</th>
      <td>68266.0</td>
      <td>0.006577</td>
      <td>0.086099</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>v92</th>
      <td>68266.0</td>
      <td>1.014985</td>
      <td>0.271006</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>v93</th>
      <td>68266.0</td>
      <td>1.047330</td>
      <td>0.408510</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>v94</th>
      <td>68266.0</td>
      <td>0.861014</td>
      <td>0.345934</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Se han identificado 83 variables que, aunque tienen más del 50% de valores faltantes, no fueron descartadas anteriormente porque mostraban suficiente variabilidad o cardinalidad. Ahora, se realizará una validación más detallada para evaluar su utilidad. En el caso de las variables numéricas, se analizará si siguen una distribución normal, ya que esto influye en la estrategia de imputación más adecuada. Para ello se aplicará la prueba de Anderson-Darling, especialmente indicada para grandes volúmenes de datos por su sensibilidad a los extremos de la distribución. Este análisis ayudará a decidir si tiene sentido imputarlas bajo un modelo que asuma normalidad, si conviene usar métodos alternativos o si, en algunos casos, sería mejor descartarlas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Variables con más del 50% de NA aún presentes</span>
<span class="n">na_50plus_restantes</span> <span class="o">=</span> <span class="n">df_reducido</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">df_reducido</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>

<span class="c1"># Filtrar solo variables numéricas</span>
<span class="n">num_vars_50plus</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">na_50plus_restantes</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">df_reducido</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)]</span>

<span class="c1"># Ejecutar prueba de Anderson-Darling para normalidad</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resultados de la prueba Anderson-Darling:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">num_vars_50plus</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">df_reducido</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">500</span><span class="p">:</span>  <span class="c1"># aseguramos tamaño suficiente</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">anderson</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="s1">&#39;norm&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Variable: </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estadístico A²: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1">#for sig_lvl, crit_val in zip(result.significance_level, result.critical_values):</span>
            <span class="c1">#print(f&quot;  Nivel de significancia {sig_lvl}%: valor crítico = {crit_val:.4f}&quot;)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">statistic</span> <span class="o">&gt;</span> <span class="n">result</span><span class="o">.</span><span class="n">critical_values</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>  <span class="c1"># 5% nivel usual</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  =&gt; No se ajusta a una distribución normal (rechaza H0)&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  =&gt; Se ajusta a una distribución normal (no se rechaza H0)&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Variable: </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  =&gt; Insuficientes datos no nulos para aplicar la prueba&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados de la prueba Anderson-Darling:

Variable: id_03
Estadístico A²: 22942.2543
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: id_04
Estadístico A²: 25201.0597
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: id_18
Estadístico A²: 4242.2669
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: dist2
Estadístico A²: 6189.8140
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: d2
Estadístico A²: 2988.7932
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: d3
Estadístico A²: 6338.6985
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: d4
Estadístico A²: 14294.5297
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: d5
Estadístico A²: 7072.9715
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: d6
Estadístico A²: 13125.1002
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: d7
Estadístico A²: 8025.0140
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: d10
Estadístico A²: 22343.5488
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: d12
Estadístico A²: 13380.0798
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: d13
Estadístico A²: 17592.3529
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: d14
Estadístico A²: 14479.3409
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: d15
Estadístico A²: 16280.2223
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v14
Estadístico A²: 26639.2879
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v15
Estadístico A²: 18118.2680
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v16
Estadístico A²: 16818.6333
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v17
Estadístico A²: 21919.5591
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v18
Estadístico A²: 21523.6984
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v19
Estadístico A²: 21463.5319
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v20
Estadístico A²: 20178.3146
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v21
Estadístico A²: 23995.8387
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v22
Estadístico A²: 22116.4595
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v23
Estadístico A²: 23003.8769
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v24
Estadístico A²: 22706.0813
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v25
Estadístico A²: 23930.5242
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v26
Estadístico A²: 23009.8146
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v27
Estadístico A²: 26565.9367
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v28
Estadístico A²: 26530.7989
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v31
Estadístico A²: 22923.0763
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v32
Estadístico A²: 21921.8397
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v33
Estadístico A²: 18275.7537
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v34
Estadístico A²: 17118.7505
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v37
Estadístico A²: 14377.8956
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v38
Estadístico A²: 12740.7070
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v39
Estadístico A²: 18651.6798
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v40
Estadístico A²: 16819.4212
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v41
Estadístico A²: 24910.9728
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v42
Estadístico A²: 19641.2752
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v43
Estadístico A²: 16246.9476
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v44
Estadístico A²: 17887.7838
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v45
Estadístico A²: 17122.8535
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v46
Estadístico A²: 22069.0802
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v47
Estadístico A²: 19961.6205
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v50
Estadístico A²: 23460.4131
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v51
Estadístico A²: 15952.2479
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v52
Estadístico A²: 13925.9952
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v55
Estadístico A²: 16512.5772
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v56
Estadístico A²: 14760.0467
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v57
Estadístico A²: 16419.5500
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v58
Estadístico A²: 14237.2589
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v59
Estadístico A²: 18597.9979
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v60
Estadístico A²: 16676.6225
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v61
Estadístico A²: 18530.2472
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v62
Estadístico A²: 16546.1599
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v63
Estadístico A²: 19430.7448
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v64
Estadístico A²: 15831.8285
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v65
Estadístico A²: 26098.8118
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v66
Estadístico A²: 19779.1368
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v67
Estadístico A²: 18187.1634
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v68
Estadístico A²: 26049.8876
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v71
Estadístico A²: 20066.6856
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v72
Estadístico A²: 18565.9834
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v73
Estadístico A²: 15339.9119
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v74
Estadístico A²: 13365.7203
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v77
Estadístico A²: 15257.9310
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v78
Estadístico A²: 13971.2300
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v79
Estadístico A²: 14713.0866
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v80
Estadístico A²: 20260.5933
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v81
Estadístico A²: 18233.7996
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v82
Estadístico A²: 20646.2614
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v83
Estadístico A²: 19085.4946
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v84
Estadístico A²: 20935.1464
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v85
Estadístico A²: 17063.0384
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v86
Estadístico A²: 18025.4480
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v87
Estadístico A²: 17249.6417
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v88
Estadístico A²: 26245.0254
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v89
Estadístico A²: 26173.6960
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v92
Estadístico A²: 22686.1510
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v93
Estadístico A²: 21289.1820
  =&gt; No se ajusta a una distribución normal (rechaza H0)

Variable: v94
Estadístico A²: 20740.7243
  =&gt; No se ajusta a una distribución normal (rechaza H0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crear una carpeta para guardar las imágenes si no existe</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;boxplots_individuales&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Guardar cada boxplot como imagen separada</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numericas_50plus</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;isfraud&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_reducido</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;boxplots_individuales/</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar en bloques de 6</span>
<span class="n">cols</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">imgs</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;boxplots_individuales/</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">.png&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numericas_50plus</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">imgs</span><span class="p">),</span> <span class="n">cols</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">cols</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">imgs</span><span class="p">):</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">PILImage</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">imgs</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/07ed85fdfb463cc26766fdc3d0ca229104cebdef73e5b80464ae705dcb5a9f7f.png" src="_images/07ed85fdfb463cc26766fdc3d0ca229104cebdef73e5b80464ae705dcb5a9f7f.png" />
<img alt="_images/9736e4b8fdea00f6b96b21f05aafb896095a89b58fa20d0249e8861a9839fe11.png" src="_images/9736e4b8fdea00f6b96b21f05aafb896095a89b58fa20d0249e8861a9839fe11.png" />
<img alt="_images/1af992bc7f0e69ec0b9f46c1c19284155e01bdde17fb8842929c2577b7a08267.png" src="_images/1af992bc7f0e69ec0b9f46c1c19284155e01bdde17fb8842929c2577b7a08267.png" />
<img alt="_images/d687161cc2b64852c6187b4a4cff335c493f9292772e9f890ca63ad714afd9f3.png" src="_images/d687161cc2b64852c6187b4a4cff335c493f9292772e9f890ca63ad714afd9f3.png" />
<img alt="_images/ebf960ef187be7927e67000043d20d6d95e8c5babcecc3085d3776b13a8b84b1.png" src="_images/ebf960ef187be7927e67000043d20d6d95e8c5babcecc3085d3776b13a8b84b1.png" />
<img alt="_images/abd6d3299310405bd913308bcf3b05f39f7acb6c958ca676294baede3b1011f6.png" src="_images/abd6d3299310405bd913308bcf3b05f39f7acb6c958ca676294baede3b1011f6.png" />
<img alt="_images/b53972cd1a028a20d8fe11351925a4e6ba2538757f5fe951e44cf090d5257f4c.png" src="_images/b53972cd1a028a20d8fe11351925a4e6ba2538757f5fe951e44cf090d5257f4c.png" />
<img alt="_images/72d7e5fbec12d39701fa1da42dda4d61fd673db2b1c0c3cf1b032885b2d3021d.png" src="_images/72d7e5fbec12d39701fa1da42dda4d61fd673db2b1c0c3cf1b032885b2d3021d.png" />
<img alt="_images/4438822f236029422cfcb82e0f352e7082e963f28163538f201da465d56fcab1.png" src="_images/4438822f236029422cfcb82e0f352e7082e963f28163538f201da465d56fcab1.png" />
<img alt="_images/1b83501fc8df553d53068d9e45591115d483f14c1d1a77f4e96a140429624914.png" src="_images/1b83501fc8df553d53068d9e45591115d483f14c1d1a77f4e96a140429624914.png" />
<img alt="_images/a1994e2560e56ad6a23ad082da208edd4a4e1c9f4cf2460306745be66a6d6478.png" src="_images/a1994e2560e56ad6a23ad082da208edd4a4e1c9f4cf2460306745be66a6d6478.png" />
<img alt="_images/f46c3cd20c7b6322d37d05b10de1ff62837ddaebc60129d9faa2f64443ae5661.png" src="_images/f46c3cd20c7b6322d37d05b10de1ff62837ddaebc60129d9faa2f64443ae5661.png" />
<img alt="_images/866dc10c638aea2c145518d9789aa92f91fd16ba5c8c98d7ba1de336d01800b5.png" src="_images/866dc10c638aea2c145518d9789aa92f91fd16ba5c8c98d7ba1de336d01800b5.png" />
<img alt="_images/39edf86804fe82dfa8c29290ee2297697eab2874d5263a667af366a36d913161.png" src="_images/39edf86804fe82dfa8c29290ee2297697eab2874d5263a667af366a36d913161.png" />
</div>
</div>
<p>Luego de aplicar la prueba de normalidad de Anderson-Darling y visualizar la relación entre cada variable numérica con más del 50% de valores nulos frente a la variable objetivo isfraud, se evidenció que ninguna presenta una distribución normal ni una diferenciación clara entre clases. En la mayoría de los casos, los datos están concentrados en valores constantes o muy cercanos a cero, acompañados de valores atípicos extremos y sin un patrón útil para distinguir fraudes. Dado que todas estas variables tienen más de la mitad de sus datos ausentes y no aportan información relevante al problema de clasificación, su imputación representaría un riesgo considerable de introducir ruido. Por tanto, se decide eliminarlas por completo del conjunto de datos, priorizando así la calidad del modelo sobre la cantidad de variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Eliminar TODAS las columnas con más del 50% de NA (sin importar tipo)</span>
<span class="n">umbral</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">columnas_mas50_na</span> <span class="o">=</span> <span class="n">df_reducido</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">df_reducido</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">umbral</span><span class="p">]</span>
<span class="n">df_reducido_2</span> <span class="o">=</span> <span class="n">df_reducido</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columnas_mas50_na</span><span class="p">)</span>

<span class="c1"># Confirmar</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columnas eliminadas por &gt;50% NA (sin importar tipo): </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">columnas_mas50_na</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dimensión final del dataframe: </span><span class="si">{</span><span class="n">df_reducido_2</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Columnas eliminadas por &gt;50% NA (sin importar tipo): 83
Dimensión final del dataframe: (144233, 305)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular porcentaje de NA para las columnas restantes</span>
<span class="n">porcentaje_na_restantes</span> <span class="o">=</span> <span class="n">df_reducido_2</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Filtrar solo columnas que aún tienen NA</span>
<span class="n">variables_con_na</span> <span class="o">=</span> <span class="n">porcentaje_na_restantes</span><span class="p">[</span><span class="n">porcentaje_na_restantes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Mostrar resultado</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total de variables con NA restantes: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">variables_con_na</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">variables_con_na</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total de variables con NA restantes: 283
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id_33            49.187079
d9               48.052110
id_09            48.052110
d8               48.052110
id_10            48.052110
id_30            46.222432
id_32            46.207872
id_34            46.056034
id_14            44.503685
v147             43.399222
v146             43.399222
v155             43.399222
v148             43.399222
v154             43.399222
v149             43.399222
v157             43.399222
v158             43.399222
v163             43.399222
v142             43.399222
v162             43.399222
v161             43.399222
v141             43.399222
v140             43.399222
v139             43.399222
v156             43.399222
v138             43.399222
v153             43.399222
v152             43.395062
v160             43.395062
v159             43.395062
v151             43.395062
v150             43.395062
v145             43.395062
v143             43.395062
v164             43.395062
v165             43.395062
v166             43.395062
v144             43.395062
v339             43.119120
v328             43.119120
v337             43.119120
v335             43.119120
v334             43.119120
v333             43.119120
v332             43.119120
v331             43.119120
v330             43.119120
v329             43.119120
v336             43.119120
v327             43.119120
v326             43.119120
v325             43.119120
v324             43.119120
v323             43.119120
v322             43.119120
v338             43.119120
addr2            41.909272
addr1            41.909272
deviceinfo       17.726179
id_13            11.726165
id_16            10.325654
v232              9.681557
v217              9.681557
v218              9.681557
v219              9.681557
v223              9.681557
v224              9.681557
v225              9.681557
v226              9.681557
v228              9.681557
v229              9.681557
v230              9.681557
v231              9.681557
v237              9.681557
v233              9.681557
v265              9.681557
v253              9.681557
v254              9.681557
v235              9.681557
v258              9.681557
v260              9.681557
v261              9.681557
v262              9.681557
v263              9.681557
v264              9.681557
v266              9.681557
v249              9.681557
v267              9.681557
v268              9.681557
v269              9.681557
v273              9.681557
v274              9.681557
v275              9.681557
v276              9.681557
v277              9.681557
v278              9.681557
v252              9.681557
v257              9.681557
v243              9.681557
v242              9.681557
v241              9.681557
v244              9.681557
v246              9.681557
v247              9.681557
v248              9.681557
v240              9.681557
v236              9.681557
p_emaildomain     9.284283
r_emaildomain     9.117192
id_06             5.108401
id_05             5.108401
id_20             3.447200
id_19             3.407681
id_17             3.372321
v190              3.190671
v176              3.190671
v186              3.190671
v183              3.190671
v182              3.190671
v181              3.190671
v179              3.190671
v178              3.190671
v199              3.190671
v196              3.190671
v205              3.190671
v193              3.190671
v192              3.190671
v191              3.190671
v202              3.190671
v203              3.190671
v204              3.190671
v206              3.190671
v216              3.190671
v207              3.190671
v211              3.190671
v212              3.190671
v213              3.190671
v214              3.190671
v215              3.190671
v177              3.190671
v187              3.190671
v167              3.190671
v173              3.190671
v172              3.190671
v168              3.190671
v175              3.060326
v210              3.060326
v209              3.060326
v208              3.060326
v174              3.060326
v201              3.060326
v200              3.060326
v197              3.060326
v195              3.060326
v194              3.060326
v198              3.060326
v184              3.060326
v169              3.060326
v189              3.060326
v188              3.060326
v180              3.060326
v171              3.060326
v170              3.060326
v185              3.060326
id_31             2.739318
devicetype        2.373243
id_02             2.330257
id_28             2.256765
id_29             2.256765
id_11             2.256765
id_35             2.251912
id_36             2.251912
id_15             2.251912
id_37             2.251912
id_38             2.251912
v227              2.168020
v250              2.168020
v259              2.168020
v251              2.168020
v234              2.168020
v256              2.168020
v255              2.168020
v221              2.168020
v238              2.168020
v239              2.168020
v222              2.168020
v245              2.168020
v220              2.168020
v271              2.168020
v272              2.168020
v270              2.168020
card5             0.662816
card2             0.625377
v300              0.151144
v296              0.151144
v315              0.151144
v314              0.151144
d1                0.151144
v313              0.151144
v301              0.151144
v288              0.151144
v289              0.151144
v283              0.151144
v282              0.151144
v281              0.151144
card4             0.127571
card6             0.123411
card3             0.119251
v95               0.044373
v98               0.044373
v97               0.044373
v96               0.044373
v99               0.044373
v118              0.044373
v120              0.044373
v121              0.044373
v123              0.044373
v124              0.044373
v125              0.044373
v126              0.044373
v127              0.044373
v128              0.044373
v129              0.044373
v137              0.044373
v100              0.044373
v136              0.044373
v135              0.044373
v130              0.044373
v131              0.044373
v132              0.044373
v133              0.044373
v119              0.044373
v122              0.044373
v117              0.044373
v110              0.044373
v101              0.044373
v102              0.044373
v103              0.044373
v104              0.044373
v105              0.044373
v107              0.044373
v108              0.044373
v109              0.044373
v106              0.044373
v134              0.044373
v111              0.044373
v112              0.044373
v113              0.044373
v114              0.044373
v115              0.044373
v116              0.044373
v309              0.001387
v321              0.001387
v304              0.001387
v305              0.001387
v306              0.001387
v307              0.001387
v308              0.001387
v317              0.001387
v310              0.001387
v311              0.001387
v316              0.001387
v318              0.001387
v303              0.001387
v319              0.001387
v320              0.001387
v312              0.001387
v285              0.001387
v302              0.001387
v291              0.001387
v279              0.001387
v280              0.001387
v284              0.001387
v286              0.001387
v299              0.001387
v290              0.001387
v287              0.001387
v292              0.001387
v293              0.001387
v294              0.001387
v295              0.001387
v297              0.001387
v298              0.001387
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>

<span class="n">df_vif</span> <span class="o">=</span> <span class="n">df_reducido_2</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">variables_eliminadas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">vif_valores</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="c1"># Usar solo filas sin NA</span>
    <span class="n">df_temp</span> <span class="o">=</span> <span class="n">df_vif</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">df_temp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Muy pocas filas completas para continuar el análisis VIF.&quot;</span><span class="p">)</span>
        <span class="k">break</span>

    <span class="c1"># Eliminar columnas con varianza cero (constantes)</span>
    <span class="n">constantes</span> <span class="o">=</span> <span class="n">df_temp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">df_temp</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">constantes</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columnas constantes eliminadas:&quot;</span><span class="p">,</span> <span class="n">constantes</span><span class="p">)</span>
        <span class="n">df_vif</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">constantes</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">variables_eliminadas</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">constantes</span><span class="p">)</span>
        <span class="n">vif_valores</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">constantes</span><span class="p">))</span>
        <span class="k">continue</span>

    <span class="c1"># Calcular VIF</span>
    <span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">vif</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_temp</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">vif</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">df_temp</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">df_temp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

    <span class="n">max_vif</span> <span class="o">=</span> <span class="n">vif</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">max_vif</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Todas las variables tienen VIF &lt; 10.&quot;</span><span class="p">)</span>
        <span class="k">break</span>

    <span class="n">variable_a_eliminar</span> <span class="o">=</span> <span class="n">vif</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">var_name</span> <span class="o">=</span> <span class="n">variable_a_eliminar</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span>
    <span class="n">var_vif</span> <span class="o">=</span> <span class="n">variable_a_eliminar</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Eliminando: </span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2"> con VIF = </span><span class="si">{</span><span class="n">var_vif</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">variables_eliminadas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var_name</span><span class="p">)</span>
    <span class="n">vif_valores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var_vif</span><span class="p">)</span>

    <span class="n">df_vif</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">var_name</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Resumen</span>
<span class="n">vif_resumen</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Variable eliminada&quot;</span><span class="p">:</span> <span class="n">variables_eliminadas</span><span class="p">,</span>
    <span class="s2">&quot;VIF en el momento de eliminación&quot;</span><span class="p">:</span> <span class="n">vif_valores</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resumen de variables eliminadas por VIF:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_resumen</span><span class="p">)</span>

<span class="n">df_final_vif</span> <span class="o">=</span> <span class="n">df_vif</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Columnas constantes eliminadas: [&#39;c5&#39;, &#39;c7&#39;, &#39;c9&#39;, &#39;c12&#39;, &#39;v107&#39;, &#39;v305&#39;]
Eliminando: v97 con VIF = 1793997.02
Eliminando: v219 con VIF = 756955.88
Eliminando: v128 con VIF = 440252.04
Eliminando: v280 con VIF = 418069.62
Eliminando: v265 con VIF = 304427.76
Eliminando: v95 con VIF = 294662.47
Eliminando: v217 con VIF = 205755.07
Eliminando: v96 con VIF = 133369.59
Eliminando: v308 con VIF = 130699.89
Eliminando: v293 con VIF = 113691.24
Eliminando: v127 con VIF = 102102.68
Eliminando: v218 con VIF = 88382.55
Eliminando: v202 con VIF = 69334.71
Eliminando: v324 con VIF = 58054.58
Eliminando: v241 con VIF = 45772.76
Eliminando: v179 con VIF = 41527.63
Eliminando: v167 con VIF = 34601.32
Eliminando: v306 con VIF = 32611.40
Eliminando: v103 con VIF = 32395.61
Eliminando: v204 con VIF = 25054.83
Eliminando: v264 con VIF = 20309.85
Eliminando: v295 con VIF = 19287.31
Eliminando: transactionid con VIF = 18202.32
Eliminando: v323 con VIF = 14264.58
Eliminando: v113 con VIF = 13653.97
Eliminando: v132 con VIF = 12116.30
Eliminando: c1 con VIF = 11893.57
Eliminando: v233 con VIF = 10941.85
Eliminando: v119 con VIF = 10050.79
Eliminando: v101 con VIF = 9671.03
Eliminando: c11 con VIF = 9326.30
Eliminando: v317 con VIF = 8509.78
Eliminando: v110 con VIF = 8041.97
Eliminando: v122 con VIF = 7499.61
Eliminando: c6 con VIF = 6246.23
Eliminando: v318 con VIF = 5256.22
Eliminando: v178 con VIF = 5062.05
Eliminando: v240 con VIF = 4572.86
Eliminando: v273 con VIF = 4395.99
Eliminando: v111 con VIF = 4186.57
Eliminando: v333 con VIF = 4121.11
Eliminando: v117 con VIF = 3826.88
Eliminando: v279 con VIF = 3628.17
Eliminando: c4 con VIF = 3336.34
Eliminando: v168 con VIF = 3194.76
Eliminando: v134 con VIF = 2969.05
Eliminando: v120 con VIF = 2690.40
Eliminando: v212 con VIF = 2533.75
Eliminando: v137 con VIF = 2324.79
Eliminando: v108 con VIF = 2290.67
Eliminando: v322 con VIF = 2128.85
Eliminando: id_11 con VIF = 1999.71
Eliminando: v275 con VIF = 1889.24
Eliminando: v330 con VIF = 1587.95
Eliminando: c2 con VIF = 1570.99
Eliminando: v266 con VIF = 1446.41
Eliminando: v242 con VIF = 1294.39
Eliminando: v332 con VIF = 1260.73
Eliminando: v116 con VIF = 1126.53
Eliminando: v190 con VIF = 1079.10
Eliminando: card3 con VIF = 1063.96
Eliminando: v307 con VIF = 1003.58
Eliminando: v197 con VIF = 969.85
Eliminando: v321 con VIF = 959.65
Eliminando: v231 con VIF = 923.79
Eliminando: v106 con VIF = 892.47
Eliminando: v148 con VIF = 814.73
Eliminando: v252 con VIF = 801.04
Eliminando: v118 con VIF = 786.52
Eliminando: v278 con VIF = 772.96
Eliminando: v298 con VIF = 758.85
Eliminando: v126 con VIF = 754.36
Eliminando: v112 con VIF = 639.89
Eliminando: v211 con VIF = 606.85
Eliminando: v309 con VIF = 592.98
Eliminando: v182 con VIF = 579.72
Eliminando: v191 con VIF = 548.93
Eliminando: v114 con VIF = 509.74
Eliminando: addr2 con VIF = 499.47
Eliminando: v102 con VIF = 483.43
Eliminando: v237 con VIF = 476.68
Eliminando: v257 con VIF = 457.45
Eliminando: v205 con VIF = 428.03
Eliminando: v121 con VIF = 412.93
Eliminando: v195 con VIF = 412.70
Eliminando: v105 con VIF = 384.43
Eliminando: v189 con VIF = 383.90
Eliminando: v156 con VIF = 376.08
Eliminando: v215 con VIF = 354.23
Eliminando: v109 con VIF = 353.01
Eliminando: v150 con VIF = 345.61
Eliminando: v131 con VIF = 334.50
Eliminando: v255 con VIF = 325.21
Eliminando: v299 con VIF = 309.16
Eliminando: v254 con VIF = 307.16
Eliminando: v337 con VIF = 280.85
Eliminando: v268 con VIF = 272.85
Eliminando: v232 con VIF = 267.17
Eliminando: v193 con VIF = 263.24
Eliminando: v228 con VIF = 245.74
Eliminando: id_17 con VIF = 245.28
Eliminando: v125 con VIF = 235.73
Eliminando: v153 con VIF = 229.56
Eliminando: v136 con VIF = 227.24
Eliminando: v206 con VIF = 227.09
Eliminando: v200 con VIF = 215.42
Eliminando: v249 con VIF = 212.00
Eliminando: v251 con VIF = 199.20
Eliminando: v276 con VIF = 195.02
Eliminando: v199 con VIF = 192.52
Eliminando: v329 con VIF = 182.32
Eliminando: v331 con VIF = 177.19
Eliminando: v158 con VIF = 176.22
Eliminando: v292 con VIF = 175.69
Eliminando: v207 con VIF = 170.44
Eliminando: v336 con VIF = 162.54
Eliminando: v203 con VIF = 159.95
Eliminando: c8 con VIF = 158.46
Eliminando: v171 con VIF = 157.07
Eliminando: v186 con VIF = 155.46
Eliminando: v272 con VIF = 135.24
Eliminando: v294 con VIF = 127.53
Eliminando: v247 con VIF = 125.95
Eliminando: v302 con VIF = 124.37
Eliminando: v198 con VIF = 118.57
Eliminando: v244 con VIF = 116.71
Eliminando: v165 con VIF = 110.58
Eliminando: v129 con VIF = 106.20
Eliminando: v183 con VIF = 105.27
Eliminando: v245 con VIF = 100.08
Eliminando: v139 con VIF = 94.29
Eliminando: v236 con VIF = 93.86
Eliminando: v221 con VIF = 91.81
Eliminando: v210 con VIF = 91.09
Eliminando: v143 con VIF = 90.57
Eliminando: v194 con VIF = 87.71
Eliminando: v196 con VIF = 86.68
Eliminando: v115 con VIF = 85.95
Eliminando: v339 con VIF = 83.95
Eliminando: v283 con VIF = 83.29
Eliminando: v230 con VIF = 82.62
Eliminando: v327 con VIF = 75.72
Eliminando: v258 con VIF = 75.21
Eliminando: v320 con VIF = 68.46
Eliminando: v304 con VIF = 68.13
Eliminando: v263 con VIF = 66.09
Eliminando: id_32 con VIF = 64.90
Eliminando: v300 con VIF = 63.85
Eliminando: v155 con VIF = 63.17
Eliminando: v181 con VIF = 62.95
Eliminando: v123 con VIF = 61.88
Eliminando: v192 con VIF = 61.34
Eliminando: v262 con VIF = 58.55
Eliminando: v151 con VIF = 57.14
Eliminando: v104 con VIF = 53.83
Eliminando: v290 con VIF = 52.32
Eliminando: c10 con VIF = 52.18
Eliminando: v216 con VIF = 50.84
Eliminando: v253 con VIF = 49.18
Eliminando: v130 con VIF = 49.06
Eliminando: v144 con VIF = 48.98
Eliminando: v133 con VIF = 47.33
Eliminando: v310 con VIF = 42.88
Eliminando: v239 con VIF = 41.17
Eliminando: v246 con VIF = 40.73
Eliminando: v269 con VIF = 40.32
Eliminando: v99 con VIF = 39.63
Eliminando: v316 con VIF = 39.04
Eliminando: v209 con VIF = 37.85
Eliminando: v213 con VIF = 36.66
Eliminando: v297 con VIF = 35.86
Eliminando: v163 con VIF = 35.41
Eliminando: v234 con VIF = 34.51
Eliminando: v145 con VIF = 32.28
Eliminando: v147 con VIF = 32.12
Eliminando: id_13 con VIF = 30.03
Eliminando: v214 con VIF = 37.12
Eliminando: v154 con VIF = 30.77
Eliminando: v260 con VIF = 30.05
Eliminando: v201 con VIF = 28.14
Eliminando: v243 con VIF = 24.03
Eliminando: v334 con VIF = 23.82
Eliminando: v315 con VIF = 22.38
Eliminando: v312 con VIF = 22.04
Eliminando: v100 con VIF = 21.34
Eliminando: v259 con VIF = 21.05
Eliminando: card5 con VIF = 20.34
Eliminando: v328 con VIF = 18.89
Eliminando: v248 con VIF = 18.45
Eliminando: v170 con VIF = 18.38
Eliminando: v188 con VIF = 16.41
Eliminando: v270 con VIF = 16.32
Eliminando: v180 con VIF = 16.25
Eliminando: v157 con VIF = 15.54
Eliminando: v325 con VIF = 15.38
Eliminando: c13 con VIF = 15.06
Eliminando: v256 con VIF = 14.55
Eliminando: v319 con VIF = 14.27
Eliminando: v176 con VIF = 14.02
Eliminando: id_14 con VIF = 13.97
Eliminando: v284 con VIF = 13.50
Eliminando: v285 con VIF = 13.47
Eliminando: v303 con VIF = 12.72
Eliminando: v235 con VIF = 10.62
Eliminando: v187 con VIF = 10.51
Eliminando: v166 con VIF = 10.49
Eliminando: v222 con VIF = 10.35
Eliminando: v288 con VIF = 10.10
Todas las variables tienen VIF &lt; 10.

Resumen de variables eliminadas por VIF:
    Variable eliminada  VIF en el momento de eliminación
0                   c5                               inf
1                   c7                               inf
2                   c9                               inf
3                  c12                               inf
4                 v107                               inf
5                 v305                               inf
6                  v97                      1.793997e+06
7                 v219                      7.569559e+05
8                 v128                      4.402520e+05
9                 v280                      4.180696e+05
10                v265                      3.044278e+05
11                 v95                      2.946625e+05
12                v217                      2.057551e+05
13                 v96                      1.333696e+05
14                v308                      1.306999e+05
15                v293                      1.136912e+05
16                v127                      1.021027e+05
17                v218                      8.838255e+04
18                v202                      6.933471e+04
19                v324                      5.805458e+04
20                v241                      4.577276e+04
21                v179                      4.152763e+04
22                v167                      3.460132e+04
23                v306                      3.261140e+04
24                v103                      3.239561e+04
25                v204                      2.505483e+04
26                v264                      2.030985e+04
27                v295                      1.928731e+04
28       transactionid                      1.820232e+04
29                v323                      1.426458e+04
30                v113                      1.365397e+04
31                v132                      1.211630e+04
32                  c1                      1.189357e+04
33                v233                      1.094185e+04
34                v119                      1.005079e+04
35                v101                      9.671027e+03
36                 c11                      9.326296e+03
37                v317                      8.509776e+03
38                v110                      8.041970e+03
39                v122                      7.499612e+03
40                  c6                      6.246232e+03
41                v318                      5.256219e+03
42                v178                      5.062050e+03
43                v240                      4.572855e+03
44                v273                      4.395995e+03
45                v111                      4.186575e+03
46                v333                      4.121105e+03
47                v117                      3.826884e+03
48                v279                      3.628167e+03
49                  c4                      3.336340e+03
50                v168                      3.194758e+03
51                v134                      2.969047e+03
52                v120                      2.690404e+03
53                v212                      2.533750e+03
54                v137                      2.324793e+03
55                v108                      2.290675e+03
56                v322                      2.128846e+03
57               id_11                      1.999708e+03
58                v275                      1.889237e+03
59                v330                      1.587949e+03
60                  c2                      1.570995e+03
61                v266                      1.446407e+03
62                v242                      1.294395e+03
63                v332                      1.260733e+03
64                v116                      1.126533e+03
65                v190                      1.079096e+03
66               card3                      1.063957e+03
67                v307                      1.003585e+03
68                v197                      9.698488e+02
69                v321                      9.596472e+02
70                v231                      9.237936e+02
71                v106                      8.924654e+02
72                v148                      8.147331e+02
73                v252                      8.010436e+02
74                v118                      7.865197e+02
75                v278                      7.729617e+02
76                v298                      7.588505e+02
77                v126                      7.543564e+02
78                v112                      6.398912e+02
79                v211                      6.068469e+02
80                v309                      5.929834e+02
81                v182                      5.797180e+02
82                v191                      5.489338e+02
83                v114                      5.097382e+02
84               addr2                      4.994748e+02
85                v102                      4.834267e+02
86                v237                      4.766799e+02
87                v257                      4.574480e+02
88                v205                      4.280347e+02
89                v121                      4.129315e+02
90                v195                      4.126962e+02
91                v105                      3.844262e+02
92                v189                      3.839049e+02
93                v156                      3.760813e+02
94                v215                      3.542287e+02
95                v109                      3.530137e+02
96                v150                      3.456050e+02
97                v131                      3.345047e+02
98                v255                      3.252149e+02
99                v299                      3.091614e+02
100               v254                      3.071553e+02
101               v337                      2.808542e+02
102               v268                      2.728468e+02
103               v232                      2.671745e+02
104               v193                      2.632411e+02
105               v228                      2.457418e+02
106              id_17                      2.452773e+02
107               v125                      2.357341e+02
108               v153                      2.295571e+02
109               v136                      2.272393e+02
110               v206                      2.270921e+02
111               v200                      2.154216e+02
112               v249                      2.120024e+02
113               v251                      1.991952e+02
114               v276                      1.950210e+02
115               v199                      1.925230e+02
116               v329                      1.823222e+02
117               v331                      1.771884e+02
118               v158                      1.762164e+02
119               v292                      1.756880e+02
120               v207                      1.704380e+02
121               v336                      1.625375e+02
122               v203                      1.599548e+02
123                 c8                      1.584622e+02
124               v171                      1.570657e+02
125               v186                      1.554594e+02
126               v272                      1.352414e+02
127               v294                      1.275265e+02
128               v247                      1.259545e+02
129               v302                      1.243655e+02
130               v198                      1.185682e+02
131               v244                      1.167104e+02
132               v165                      1.105770e+02
133               v129                      1.061977e+02
134               v183                      1.052704e+02
135               v245                      1.000754e+02
136               v139                      9.428574e+01
137               v236                      9.385837e+01
138               v221                      9.181497e+01
139               v210                      9.108776e+01
140               v143                      9.056686e+01
141               v194                      8.770730e+01
142               v196                      8.667944e+01
143               v115                      8.594853e+01
144               v339                      8.395349e+01
145               v283                      8.328947e+01
146               v230                      8.261834e+01
147               v327                      7.572354e+01
148               v258                      7.521176e+01
149               v320                      6.846020e+01
150               v304                      6.812517e+01
151               v263                      6.608616e+01
152              id_32                      6.489991e+01
153               v300                      6.384893e+01
154               v155                      6.317337e+01
155               v181                      6.294556e+01
156               v123                      6.188001e+01
157               v192                      6.133623e+01
158               v262                      5.854614e+01
159               v151                      5.713600e+01
160               v104                      5.383112e+01
161               v290                      5.232071e+01
162                c10                      5.218257e+01
163               v216                      5.083751e+01
164               v253                      4.918198e+01
165               v130                      4.906207e+01
166               v144                      4.898229e+01
167               v133                      4.732585e+01
168               v310                      4.288285e+01
169               v239                      4.117433e+01
170               v246                      4.073373e+01
171               v269                      4.031609e+01
172                v99                      3.962965e+01
173               v316                      3.904318e+01
174               v209                      3.785491e+01
175               v213                      3.665808e+01
176               v297                      3.585807e+01
177               v163                      3.541241e+01
178               v234                      3.451210e+01
179               v145                      3.227501e+01
180               v147                      3.212329e+01
181              id_13                      3.003390e+01
182               v214                      3.711965e+01
183               v154                      3.076618e+01
184               v260                      3.004835e+01
185               v201                      2.814409e+01
186               v243                      2.402668e+01
187               v334                      2.382271e+01
188               v315                      2.238161e+01
189               v312                      2.203884e+01
190               v100                      2.134056e+01
191               v259                      2.104611e+01
192              card5                      2.033744e+01
193               v328                      1.888521e+01
194               v248                      1.845066e+01
195               v170                      1.837994e+01
196               v188                      1.640566e+01
197               v270                      1.631969e+01
198               v180                      1.625451e+01
199               v157                      1.554463e+01
200               v325                      1.538170e+01
201                c13                      1.505959e+01
202               v256                      1.454671e+01
203               v319                      1.427334e+01
204               v176                      1.402088e+01
205              id_14                      1.397444e+01
206               v284                      1.350405e+01
207               v285                      1.346591e+01
208               v303                      1.272210e+01
209               v235                      1.061567e+01
210               v187                      1.051284e+01
211               v166                      1.049474e+01
212               v222                      1.035097e+01
213               v288                      1.010252e+01
</pre></div>
</div>
</div>
</div>
<p>Para asegurar que las variables independientes del modelo no presenten multicolinealidad severa, se aplicó un procedimiento iterativo utilizando el Factor de Inflación de Varianza (VIF). La lógica del proceso fue eliminar, en cada iteración, la variable con mayor VIF si su valor era superior al umbral de 10, recalculando los VIF del resto de variables después de cada eliminación. Esta estrategia se repitió hasta garantizar que todas las variables numéricas restantes tuvieran VIF &lt; 10.  Antes de iniciar este proceso, se eliminaron las columnas constantes, es decir, aquellas que presentaban un único valor en todas las observaciones. Este tipo de variables carece completamente de varianza, por lo que no aportan información útil al modelo y generan problemas numéricos al momento de calcular el VIF, ya que su varianza residual es cero, lo cual puede inducir divisiones por cero o VIF infinitos. La eliminación de estas columnas fue un paso previo indispensable para evitar errores y asegurar la estabilidad del análisis de multicolinealidad.</p>
<p>El resultado final fue la eliminación de 214 variables con VIF extremadamente elevados, algunos superiores a 1.000.000, evidenciando redundancias severas en el conjunto de datos original. Tras la limpieza iterativa, se conservó un subconjunto de variables independientes con multicolinealidad aceptable, aptas para ser utilizadas en la etapa de modelado. Seguidamente, se procede a anaizar la multicolinealdiad de variables categóricas y ver si este procesamiento resulta en una reducción de la dimensión.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2_contingency</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>

<span class="c1"># Filtrar variables categóricas del dataframe final tras VIF</span>
<span class="n">cat_cols</span> <span class="o">=</span> <span class="n">df_final_vif</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Lista para guardar resultados significativos</span>
<span class="n">chi2_resultados</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Evaluar pares de variables categóricas</span>
<span class="k">for</span> <span class="n">var1</span><span class="p">,</span> <span class="n">var2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">cat_cols</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tabla</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df_final_vif</span><span class="p">[</span><span class="n">var1</span><span class="p">],</span> <span class="n">df_final_vif</span><span class="p">[</span><span class="n">var2</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">tabla</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">tabla</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">chi2</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">tabla</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
                <span class="n">chi2_resultados</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">var1</span><span class="p">,</span> <span class="n">var2</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Ignorar errores por categorías vacías o problemas numéricos</span>

<span class="c1"># Convertir a dataframe</span>
<span class="n">df_chi2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">chi2_resultados</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var1&#39;</span><span class="p">,</span> <span class="s1">&#39;var2&#39;</span><span class="p">,</span> <span class="s1">&#39;p_valor&#39;</span><span class="p">])</span>

<span class="c1"># Contar ocurrencias para saber cuáles eliminar</span>
<span class="n">contadores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">df_chi2</span><span class="p">[[</span><span class="s1">&#39;var1&#39;</span><span class="p">,</span> <span class="s1">&#39;var2&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="c1"># Variables candidatas a eliminar (las más repetidas en dependencias)</span>
<span class="n">vars_dependientes</span> <span class="o">=</span> <span class="n">contadores</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Eliminar una a una y recomputar dependencias hasta dejar solo independientes</span>
<span class="n">eliminadas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">pares_dependientes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">var1</span><span class="p">,</span> <span class="n">var2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">cat_cols</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">var1</span> <span class="ow">in</span> <span class="n">df_final_vif</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">var2</span> <span class="ow">in</span> <span class="n">df_final_vif</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">tabla</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df_final_vif</span><span class="p">[</span><span class="n">var1</span><span class="p">],</span> <span class="n">df_final_vif</span><span class="p">[</span><span class="n">var2</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">tabla</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">tabla</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">chi2</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">tabla</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
                        <span class="n">pares_dependientes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">var1</span><span class="p">,</span> <span class="n">var2</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">continue</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pares_dependientes</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="c1"># Eliminar la variable más frecuente entre las dependientes</span>
    <span class="n">plano</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">pares_dependientes</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">par</span><span class="p">])</span>
    <span class="n">var_a_eliminar</span> <span class="o">=</span> <span class="n">plano</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
    <span class="n">df_final_vif</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">var_a_eliminar</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">eliminadas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var_a_eliminar</span><span class="p">)</span>
    <span class="n">cat_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">var_a_eliminar</span><span class="p">)</span>

<span class="c1"># Mostrar resumen</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total de variables categóricas eliminadas por dependencia chi2: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">eliminadas</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables eliminadas:&quot;</span><span class="p">,</span> <span class="n">eliminadas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total de variables categóricas eliminadas por dependencia chi2: 18
Variables eliminadas: [&#39;id_12&#39;, &#39;id_15&#39;, &#39;id_16&#39;, &#39;id_28&#39;, &#39;id_29&#39;, &#39;id_31&#39;, &#39;id_36&#39;, &#39;id_37&#39;, &#39;devicetype&#39;, &#39;deviceinfo&#39;, &#39;productcd&#39;, &#39;card4&#39;, &#39;p_emaildomain&#39;, &#39;r_emaildomain&#39;, &#39;id_30&#39;, &#39;id_33&#39;, &#39;id_34&#39;, &#39;id_35&#39;]
</pre></div>
</div>
</div>
</div>
<p>Luego de reducir la dimensionalidad de las variables numéricas mediante la eliminación iterativa por VIF, se procedió a analizar la multicolinealidad entre las variables categóricas. Para esto, se aplicó la prueba de chi-cuadrado de independencia (<code class="docutils literal notranslate"><span class="pre">chi2_contingency</span></code>) a todos los pares posibles de variables categóricas restantes. Esta prueba permite evaluar si existe una relación estadísticamente significativa entre dos variables cualitativas, y se considera que hay dependencia si el valor p es menor a 0.05. En tal caso, se interpreta que ambas variables están correlacionadas y aportan información redundante al modelo.</p>
<p>A partir de los pares dependientes identificados, se eliminaron de forma iterativa aquellas variables que más frecuentemente aparecían en relaciones dependientes, con el fin de conservar únicamente aquellas que aportan información independiente. Como resultado de este proceso, se eliminaron 18 variables categóricas, entre ellas <code class="docutils literal notranslate"><span class="pre">'id_12'</span></code>, <code class="docutils literal notranslate"><span class="pre">'id_15'</span></code>, <code class="docutils literal notranslate"><span class="pre">'id_28'</span></code>, <code class="docutils literal notranslate"><span class="pre">'devicetype'</span></code>, <code class="docutils literal notranslate"><span class="pre">'deviceinfo'</span></code>, <code class="docutils literal notranslate"><span class="pre">'productcd'</span></code> y <code class="docutils literal notranslate"><span class="pre">'card4'</span></code>, entre otras. Esta depuración permite optimizar el dataset para las siguientes etapas del modelado, evitando sesgos por redundancia y mejorando la interpretabilidad del modelo final.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dimensiones finales del dataset completo tras VIF y chi²: </span><span class="si">{</span><span class="n">df_final_vif</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dimensiones finales del dataset completo tras VIF y chi²: (144233, 73)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">na_por_variable</span> <span class="o">=</span> <span class="n">df_final_vif</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">na_pct</span> <span class="o">=</span> <span class="n">df_final_vif</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Combinar ambos en un DataFrame</span>
<span class="n">na_resumen</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Total NA&#39;</span><span class="p">:</span> <span class="n">na_por_variable</span><span class="p">,</span>
    <span class="s1">&#39;Porcentaje NA&#39;</span><span class="p">:</span> <span class="n">na_pct</span>
<span class="p">})</span>

<span class="c1"># Filtrar solo las que tienen NA y ordenar por porcentaje</span>
<span class="n">na_resumen</span> <span class="o">=</span> <span class="n">na_resumen</span><span class="p">[</span><span class="n">na_resumen</span><span class="p">[</span><span class="s1">&#39;Total NA&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Porcentaje NA&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total de variables con NA en df_final_vif: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">na_resumen</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">na_resumen</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total de variables con NA en df_final_vif: 66
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total NA</th>
      <th>Porcentaje NA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id_09</th>
      <td>69307</td>
      <td>48.052110</td>
    </tr>
    <tr>
      <th>id_10</th>
      <td>69307</td>
      <td>48.052110</td>
    </tr>
    <tr>
      <th>d8</th>
      <td>69307</td>
      <td>48.052110</td>
    </tr>
    <tr>
      <th>d9</th>
      <td>69307</td>
      <td>48.052110</td>
    </tr>
    <tr>
      <th>v161</th>
      <td>62596</td>
      <td>43.399222</td>
    </tr>
    <tr>
      <th>v138</th>
      <td>62596</td>
      <td>43.399222</td>
    </tr>
    <tr>
      <th>v149</th>
      <td>62596</td>
      <td>43.399222</td>
    </tr>
    <tr>
      <th>v146</th>
      <td>62596</td>
      <td>43.399222</td>
    </tr>
    <tr>
      <th>v142</th>
      <td>62596</td>
      <td>43.399222</td>
    </tr>
    <tr>
      <th>v162</th>
      <td>62596</td>
      <td>43.399222</td>
    </tr>
    <tr>
      <th>v141</th>
      <td>62596</td>
      <td>43.399222</td>
    </tr>
    <tr>
      <th>v140</th>
      <td>62596</td>
      <td>43.399222</td>
    </tr>
    <tr>
      <th>v160</th>
      <td>62590</td>
      <td>43.395062</td>
    </tr>
    <tr>
      <th>v159</th>
      <td>62590</td>
      <td>43.395062</td>
    </tr>
    <tr>
      <th>v164</th>
      <td>62590</td>
      <td>43.395062</td>
    </tr>
    <tr>
      <th>v152</th>
      <td>62590</td>
      <td>43.395062</td>
    </tr>
    <tr>
      <th>v335</th>
      <td>62192</td>
      <td>43.119120</td>
    </tr>
    <tr>
      <th>v338</th>
      <td>62192</td>
      <td>43.119120</td>
    </tr>
    <tr>
      <th>v326</th>
      <td>62192</td>
      <td>43.119120</td>
    </tr>
    <tr>
      <th>addr1</th>
      <td>60447</td>
      <td>41.909272</td>
    </tr>
    <tr>
      <th>v267</th>
      <td>13964</td>
      <td>9.681557</td>
    </tr>
    <tr>
      <th>v223</th>
      <td>13964</td>
      <td>9.681557</td>
    </tr>
    <tr>
      <th>v224</th>
      <td>13964</td>
      <td>9.681557</td>
    </tr>
    <tr>
      <th>v225</th>
      <td>13964</td>
      <td>9.681557</td>
    </tr>
    <tr>
      <th>v226</th>
      <td>13964</td>
      <td>9.681557</td>
    </tr>
    <tr>
      <th>v261</th>
      <td>13964</td>
      <td>9.681557</td>
    </tr>
    <tr>
      <th>v229</th>
      <td>13964</td>
      <td>9.681557</td>
    </tr>
    <tr>
      <th>v274</th>
      <td>13964</td>
      <td>9.681557</td>
    </tr>
    <tr>
      <th>v277</th>
      <td>13964</td>
      <td>9.681557</td>
    </tr>
    <tr>
      <th>id_05</th>
      <td>7368</td>
      <td>5.108401</td>
    </tr>
    <tr>
      <th>id_06</th>
      <td>7368</td>
      <td>5.108401</td>
    </tr>
    <tr>
      <th>id_20</th>
      <td>4972</td>
      <td>3.447200</td>
    </tr>
    <tr>
      <th>id_19</th>
      <td>4915</td>
      <td>3.407681</td>
    </tr>
    <tr>
      <th>v172</th>
      <td>4602</td>
      <td>3.190671</td>
    </tr>
    <tr>
      <th>v173</th>
      <td>4602</td>
      <td>3.190671</td>
    </tr>
    <tr>
      <th>v177</th>
      <td>4602</td>
      <td>3.190671</td>
    </tr>
    <tr>
      <th>v169</th>
      <td>4414</td>
      <td>3.060326</td>
    </tr>
    <tr>
      <th>v174</th>
      <td>4414</td>
      <td>3.060326</td>
    </tr>
    <tr>
      <th>v175</th>
      <td>4414</td>
      <td>3.060326</td>
    </tr>
    <tr>
      <th>v185</th>
      <td>4414</td>
      <td>3.060326</td>
    </tr>
    <tr>
      <th>v208</th>
      <td>4414</td>
      <td>3.060326</td>
    </tr>
    <tr>
      <th>v184</th>
      <td>4414</td>
      <td>3.060326</td>
    </tr>
    <tr>
      <th>id_02</th>
      <td>3361</td>
      <td>2.330257</td>
    </tr>
    <tr>
      <th>id_38</th>
      <td>3248</td>
      <td>2.251912</td>
    </tr>
    <tr>
      <th>v238</th>
      <td>3127</td>
      <td>2.168020</td>
    </tr>
    <tr>
      <th>v227</th>
      <td>3127</td>
      <td>2.168020</td>
    </tr>
    <tr>
      <th>v220</th>
      <td>3127</td>
      <td>2.168020</td>
    </tr>
    <tr>
      <th>v271</th>
      <td>3127</td>
      <td>2.168020</td>
    </tr>
    <tr>
      <th>v250</th>
      <td>3127</td>
      <td>2.168020</td>
    </tr>
    <tr>
      <th>card2</th>
      <td>902</td>
      <td>0.625377</td>
    </tr>
    <tr>
      <th>v296</th>
      <td>218</td>
      <td>0.151144</td>
    </tr>
    <tr>
      <th>d1</th>
      <td>218</td>
      <td>0.151144</td>
    </tr>
    <tr>
      <th>v314</th>
      <td>218</td>
      <td>0.151144</td>
    </tr>
    <tr>
      <th>v313</th>
      <td>218</td>
      <td>0.151144</td>
    </tr>
    <tr>
      <th>v301</th>
      <td>218</td>
      <td>0.151144</td>
    </tr>
    <tr>
      <th>v289</th>
      <td>218</td>
      <td>0.151144</td>
    </tr>
    <tr>
      <th>v282</th>
      <td>218</td>
      <td>0.151144</td>
    </tr>
    <tr>
      <th>v281</th>
      <td>218</td>
      <td>0.151144</td>
    </tr>
    <tr>
      <th>card6</th>
      <td>178</td>
      <td>0.123411</td>
    </tr>
    <tr>
      <th>v98</th>
      <td>64</td>
      <td>0.044373</td>
    </tr>
    <tr>
      <th>v124</th>
      <td>64</td>
      <td>0.044373</td>
    </tr>
    <tr>
      <th>v135</th>
      <td>64</td>
      <td>0.044373</td>
    </tr>
    <tr>
      <th>v291</th>
      <td>2</td>
      <td>0.001387</td>
    </tr>
    <tr>
      <th>v287</th>
      <td>2</td>
      <td>0.001387</td>
    </tr>
    <tr>
      <th>v311</th>
      <td>2</td>
      <td>0.001387</td>
    </tr>
    <tr>
      <th>v286</th>
      <td>2</td>
      <td>0.001387</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Contar columnas numéricas</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="n">df_final_vif</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columnas numéricas: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">num_cols</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Contar columnas no numéricas (object o category)</span>
<span class="n">non_num_cols</span> <span class="o">=</span> <span class="n">df_final_vif</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columnas no numéricas (object/category): </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">non_num_cols</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Columnas numéricas: 71
Columnas no numéricas (object/category): 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar nombres de columnas numéricas</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Nombres de columnas numéricas:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">num_cols</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

<span class="c1"># Mostrar nombres de columnas no numéricas</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Nombres de columnas no numéricas:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">non_num_cols</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Nombres de columnas numéricas:
[&#39;id_01&#39;, &#39;id_02&#39;, &#39;id_05&#39;, &#39;id_06&#39;, &#39;id_09&#39;, &#39;id_10&#39;, &#39;id_19&#39;, &#39;id_20&#39;, &#39;isfraud&#39;, &#39;transactiondt&#39;, &#39;transactionamt&#39;, &#39;card1&#39;, &#39;card2&#39;, &#39;addr1&#39;, &#39;c3&#39;, &#39;c14&#39;, &#39;d1&#39;, &#39;d8&#39;, &#39;d9&#39;, &#39;v98&#39;, &#39;v124&#39;, &#39;v135&#39;, &#39;v138&#39;, &#39;v140&#39;, &#39;v141&#39;, &#39;v142&#39;, &#39;v146&#39;, &#39;v149&#39;, &#39;v152&#39;, &#39;v159&#39;, &#39;v160&#39;, &#39;v161&#39;, &#39;v162&#39;, &#39;v164&#39;, &#39;v169&#39;, &#39;v172&#39;, &#39;v173&#39;, &#39;v174&#39;, &#39;v175&#39;, &#39;v177&#39;, &#39;v184&#39;, &#39;v185&#39;, &#39;v208&#39;, &#39;v220&#39;, &#39;v223&#39;, &#39;v224&#39;, &#39;v225&#39;, &#39;v226&#39;, &#39;v227&#39;, &#39;v229&#39;, &#39;v238&#39;, &#39;v250&#39;, &#39;v261&#39;, &#39;v267&#39;, &#39;v271&#39;, &#39;v274&#39;, &#39;v277&#39;, &#39;v281&#39;, &#39;v282&#39;, &#39;v286&#39;, &#39;v287&#39;, &#39;v289&#39;, &#39;v291&#39;, &#39;v296&#39;, &#39;v301&#39;, &#39;v311&#39;, &#39;v313&#39;, &#39;v314&#39;, &#39;v326&#39;, &#39;v335&#39;, &#39;v338&#39;]

Nombres de columnas no numéricas:
[&#39;id_38&#39;, &#39;card6&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">KNNImputer</span>

<span class="c1"># Separar las variables numéricas en dos grupos según porcentaje de NA</span>
<span class="c1"># Selecciona todas las columnas numéricas</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="n">df_final_vif</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># Calcula el porcentaje de NA para cada columna numérica</span>
<span class="n">missing_pct</span> <span class="o">=</span> <span class="n">df_final_vif</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Definir el umbral (40% de NA)</span>
<span class="n">umbral</span> <span class="o">=</span> <span class="mf">0.40</span>

<span class="c1"># Grupo alto: variables con más del 40% de NA</span>
<span class="n">group_high</span> <span class="o">=</span> <span class="n">missing_pct</span><span class="p">[</span><span class="n">missing_pct</span> <span class="o">&gt;</span> <span class="n">umbral</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Grupo bajo: variables con 40% o menos de NA</span>
<span class="n">group_low</span> <span class="o">=</span> <span class="n">missing_pct</span><span class="p">[</span><span class="n">missing_pct</span> <span class="o">&lt;=</span> <span class="n">umbral</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables numéricas con &gt;40% NA:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">group_high</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Variables numéricas con ≤40% NA:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">group_low</span><span class="p">)</span>

<span class="c1"># Imputar primero el grupo alto (más difíciles) con KNNImputer </span>
<span class="n">imputer_high</span> <span class="o">=</span> <span class="n">KNNImputer</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Extraer el subconjunto del grupo alto</span>
<span class="n">df_high</span> <span class="o">=</span> <span class="n">df_final_vif</span><span class="p">[</span><span class="n">group_high</span><span class="p">]</span>

<span class="c1"># Aplicar imputación al subconjunto; se usa todo el dataframe ya que aún tiene suficientes filas</span>
<span class="n">df_high_imputed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer_high</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_high</span><span class="p">),</span>
                               <span class="n">columns</span><span class="o">=</span><span class="n">group_high</span><span class="p">,</span>
                               <span class="n">index</span><span class="o">=</span><span class="n">df_final_vif</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Reemplazar las columnas imputadas en el DataFrame original</span>
<span class="n">df_intermedio</span> <span class="o">=</span> <span class="n">df_final_vif</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_intermedio</span><span class="p">[</span><span class="n">group_high</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_high_imputed</span>

<span class="c1"># Paso 3: Imputar el grupo bajo (menos NA) con KNNImputer </span>
<span class="n">imputer_low</span> <span class="o">=</span> <span class="n">KNNImputer</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">df_low</span> <span class="o">=</span> <span class="n">df_intermedio</span><span class="p">[</span><span class="n">group_low</span><span class="p">]</span>
<span class="n">df_low_imputed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer_low</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_low</span><span class="p">),</span>
                              <span class="n">columns</span><span class="o">=</span><span class="n">group_low</span><span class="p">,</span>
                              <span class="n">index</span><span class="o">=</span><span class="n">df_final_vif</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Actualizar el DataFrame final con el grupo bajo imputado</span>
<span class="n">df_intermedio</span><span class="p">[</span><span class="n">group_low</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_low_imputed</span>

<span class="c1"># Paso 4: Verificación final de la imputación en las variables numéricas</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Missing counts en variables numéricas después de la imputación:&quot;</span><span class="p">)</span>
<span class="n">missing_final</span> <span class="o">=</span> <span class="n">df_intermedio</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">missing_final</span><span class="p">[</span><span class="n">missing_final</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables numéricas con &gt;40% NA:
[&#39;id_09&#39;, &#39;id_10&#39;, &#39;addr1&#39;, &#39;d8&#39;, &#39;d9&#39;, &#39;v138&#39;, &#39;v140&#39;, &#39;v141&#39;, &#39;v142&#39;, &#39;v146&#39;, &#39;v149&#39;, &#39;v152&#39;, &#39;v159&#39;, &#39;v160&#39;, &#39;v161&#39;, &#39;v162&#39;, &#39;v164&#39;, &#39;v326&#39;, &#39;v335&#39;, &#39;v338&#39;]

Variables numéricas con ≤40% NA:
[&#39;id_01&#39;, &#39;id_02&#39;, &#39;id_05&#39;, &#39;id_06&#39;, &#39;id_19&#39;, &#39;id_20&#39;, &#39;isfraud&#39;, &#39;transactiondt&#39;, &#39;transactionamt&#39;, &#39;card1&#39;, &#39;card2&#39;, &#39;c3&#39;, &#39;c14&#39;, &#39;d1&#39;, &#39;v98&#39;, &#39;v124&#39;, &#39;v135&#39;, &#39;v169&#39;, &#39;v172&#39;, &#39;v173&#39;, &#39;v174&#39;, &#39;v175&#39;, &#39;v177&#39;, &#39;v184&#39;, &#39;v185&#39;, &#39;v208&#39;, &#39;v220&#39;, &#39;v223&#39;, &#39;v224&#39;, &#39;v225&#39;, &#39;v226&#39;, &#39;v227&#39;, &#39;v229&#39;, &#39;v238&#39;, &#39;v250&#39;, &#39;v261&#39;, &#39;v267&#39;, &#39;v271&#39;, &#39;v274&#39;, &#39;v277&#39;, &#39;v281&#39;, &#39;v282&#39;, &#39;v286&#39;, &#39;v287&#39;, &#39;v289&#39;, &#39;v291&#39;, &#39;v296&#39;, &#39;v301&#39;, &#39;v311&#39;, &#39;v313&#39;, &#39;v314&#39;]

Missing counts en variables numéricas después de la imputación:
Series([], dtype: int64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Recalcular cantidad y porcentaje de NA tras imputación numérica</span>
<span class="n">na_por_variable</span> <span class="o">=</span> <span class="n">df_intermedio</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">na_pct</span> <span class="o">=</span> <span class="n">df_intermedio</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Unir en un resumen y filtrar solo columnas con NA</span>
<span class="n">na_resumen</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Total NA&#39;</span><span class="p">:</span> <span class="n">na_por_variable</span><span class="p">,</span>
    <span class="s1">&#39;Porcentaje NA&#39;</span><span class="p">:</span> <span class="n">na_pct</span>
<span class="p">})</span>
<span class="n">na_resumen</span> <span class="o">=</span> <span class="n">na_resumen</span><span class="p">[</span><span class="n">na_resumen</span><span class="p">[</span><span class="s1">&#39;Total NA&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Porcentaje NA&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Mostrar</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total de variables con NA después de imputación numérica: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">na_resumen</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">na_resumen</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total de variables con NA después de imputación numérica: 2
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total NA</th>
      <th>Porcentaje NA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id_38</th>
      <td>3248</td>
      <td>2.251912</td>
    </tr>
    <tr>
      <th>card6</th>
      <td>178</td>
      <td>0.123411</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imputar variables categóricas con moda</span>
<span class="n">cat_cols_na</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id_38&#39;</span><span class="p">,</span> <span class="s1">&#39;card6&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cat_cols_na</span><span class="p">:</span>
    <span class="n">moda</span> <span class="o">=</span> <span class="n">df_intermedio</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">df_intermedio</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_intermedio</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">moda</span><span class="p">)</span>


<span class="c1"># Verificación final</span>
<span class="n">na_final</span> <span class="o">=</span> <span class="n">df_intermedio</span><span class="p">[</span><span class="n">cat_cols_na</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Valores nulos restantes tras imputación categórica:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">na_final</span><span class="p">[</span><span class="n">na_final</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Valores nulos restantes tras imputación categórica:
Series([], dtype: int64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Confirmar dimensiones finales</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dimensiones finales del DataFrame: </span><span class="si">{</span><span class="n">df_intermedio</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Confirmar que no quedan NA</span>
<span class="n">nulos_totales</span> <span class="o">=</span> <span class="n">df_intermedio</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">nulos_totales</span> <span class="o">=</span> <span class="n">nulos_totales</span><span class="p">[</span><span class="n">nulos_totales</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total de columnas con NA restantes: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">nulos_totales</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">nulos_totales</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">nulos_totales</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No quedan valores nulos en el DataFrame.&quot;</span><span class="p">)</span>

<span class="c1"># Columnas numéricas imputadas con KNN</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="n">df_final_vif</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="n">cols_imputadas_knn</span> <span class="o">=</span> <span class="n">num_cols</span><span class="p">[</span><span class="n">df_final_vif</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total de columnas imputadas con KNN: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cols_imputadas_knn</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columnas imputadas con KNN:&quot;</span><span class="p">,</span> <span class="n">cols_imputadas_knn</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

<span class="c1"># Columnas categóricas imputadas con moda</span>
<span class="n">cols_imputadas_moda</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id_38&#39;</span><span class="p">,</span> <span class="s1">&#39;card6&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total de columnas imputadas con moda: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cols_imputadas_moda</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columnas imputadas con moda:&quot;</span><span class="p">,</span> <span class="n">cols_imputadas_moda</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dimensiones finales del DataFrame: (144233, 73)
Total de columnas con NA restantes: 0
No quedan valores nulos en el DataFrame.
Total de columnas imputadas con KNN: 64
Columnas imputadas con KNN: [&#39;id_02&#39;, &#39;id_05&#39;, &#39;id_06&#39;, &#39;id_09&#39;, &#39;id_10&#39;, &#39;id_19&#39;, &#39;id_20&#39;, &#39;card2&#39;, &#39;addr1&#39;, &#39;d1&#39;, &#39;d8&#39;, &#39;d9&#39;, &#39;v98&#39;, &#39;v124&#39;, &#39;v135&#39;, &#39;v138&#39;, &#39;v140&#39;, &#39;v141&#39;, &#39;v142&#39;, &#39;v146&#39;, &#39;v149&#39;, &#39;v152&#39;, &#39;v159&#39;, &#39;v160&#39;, &#39;v161&#39;, &#39;v162&#39;, &#39;v164&#39;, &#39;v169&#39;, &#39;v172&#39;, &#39;v173&#39;, &#39;v174&#39;, &#39;v175&#39;, &#39;v177&#39;, &#39;v184&#39;, &#39;v185&#39;, &#39;v208&#39;, &#39;v220&#39;, &#39;v223&#39;, &#39;v224&#39;, &#39;v225&#39;, &#39;v226&#39;, &#39;v227&#39;, &#39;v229&#39;, &#39;v238&#39;, &#39;v250&#39;, &#39;v261&#39;, &#39;v267&#39;, &#39;v271&#39;, &#39;v274&#39;, &#39;v277&#39;, &#39;v281&#39;, &#39;v282&#39;, &#39;v286&#39;, &#39;v287&#39;, &#39;v289&#39;, &#39;v291&#39;, &#39;v296&#39;, &#39;v301&#39;, &#39;v311&#39;, &#39;v313&#39;, &#39;v314&#39;, &#39;v326&#39;, &#39;v335&#39;, &#39;v338&#39;]

Total de columnas imputadas con moda: 2
Columnas imputadas con moda: [&#39;id_38&#39;, &#39;card6&#39;]
</pre></div>
</div>
</div>
</div>
<p>Para imputar los valores faltantes en el conjunto de datos final, se decidió aplicar una estrategia diferenciada según el tipo de variable. En el caso de las variables numéricas, se optó por técnicas de imputación basadas en <code class="docutils literal notranslate"><span class="pre">K-Nearest</span> <span class="pre">Neighbors</span> <span class="pre">(KNN)</span></code>, que se aplicaron a un total de 64 columnas. La elección de este método se basa en su capacidad para inferir valores ausentes a partir de patrones de similitud entre observaciones, lo cual resulta más robusto que una imputación simple por media o mediana. A diferencia de estas últimas, KNN toma en cuenta la estructura multivariable del conjunto de datos, ayudando a preservar las relaciones internas entre atributos. Además, como las pruebas de normalidad indicaron que las variables numéricas no seguían una distribución gaussiana, los métodos tradicionales (como la media) podían introducir sesgos no deseados.</p>
<p>Para las variables categóricas, en cambio, se utilizó la imputación por moda, es decir, asignando el valor más frecuente dentro de cada columna. Aunque se trata de una técnica sencilla, es especialmente útil cuando el número de categorías es reducido y una clase predomina claramente, como ocurrió con las variables <code class="docutils literal notranslate"><span class="pre">id_38</span></code> y <code class="docutils literal notranslate"><span class="pre">card6</span></code>. En este caso, otras alternativas como introducir etiquetas genéricas (“desconocido”) o codificaciones especiales no aportaban ventajas reales, e incluso podían generar niveles artificiales sin relevancia analítica.</p>
<p>Gracias a esta estrategia combinada, se logró eliminar por completo los valores nulos del conjunto de datos, manteniendo la consistencia estructural tanto en variables numéricas como categóricas. Esto permitió avanzar hacia las siguientes etapas de modelado con una base de datos limpia y bien estructurada.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exportar el DataFrame final a CSV</span>
<span class="n">df_intermedio</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;dataset_final.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Confirmar</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Archivo exportado exitosamente&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Archivo exportado exitosamente
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Proyecto de Detección de Fraude</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="EDA.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Análisis Exploratorio de Datos (EDA)</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias"><strong>Librerias</strong></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>